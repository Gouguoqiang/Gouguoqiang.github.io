<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>Mysql | ggq</title><meta name="keywords" content="JVM，虚拟机。"><meta name="author" content="ggq"><meta name="copyright" content="ggq"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="Mysql总结(todo)。">
<meta property="og:type" content="article">
<meta property="og:title" content="Mysql">
<meta property="og:url" content="https://gouguoqiang.github.io/2022/09/01/11Mysql/index.html">
<meta property="og:site_name" content="ggq">
<meta property="og:description" content="Mysql总结(todo)。">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2022-09-01T03:51:56.000Z">
<meta property="article:modified_time" content="2022-10-22T15:34:28.053Z">
<meta property="article:author" content="ggq">
<meta property="article:tag" content="数据库">
<meta name="twitter:card" content="summary"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://gouguoqiang.github.io/2022/09/01/11Mysql/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Mysql',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2022-10-22 23:34:28'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://i.loli.net/2021/02/24/5O1day2nriDzjSu.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">78</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">42</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">19</div></a></div><hr/></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">ggq</a></span><div id="menus"><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">Mysql</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2022-09-01T03:51:56.000Z" title="发表于 2022-09-01 11:51:56">2022-09-01</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2022-10-22T15:34:28.053Z" title="更新于 2022-10-22 23:34:28">2022-10-22</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="Mysql"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><p>刷一点题吧</p>
<p>having 条件表达式 需要注意having和where的用法区别：<br>1.having只能用在group by之后，对分组后的结果进行筛选(即使用having的前提条件是分组)。<br>2.where肯定在group by 之前，即也在having之前。</p>
<h1 id="创建数据库"><a href="#创建数据库" class="headerlink" title="创建数据库"></a>创建数据库</h1><h3 id="语法"><a href="#语法" class="headerlink" title="语法"></a>语法</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> DATABASE [IF <span class="keyword">NOT</span> <span class="keyword">EXISTS</span>] <span class="operator">&lt;</span>数据库名<span class="operator">&gt;</span></span><br><span class="line">[[<span class="keyword">DEFAULT</span>] <span class="type">CHARACTER</span> <span class="keyword">SET</span> <span class="operator">&lt;</span>字符集名<span class="operator">&gt;</span>] [[<span class="keyword">DEFAULT</span>] <span class="keyword">COLLATE</span> <span class="operator">&lt;</span>校对规则名<span class="operator">&gt;</span>];</span><br><span class="line"></span><br><span class="line">说明：</span><br><span class="line">（<span class="number">1</span>）[]中的内容是可选的。</span><br><span class="line">（<span class="number">2</span>）<span class="operator">&lt;</span>数据库名<span class="operator">&gt;</span>：要创建数据库的名称。</span><br><span class="line">（<span class="number">3</span>）IF <span class="keyword">NOT</span> <span class="keyword">EXISTS</span>：只有该数据库不存在时才能执行创建操作，可以避免因为数据库已经存在而引起错误。</span><br><span class="line">（<span class="number">4</span>）[<span class="keyword">DEFAULT</span>] <span class="type">CHARACTER</span> <span class="keyword">SET</span>：指定数据库的默认字符集。字符集是用来定义 MySQL 存储字符串的方式。该选项可以省略，如果省略就采用配置文件中指定的字符集。MySQL 不允许在同一个系统中创建两个相同名称的数据库。</span><br><span class="line">（<span class="number">5</span>）[<span class="keyword">DEFAULT</span>] <span class="keyword">COLLATE</span>：指定字符集的默认校对规则。校对规则用来定义比较字符串的方式，以解决排序和字符分组的问题。该选项可以省略，如果省略就采用配置文件中指定的校对规则。</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="1、查看MySQL默认的字符集和校对规则"><a href="#1、查看MySQL默认的字符集和校对规则" class="headerlink" title="1、查看MySQL默认的字符集和校对规则"></a>1、查看MySQL默认的字符集和校对规则</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">show</span> variables <span class="keyword">like</span> <span class="string">&#x27;%char%&#x27;</span>;   <span class="comment">--查看系统默认的字符集</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------------------------+--------------------------------------+</span></span><br><span class="line"><span class="operator">|</span> Variable_name            <span class="operator">|</span> <span class="keyword">Value</span>                                <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------------------------+--------------------------------------+</span></span><br><span class="line"><span class="operator">|</span> character_set_client     <span class="operator">|</span> utf8                                 <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> character_set_connection <span class="operator">|</span> utf8                                 <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> character_set_database   <span class="operator">|</span> utf8mb4                              <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> character_set_filesystem <span class="operator">|</span> <span class="type">binary</span>                               <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> character_set_results    <span class="operator">|</span> utf8                                 <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> character_set_server     <span class="operator">|</span> utf8mb4                              <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> character_set_system     <span class="operator">|</span> utf8                                 <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> character_sets_dir       <span class="operator">|</span> <span class="operator">/</span>usr<span class="operator">/</span><span class="keyword">local</span><span class="operator">/</span>mysql<span class="number">-5.7</span><span class="operator">/</span>share<span class="operator">/</span>charsets<span class="operator">/</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------------------------+--------------------------------------+</span></span><br><span class="line"><span class="number">8</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.26</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">show</span> variables <span class="keyword">like</span> <span class="string">&#x27;%COLL%&#x27;</span>;  <span class="comment">--查看系统默认的校对规则</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----------------------+--------------------+</span></span><br><span class="line"><span class="operator">|</span> Variable_name        <span class="operator">|</span> <span class="keyword">Value</span>              <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----------------------+--------------------+</span></span><br><span class="line"><span class="operator">|</span> collation_connection <span class="operator">|</span> utf8_general_ci    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> collation_database   <span class="operator">|</span> utf8mb4_general_ci <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> collation_server     <span class="operator">|</span> utf8mb4_general_ci <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----------------------+--------------------+</span></span><br><span class="line"><span class="number">3</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.03</span> sec)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="修改数据库"><a href="#修改数据库" class="headerlink" title="修改数据库"></a>修改数据库</h3><p>主要是修改字符集和校对规则</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">alter</span> database mydb <span class="type">character</span> <span class="keyword">set</span> gbk <span class="keyword">collate</span> gbk_chinese_ci;</span><br></pre></td></tr></table></figure>

<h3 id="删除数据库"><a href="#删除数据库" class="headerlink" title="删除数据库"></a>删除数据库</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">drop</span> database 数据库名;</span><br></pre></td></tr></table></figure>





<h1 id="创建数据表-table"><a href="#创建数据表-table" class="headerlink" title="创建数据表(table)"></a>创建数据表(table)</h1><h3 id="语法-1"><a href="#语法-1" class="headerlink" title="语法"></a>语法</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> [temporary] <span class="keyword">table</span> [if <span class="keyword">not</span> <span class="keyword">exists</span>]  <span class="operator">&lt;</span>表名<span class="operator">&gt;</span> ([列定义选项])</span><br><span class="line">[表选项]</span><br><span class="line">[分区选项];</span><br><span class="line"></span><br><span class="line">[列定义选项]的格式为：</span><br><span class="line">                  <span class="operator">&lt;</span>列名<span class="number">1</span><span class="operator">&gt;</span> <span class="operator">&lt;</span>类型<span class="operator">&gt;</span> <span class="operator">&lt;</span>数据完整性约束<span class="operator">&gt;</span></span><br><span class="line">                  [, <span class="operator">&lt;</span>列名<span class="number">2</span><span class="operator">&gt;</span> <span class="operator">&lt;</span>类型<span class="operator">&gt;</span> <span class="operator">&lt;</span>数据完整性约束<span class="operator">&gt;</span></span><br><span class="line">                  [, ...</span><br><span class="line">                  [<span class="operator">&lt;</span>列名n<span class="operator">&gt;</span> <span class="operator">&lt;</span>类型n<span class="operator">&gt;</span>]]]</span><br><span class="line"><span class="operator">&lt;</span>数据完整性约束<span class="operator">&gt;</span>的格式：</span><br><span class="line">                    [<span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="operator">|</span> <span class="keyword">NULL</span>] <span class="comment">--非空约束</span></span><br><span class="line">                    [<span class="keyword">DEFAULT</span> default_value]  <span class="comment">--默认值</span></span><br><span class="line">                    [AUTO_INCREMENT]    <span class="comment">--定义为自增列（类型必须是整型）</span></span><br><span class="line">                    [<span class="keyword">PRIMARY</span> KEY]  <span class="comment">--主键</span></span><br><span class="line">                    [[<span class="keyword">unique</span>] index]   <span class="comment">--索引，唯一索引</span></span><br><span class="line">                    [<span class="keyword">foreign</span> KEY(column_name) <span class="keyword">REFERENCES</span> table_name(column_name))]  </span><br><span class="line">                                            <span class="comment">--定义外键</span></span><br><span class="line">                    [COMMENT <span class="string">&#x27;string&#x27;</span>]      <span class="comment">--为字段添加注释             </span></span><br><span class="line">[表选项]的格式为：</span><br><span class="line">               ENGINE <span class="operator">=</span> engine_name（存储引擎的名称） <span class="comment">--指定存储引擎</span></span><br><span class="line">                                       <span class="comment">--常用的存储引擎有 InnoDB 和 MyISAM</span></span><br><span class="line">               AUTO_INCREMENT <span class="operator">=</span> <span class="keyword">value</span>  <span class="comment">--设置自增字段的起始值</span></span><br><span class="line">               [<span class="keyword">DEFAULT</span>] <span class="type">CHARACTER</span> <span class="keyword">SET</span> charset_name（字符集名称） <span class="comment">--设置字符集</span></span><br><span class="line">               [<span class="keyword">COLLATE</span> collation_name（校对集名称）]  <span class="comment">--设置校对集</span></span><br><span class="line">               COMMENT <span class="operator">=</span> <span class="string">&#x27;string&#x27;</span>   <span class="comment">--表注释</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--参数说明：</span></span><br><span class="line">（<span class="number">1</span>）temporary：表示创建连时表。只有在当前连接情况下，TEMPORARY表才是可见的。当连接关闭时，TEMPORARY表被自动取消。这意味着两个不同的连接可以使用相同的临时表名称，同时两个临时表不会互相冲突，也不与原有的同名的非临时表冲突。</span><br><span class="line">（<span class="number">2</span>）IF <span class="keyword">NOT</span> <span class="keyword">EXISTS</span>：如果加了该选项，只有在要创建的表不存在的情况下，才创建该表。如果要创建的表已经存在，则不执行 <span class="keyword">create</span> <span class="keyword">table</span> 命令。</span><br><span class="line">（<span class="number">3</span>）表名：如果只指定表名，则把表创建到当前数据库中，可以使用【db_name.table_name】格式指定表名，则把表创建到指定的数据库中。</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="举例"><a href="#举例" class="headerlink" title="举例"></a>举例</h3><p>(1) 创建t01</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> hist.t01(id <span class="type">int</span>,name <span class="type">char</span>(<span class="number">20</span>));</span><br></pre></td></tr></table></figure>

<p>(2) 包含主键</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> if <span class="keyword">not</span> <span class="keyword">exists</span> hist.dept (</span><br><span class="line">      dept_id <span class="type">int</span> <span class="keyword">primary</span> key comment <span class="string">&#x27;部门编号&#x27;</span>,</span><br><span class="line">      dept_name <span class="type">char</span>(<span class="number">20</span>) <span class="keyword">not</span> <span class="keyword">null</span> comment <span class="string">&#x27;部门名称&#x27;</span></span><br><span class="line">      )</span><br><span class="line">      comment <span class="string">&#x27;部门表&#x27;</span>;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>（3）创建 emp 表，包含自增字段（从1001开始），通过外键和 dept 表关联</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">create</span> <span class="keyword">table</span> if <span class="keyword">not</span> <span class="keyword">exists</span> emp (</span><br><span class="line">         emp_id <span class="type">int</span> auto_increment <span class="keyword">primary</span> key comment <span class="string">&#x27;员工编号&#x27;</span>,</span><br><span class="line">         emp_name <span class="type">char</span>(<span class="number">20</span>) <span class="keyword">not</span> <span class="keyword">null</span> comment <span class="string">&#x27;员工姓名&#x27;</span>,</span><br><span class="line">         birth datetime comment <span class="string">&#x27;出生日期&#x27;</span>,</span><br><span class="line">         phone <span class="type">char</span>(<span class="number">20</span>) comment <span class="string">&#x27;员工表&#x27;</span>,</span><br><span class="line">         dept_id <span class="type">int</span>,</span><br><span class="line">         <span class="keyword">foreign</span> key(dept_id) <span class="keyword">references</span> dept(dept_id)</span><br><span class="line">     )</span><br><span class="line">     comment <span class="string">&#x27;员工表&#x27;</span></span><br><span class="line">     auto_increment<span class="operator">=</span><span class="number">1001</span></span><br><span class="line">     <span class="keyword">default</span> <span class="type">character</span> <span class="keyword">set</span> utf8 <span class="keyword">collate</span> utf8_general_ci</span><br><span class="line">     engine<span class="operator">=</span>InnoDB;</span><br><span class="line">Query OK, <span class="number">0</span> <span class="keyword">rows</span> affected (<span class="number">0.04</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">show</span> <span class="keyword">create</span> <span class="keyword">table</span> emp\G</span><br><span class="line"><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span> <span class="number">1.</span> <span class="type">row</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">       <span class="keyword">Table</span>: emp</span><br><span class="line"><span class="keyword">Create</span> <span class="keyword">Table</span>: <span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `emp` (</span><br><span class="line">  `emp_id` <span class="type">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT COMMENT <span class="string">&#x27;员工编号&#x27;</span>,</span><br><span class="line">  `emp_name` <span class="type">char</span>(<span class="number">20</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;员工姓名&#x27;</span>,</span><br><span class="line">  `birth` datetime <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;出生日期&#x27;</span>,</span><br><span class="line">  `phone` <span class="type">char</span>(<span class="number">20</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;员工表&#x27;</span>,</span><br><span class="line">  `dept_id` <span class="type">int</span>(<span class="number">11</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  <span class="keyword">PRIMARY</span> KEY (`emp_id`),</span><br><span class="line">  KEY `dept_id` (`dept_id`),</span><br><span class="line">  <span class="keyword">CONSTRAINT</span> `emp_ibfk_1` <span class="keyword">FOREIGN</span> KEY (`dept_id`) <span class="keyword">REFERENCES</span> `dept` (`dept_id`)</span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB AUTO_INCREMENT<span class="operator">=</span><span class="number">1001</span> <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8 COMMENT<span class="operator">=</span><span class="string">&#x27;员工表&#x27;</span></span><br><span class="line"><span class="number">1</span> <span class="type">row</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>（4）创建 stu 表，包含默认值，索引</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">create</span> <span class="keyword">table</span> if <span class="keyword">not</span> <span class="keyword">exists</span> stu(</span><br><span class="line">         s_no <span class="type">int</span> auto_increment <span class="keyword">primary</span> key,</span><br><span class="line">         s_name <span class="type">char</span>(<span class="number">20</span>) <span class="keyword">not</span> <span class="keyword">null</span>,</span><br><span class="line">         birth datetime,</span><br><span class="line">         phone <span class="type">char</span>(<span class="number">11</span>),</span><br><span class="line">         addr <span class="type">char</span>(<span class="number">100</span>),</span><br><span class="line">         index(s_name),</span><br><span class="line">         <span class="keyword">unique</span> index(phone),</span><br><span class="line">         index(birth,s_name)</span><br><span class="line">     );</span><br><span class="line">Query OK, <span class="number">0</span> <span class="keyword">rows</span> affected (<span class="number">0.04</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">desc</span> stu;</span><br><span class="line"><span class="operator">+</span><span class="comment">--------+-----------+------+-----+---------+----------------+</span></span><br><span class="line"><span class="operator">|</span> Field  <span class="operator">|</span> Type      <span class="operator">|</span> <span class="keyword">Null</span> <span class="operator">|</span> Key <span class="operator">|</span> <span class="keyword">Default</span> <span class="operator">|</span> Extra          <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------+-----------+------+-----+---------+----------------+</span></span><br><span class="line"><span class="operator">|</span> s_no   <span class="operator">|</span> <span class="type">int</span>(<span class="number">11</span>)   <span class="operator">|</span> <span class="keyword">NO</span>   <span class="operator">|</span> PRI <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span> auto_increment <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> s_name <span class="operator">|</span> <span class="type">char</span>(<span class="number">20</span>)  <span class="operator">|</span> <span class="keyword">NO</span>   <span class="operator">|</span> MUL <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>                <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> birth  <span class="operator">|</span> datetime  <span class="operator">|</span> YES  <span class="operator">|</span> MUL <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>                <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> phone  <span class="operator">|</span> <span class="type">char</span>(<span class="number">11</span>)  <span class="operator">|</span> YES  <span class="operator">|</span> UNI <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>                <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> addr   <span class="operator">|</span> <span class="type">char</span>(<span class="number">100</span>) <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>                <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------+-----------+------+-----+---------+----------------+</span></span><br><span class="line"><span class="number">5</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">show</span> <span class="keyword">create</span> <span class="keyword">table</span> stu\G</span><br><span class="line"><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span> <span class="number">1.</span> <span class="type">row</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">       <span class="keyword">Table</span>: stu</span><br><span class="line"><span class="keyword">Create</span> <span class="keyword">Table</span>: <span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `stu` (</span><br><span class="line">  `s_no` <span class="type">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT,</span><br><span class="line">  `s_name` <span class="type">char</span>(<span class="number">20</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `birth` datetime <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `phone` <span class="type">char</span>(<span class="number">11</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `addr` <span class="type">char</span>(<span class="number">100</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  <span class="keyword">PRIMARY</span> KEY (`s_no`),</span><br><span class="line">  <span class="keyword">UNIQUE</span> KEY `phone` (`phone`),</span><br><span class="line">  KEY `s_name` (`s_name`),</span><br><span class="line">  KEY `birth` (`birth`,`s_name`)</span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8mb4</span><br><span class="line"><span class="number">1</span> <span class="type">row</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="通过已有的表建新表"><a href="#通过已有的表建新表" class="headerlink" title="通过已有的表建新表"></a>通过已有的表建新表</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> [temporary] <span class="keyword">table</span> [if <span class="keyword">not</span> <span class="keyword">exists</span>] table_name</span><br><span class="line"><span class="keyword">like</span> old_tbale_name;</span><br><span class="line"></span><br><span class="line"><span class="comment">--说明：使用该命令可以创建一个和原数据表结构完全相同的新表，但不会复制原数据表中的数据。</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>举例</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">create</span> <span class="keyword">table</span> if <span class="keyword">not</span> <span class="keyword">exists</span> student <span class="keyword">like</span> stu;</span><br><span class="line">Query OK, <span class="number">0</span> <span class="keyword">rows</span> affected (<span class="number">0.04</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">desc</span> student;</span><br><span class="line"><span class="operator">+</span><span class="comment">--------+-----------+------+-----+---------+----------------+</span></span><br><span class="line"><span class="operator">|</span> Field  <span class="operator">|</span> Type      <span class="operator">|</span> <span class="keyword">Null</span> <span class="operator">|</span> Key <span class="operator">|</span> <span class="keyword">Default</span> <span class="operator">|</span> Extra          <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------+-----------+------+-----+---------+----------------+</span></span><br><span class="line"><span class="operator">|</span> s_no   <span class="operator">|</span> <span class="type">int</span>(<span class="number">11</span>)   <span class="operator">|</span> <span class="keyword">NO</span>   <span class="operator">|</span> PRI <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span> auto_increment <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> s_name <span class="operator">|</span> <span class="type">char</span>(<span class="number">20</span>)  <span class="operator">|</span> <span class="keyword">NO</span>   <span class="operator">|</span> MUL <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>                <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> birth  <span class="operator">|</span> datetime  <span class="operator">|</span> YES  <span class="operator">|</span> MUL <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>                <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> phone  <span class="operator">|</span> <span class="type">char</span>(<span class="number">11</span>)  <span class="operator">|</span> YES  <span class="operator">|</span> UNI <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>                <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> addr   <span class="operator">|</span> <span class="type">char</span>(<span class="number">100</span>) <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>                <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------+-----------+------+-----+---------+----------------+</span></span><br><span class="line"><span class="number">5</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.01</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">show</span> <span class="keyword">create</span> <span class="keyword">table</span> student\G</span><br><span class="line"><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span> <span class="number">1.</span> <span class="type">row</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">       <span class="keyword">Table</span>: student</span><br><span class="line"><span class="keyword">Create</span> <span class="keyword">Table</span>: <span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `student` (</span><br><span class="line">  `s_no` <span class="type">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT,</span><br><span class="line">  `s_name` <span class="type">char</span>(<span class="number">20</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `birth` datetime <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `phone` <span class="type">char</span>(<span class="number">11</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `addr` <span class="type">char</span>(<span class="number">100</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  <span class="keyword">PRIMARY</span> KEY (`s_no`),</span><br><span class="line">  <span class="keyword">UNIQUE</span> KEY `phone` (`phone`),</span><br><span class="line">  KEY `s_name` (`s_name`),</span><br><span class="line">  KEY `birth` (`birth`,`s_name`)</span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8mb4</span><br><span class="line"><span class="number">1</span> <span class="type">row</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h3 id="使用-select-查询的结果集来创建表"><a href="#使用-select-查询的结果集来创建表" class="headerlink" title="使用 select 查询的结果集来创建表"></a>使用 select 查询的结果集来创建表</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> [temporary] <span class="keyword">table</span> [if <span class="keyword">not</span> <span class="keyword">exists</span>] table_name</span><br><span class="line">    [(create_definition,...)]</span><br><span class="line">    [table_options]</span><br><span class="line">    [partition_options]</span><br><span class="line">    [ignore <span class="operator">|</span> replace]</span><br><span class="line">    [<span class="keyword">as</span>] query_expression</span><br><span class="line">    </span><br><span class="line"><span class="comment">--说明：使用此命令可以根据查询结果创建一张新表，并且把查询到的数据插入到新建的表中。</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>举例：</p>
<p>（1）创建新表 stu1，表结构来源于对 stu 表的查询结果</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">create</span> <span class="keyword">table</span> if <span class="keyword">not</span> <span class="keyword">exists</span> stu1 </span><br><span class="line">     <span class="keyword">as</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> stu;</span><br><span class="line">Query OK, <span class="number">3</span> <span class="keyword">rows</span> affected (<span class="number">0.04</span> sec)</span><br><span class="line">Records: <span class="number">3</span>  Duplicates: <span class="number">0</span>  Warnings: <span class="number">0</span></span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> stu;</span><br><span class="line"><span class="operator">+</span><span class="comment">------+--------+---------------------+-------------+----------+</span></span><br><span class="line"><span class="operator">|</span> s_no <span class="operator">|</span> s_name <span class="operator">|</span> birth               <span class="operator">|</span> phone       <span class="operator">|</span> addr     <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------+--------+---------------------+-------------+----------+</span></span><br><span class="line"><span class="operator">|</span>    <span class="number">1</span> <span class="operator">|</span> Jack   <span class="operator">|</span> <span class="number">1999</span><span class="number">-01</span><span class="number">-23</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> <span class="operator">|</span> <span class="number">13703735566</span> <span class="operator">|</span> Beijing  <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>    <span class="number">2</span> <span class="operator">|</span> Mark   <span class="operator">|</span> <span class="number">1999</span><span class="number">-10</span><span class="number">-03</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> <span class="operator">|</span> <span class="number">13783735566</span> <span class="operator">|</span> Beijing  <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>    <span class="number">3</span> <span class="operator">|</span> Rose   <span class="operator">|</span> <span class="number">2000</span><span class="number">-11</span><span class="number">-21</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> <span class="operator">|</span> <span class="number">13783735522</span> <span class="operator">|</span> Shanghai <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------+--------+---------------------+-------------+----------+</span></span><br><span class="line"><span class="number">3</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.01</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">show</span> <span class="keyword">create</span> <span class="keyword">table</span> stu1\G</span><br><span class="line"><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span> <span class="number">1.</span> <span class="type">row</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">       <span class="keyword">Table</span>: stu1</span><br><span class="line"><span class="keyword">Create</span> <span class="keyword">Table</span>: <span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `stu1` (</span><br><span class="line">  `s_no` <span class="type">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">&#x27;0&#x27;</span>,</span><br><span class="line">  `s_name` <span class="type">char</span>(<span class="number">20</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `birth` datetime <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `phone` <span class="type">char</span>(<span class="number">11</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `addr` <span class="type">char</span>(<span class="number">100</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span></span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8mb4</span><br><span class="line"><span class="number">1</span> <span class="type">row</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line"><span class="comment">--新建的表包含了查询结果中的数据，但新建表的结构和原数据表的结构并不完全相同。</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>（2）创建新表 stu2，并且重新定义表结构</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">create</span> <span class="keyword">table</span> if <span class="keyword">not</span> <span class="keyword">exists</span> stu2(</span><br><span class="line">         s_no <span class="type">int</span> auto_increment <span class="keyword">primary</span> key,</span><br><span class="line">         s_name <span class="type">char</span>(<span class="number">30</span>),</span><br><span class="line">         phone <span class="type">char</span>(<span class="number">11</span>)</span><br><span class="line">     )</span><br><span class="line">     engine<span class="operator">=</span>InnoDB</span><br><span class="line">     <span class="type">character</span> <span class="keyword">set</span> utf8 <span class="keyword">collate</span> utf8_general_ci</span><br><span class="line">     <span class="keyword">as</span> </span><br><span class="line">     <span class="keyword">select</span> s_no,s_name,phone</span><br><span class="line">     <span class="keyword">from</span> stu;</span><br><span class="line">Query OK, <span class="number">3</span> <span class="keyword">rows</span> affected (<span class="number">0.02</span> sec)</span><br><span class="line">Records: <span class="number">3</span>  Duplicates: <span class="number">0</span>  Warnings: <span class="number">0</span></span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">show</span> <span class="keyword">create</span> <span class="keyword">table</span> stu2\G</span><br><span class="line"><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span> <span class="number">1.</span> <span class="type">row</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">       <span class="keyword">Table</span>: stu2</span><br><span class="line"><span class="keyword">Create</span> <span class="keyword">Table</span>: <span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `stu2` (</span><br><span class="line">  `s_no` <span class="type">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT,</span><br><span class="line">  `s_name` <span class="type">char</span>(<span class="number">30</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `phone` <span class="type">char</span>(<span class="number">11</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  <span class="keyword">PRIMARY</span> KEY (`s_no`)</span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB AUTO_INCREMENT<span class="operator">=</span><span class="number">4</span> <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8</span><br><span class="line"><span class="number">1</span> <span class="type">row</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h3 id="删除数据表"><a href="#删除数据表" class="headerlink" title="删除数据表"></a>删除数据表</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">drop</span> <span class="keyword">table</span> 表名;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="修改表结构"><a href="#修改表结构" class="headerlink" title="修改表结构"></a>修改表结构</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">desc</span> employee;</span><br><span class="line"><span class="operator">+</span><span class="comment">-------+--------------+------+-----+---------+-------+</span></span><br><span class="line"><span class="operator">|</span> Field <span class="operator">|</span> Type         <span class="operator">|</span> <span class="keyword">Null</span> <span class="operator">|</span> Key <span class="operator">|</span> <span class="keyword">Default</span> <span class="operator">|</span> Extra <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------+--------------+------+-----+---------+-------+</span></span><br><span class="line"><span class="operator">|</span> id    <span class="operator">|</span> <span class="type">int</span>(<span class="number">11</span>)      <span class="operator">|</span> <span class="keyword">NO</span>   <span class="operator">|</span> PRI <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>       <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> name  <span class="operator">|</span> <span class="type">char</span>(<span class="number">10</span>)     <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>       <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> addr  <span class="operator">|</span> <span class="type">varchar</span>(<span class="number">100</span>) <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>       <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------+--------------+------+-----+---------+-------+</span></span><br><span class="line"><span class="number">3</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"><span class="comment">-- 以这个表为例</span></span><br></pre></td></tr></table></figure>



<p>在 MySQL 中可以使用 ALTER TABLE 语句来改变原有数据表的结构。修改表结构涉及到的操作主要有：（1）增加和删除字段；（2）修改字段的数据类型；（3）修改字段名；（4）修改字段的排列位置；（5）添加和删除完整性<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=%E7%BA%A6%E6%9D%9F&spm=1001.2101.3001.7020">约束</a>；（6）修改表名；（7）更改表的存储引擎等。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> <span class="operator">&lt;</span>表名<span class="operator">&gt;</span> [修改选项];</span><br><span class="line"></span><br><span class="line">[修改选项]的格式为：</span><br><span class="line"><span class="keyword">ADD</span> <span class="keyword">COLUMN</span> <span class="operator">&lt;</span>列名<span class="operator">&gt;</span> <span class="operator">&lt;</span>类型<span class="operator">&gt;</span></span><br><span class="line"><span class="operator">|</span> CHANGE <span class="keyword">COLUMN</span> <span class="operator">&lt;</span>旧列名<span class="operator">&gt;</span> <span class="operator">&lt;</span>新列名<span class="operator">&gt;</span> <span class="operator">&lt;</span>新列类型<span class="operator">&gt;</span></span><br><span class="line"><span class="operator">|</span> <span class="keyword">ALTER</span> <span class="keyword">COLUMN</span> <span class="operator">&lt;</span>列名<span class="operator">&gt;</span> [ <span class="keyword">SET</span> <span class="keyword">DEFAULT</span> <span class="operator">&lt;</span>默认值<span class="operator">&gt;</span> <span class="operator">|</span> <span class="keyword">DROP</span> <span class="keyword">DEFAULT</span> ]</span><br><span class="line"><span class="operator">|</span> MODIFY <span class="keyword">COLUMN</span> <span class="operator">&lt;</span>列名<span class="operator">&gt;</span> <span class="operator">&lt;</span>类型<span class="operator">&gt;</span></span><br><span class="line"><span class="operator">|</span> <span class="keyword">DROP</span> <span class="keyword">COLUMN</span> <span class="operator">&lt;</span>列名<span class="operator">&gt;</span></span><br><span class="line"><span class="operator">|</span> RENAME <span class="keyword">TO</span> <span class="operator">&lt;</span>新表名<span class="operator">&gt;</span> </span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="一、增加和删除字段"><a href="#一、增加和删除字段" class="headerlink" title="一、增加和删除字段"></a>一、增加和删除字段</h2><h4 id="1、增加字段"><a href="#1、增加字段" class="headerlink" title="1、增加字段"></a>1、增加字段</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> <span class="operator">&lt;</span>表名<span class="operator">&gt;</span> <span class="keyword">ADD</span> <span class="keyword">COLUMN</span> <span class="operator">&lt;</span>列名<span class="operator">&gt;</span> <span class="operator">&lt;</span>类型<span class="operator">&gt;</span> <span class="operator">&lt;</span>完整性约束<span class="operator">&gt;</span> [<span class="keyword">FIRST</span> <span class="operator">|</span> AFTER 列名];</span><br><span class="line"></span><br><span class="line">说明：使用 [<span class="keyword">FIRST</span> <span class="operator">|</span> AFTER 列名] 选项可以设置新增字段的位置。</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>举例：</p>
<h4 id="（1）添加一个列-phone"><a href="#（1）添加一个列-phone" class="headerlink" title="（1）添加一个列 phone"></a>（1）添加一个列 phone</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">alter</span> <span class="keyword">table</span> employee <span class="keyword">add</span> phone <span class="type">char</span>(<span class="number">20</span>);</span><br><span class="line">Query OK, <span class="number">0</span> <span class="keyword">rows</span> affected (<span class="number">0.17</span> sec)</span><br><span class="line">Records: <span class="number">0</span>  Duplicates: <span class="number">0</span>  Warnings: <span class="number">0</span></span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">desc</span> employee;</span><br><span class="line"><span class="operator">+</span><span class="comment">-------+--------------+------+-----+---------+-------+</span></span><br><span class="line"><span class="operator">|</span> Field <span class="operator">|</span> Type         <span class="operator">|</span> <span class="keyword">Null</span> <span class="operator">|</span> Key <span class="operator">|</span> <span class="keyword">Default</span> <span class="operator">|</span> Extra <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------+--------------+------+-----+---------+-------+</span></span><br><span class="line"><span class="operator">|</span> id    <span class="operator">|</span> <span class="type">int</span>(<span class="number">11</span>)      <span class="operator">|</span> <span class="keyword">NO</span>   <span class="operator">|</span> PRI <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>       <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> name  <span class="operator">|</span> <span class="type">char</span>(<span class="number">10</span>)     <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>       <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> addr  <span class="operator">|</span> <span class="type">varchar</span>(<span class="number">100</span>) <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>       <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> phone <span class="operator">|</span> <span class="type">char</span>(<span class="number">20</span>)     <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>       <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------+--------------+------+-----+---------+-------+</span></span><br><span class="line"><span class="number">4</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="（2）添加一个列-salary，默认值为0，不能取空值"><a href="#（2）添加一个列-salary，默认值为0，不能取空值" class="headerlink" title="（2）添加一个列 salary，默认值为0，不能取空值"></a>（2）添加一个列 salary，默认值为0，不能取空值</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"> mysql<span class="operator">&gt;</span> <span class="keyword">alter</span> <span class="keyword">table</span> employee <span class="keyword">add</span> salary <span class="type">decimal</span>(<span class="number">10</span>,<span class="number">2</span>) <span class="keyword">default</span> <span class="number">0</span> <span class="keyword">not</span> <span class="keyword">null</span>;</span><br><span class="line">Query OK, <span class="number">0</span> <span class="keyword">rows</span> affected (<span class="number">0.11</span> sec)</span><br><span class="line">Records: <span class="number">0</span>  Duplicates: <span class="number">0</span>  Warnings: <span class="number">0</span></span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">desc</span> employee;</span><br><span class="line"><span class="operator">+</span><span class="comment">--------+---------------+------+-----+---------+-------+</span></span><br><span class="line"><span class="operator">|</span> Field  <span class="operator">|</span> Type          <span class="operator">|</span> <span class="keyword">Null</span> <span class="operator">|</span> Key <span class="operator">|</span> <span class="keyword">Default</span> <span class="operator">|</span> Extra <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------+---------------+------+-----+---------+-------+</span></span><br><span class="line"><span class="operator">|</span> id     <span class="operator">|</span> <span class="type">int</span>(<span class="number">11</span>)       <span class="operator">|</span> <span class="keyword">NO</span>   <span class="operator">|</span> PRI <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>       <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> name   <span class="operator">|</span> <span class="type">char</span>(<span class="number">10</span>)      <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>       <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> addr   <span class="operator">|</span> <span class="type">varchar</span>(<span class="number">100</span>)  <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>       <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> phone  <span class="operator">|</span> <span class="type">char</span>(<span class="number">20</span>)      <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>       <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> salary <span class="operator">|</span> <span class="type">decimal</span>(<span class="number">10</span>,<span class="number">2</span>) <span class="operator">|</span> <span class="keyword">NO</span>   <span class="operator">|</span>     <span class="operator">|</span> <span class="number">0.00</span>    <span class="operator">|</span>       <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------+---------------+------+-----+---------+-------+</span></span><br><span class="line"><span class="number">5</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h4 id="（3）新增一个字段-birth，并放在-name-字段之后"><a href="#（3）新增一个字段-birth，并放在-name-字段之后" class="headerlink" title="（3）新增一个字段 birth，并放在 name 字段之后"></a>（3）新增一个字段 birth，并放在 name 字段之后</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">ALTER</span> <span class="keyword">TABLE</span> employee <span class="keyword">ADD</span> <span class="keyword">COLUMN</span> birth datetime after name;</span><br><span class="line">Query OK, <span class="number">0</span> <span class="keyword">rows</span> affected (<span class="number">0.08</span> sec)</span><br><span class="line">Records: <span class="number">0</span>  Duplicates: <span class="number">0</span>  Warnings: <span class="number">0</span></span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">desc</span> employee;</span><br><span class="line"><span class="operator">+</span><span class="comment">--------+---------------+------+-----+---------+-------+</span></span><br><span class="line"><span class="operator">|</span> Field  <span class="operator">|</span> Type          <span class="operator">|</span> <span class="keyword">Null</span> <span class="operator">|</span> Key <span class="operator">|</span> <span class="keyword">Default</span> <span class="operator">|</span> Extra <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------+---------------+------+-----+---------+-------+</span></span><br><span class="line"><span class="operator">|</span> id     <span class="operator">|</span> <span class="type">int</span>(<span class="number">11</span>)       <span class="operator">|</span> <span class="keyword">NO</span>   <span class="operator">|</span> PRI <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>       <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> name   <span class="operator">|</span> <span class="type">char</span>(<span class="number">10</span>)      <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>       <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> birth  <span class="operator">|</span> datetime      <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>       <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> addr   <span class="operator">|</span> <span class="type">varchar</span>(<span class="number">100</span>)  <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>       <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> phone  <span class="operator">|</span> <span class="type">char</span>(<span class="number">20</span>)      <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>       <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> salary <span class="operator">|</span> <span class="type">decimal</span>(<span class="number">10</span>,<span class="number">2</span>) <span class="operator">|</span> <span class="keyword">NO</span>   <span class="operator">|</span>     <span class="operator">|</span> <span class="number">0.00</span>    <span class="operator">|</span>       <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------+---------------+------+-----+---------+-------+</span></span><br><span class="line"><span class="number">6</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="2、删除字段"><a href="#2、删除字段" class="headerlink" title="2、删除字段"></a>2、删除字段</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> <span class="operator">&lt;</span>表名<span class="operator">&gt;</span> <span class="keyword">DROP</span> <span class="keyword">COLUMN</span> <span class="operator">&lt;</span>列名<span class="operator">&gt;</span>;</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">alter</span> <span class="keyword">table</span> employee <span class="keyword">drop</span> <span class="keyword">column</span> salary;</span><br><span class="line">Query OK, <span class="number">0</span> <span class="keyword">rows</span> affected (<span class="number">0.17</span> sec)</span><br><span class="line">Records: <span class="number">0</span>  Duplicates: <span class="number">0</span>  Warnings: <span class="number">0</span></span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">desc</span> employee;</span><br><span class="line"><span class="operator">+</span><span class="comment">--------+---------------+------+-----+---------+-------+</span></span><br><span class="line"><span class="operator">|</span> Field  <span class="operator">|</span> Type          <span class="operator">|</span> <span class="keyword">Null</span> <span class="operator">|</span> Key <span class="operator">|</span> <span class="keyword">Default</span> <span class="operator">|</span> Extra <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------+---------------+------+-----+---------+-------+</span></span><br><span class="line"><span class="operator">|</span> id     <span class="operator">|</span> <span class="type">int</span>(<span class="number">11</span>)       <span class="operator">|</span> <span class="keyword">NO</span>   <span class="operator">|</span> PRI <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>       <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> name   <span class="operator">|</span> <span class="type">char</span>(<span class="number">10</span>)      <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>       <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> birth  <span class="operator">|</span> datetime      <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>       <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> addr   <span class="operator">|</span> <span class="type">varchar</span>(<span class="number">100</span>)  <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>       <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> phone  <span class="operator">|</span> <span class="type">char</span>(<span class="number">20</span>)      <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>       <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------+---------------+------+-----+---------+-------+</span></span><br><span class="line"><span class="number">6</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="二、修改字段的数据类型、名称和字段的位置"><a href="#二、修改字段的数据类型、名称和字段的位置" class="headerlink" title="二、修改字段的数据类型、名称和字段的位置"></a>二、修改字段的数据类型、名称和字段的位置</h2><h4 id="1、修改字段的数据类型"><a href="#1、修改字段的数据类型" class="headerlink" title="1、修改字段的数据类型"></a>1、修改字段的数据类型</h4><p>修改字段的数据类型使用 MODIFY 选项。语法格式如下：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> <span class="operator">&lt;</span>表名<span class="operator">&gt;</span> MODIFY <span class="keyword">COLUMN</span> <span class="operator">&lt;</span>列名<span class="operator">&gt;</span> <span class="operator">&lt;</span>类型<span class="operator">&gt;</span>;</span><br><span class="line"></span><br><span class="line">说明：使用 MODIFY 选项不能更改字段的名称。</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>举例：把字段 name 的类型更为 varchar，长度为20</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">alter</span> <span class="keyword">table</span> employee modify name <span class="type">varchar</span>(<span class="number">20</span>);</span><br><span class="line">Query OK, <span class="number">2</span> <span class="keyword">rows</span> affected (<span class="number">0.05</span> sec)</span><br><span class="line">Records: <span class="number">2</span>  Duplicates: <span class="number">0</span>  Warnings: <span class="number">0</span></span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">desc</span> employee;</span><br><span class="line"><span class="operator">+</span><span class="comment">--------+---------------+------+-----+---------+-------+</span></span><br><span class="line"><span class="operator">|</span> Field  <span class="operator">|</span> Type          <span class="operator">|</span> <span class="keyword">Null</span> <span class="operator">|</span> Key <span class="operator">|</span> <span class="keyword">Default</span> <span class="operator">|</span> Extra <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------+---------------+------+-----+---------+-------+</span></span><br><span class="line"><span class="operator">|</span> id     <span class="operator">|</span> <span class="type">int</span>(<span class="number">11</span>)       <span class="operator">|</span> <span class="keyword">NO</span>   <span class="operator">|</span> PRI <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>       <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> name   <span class="operator">|</span> <span class="type">varchar</span>(<span class="number">20</span>)   <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>       <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> birth  <span class="operator">|</span> datetime      <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>       <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> addr   <span class="operator">|</span> <span class="type">varchar</span>(<span class="number">100</span>)  <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>       <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> phone  <span class="operator">|</span> <span class="type">char</span>(<span class="number">20</span>)      <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>       <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> salary <span class="operator">|</span> <span class="type">decimal</span>(<span class="number">10</span>,<span class="number">2</span>) <span class="operator">|</span> <span class="keyword">NO</span>   <span class="operator">|</span>     <span class="operator">|</span> <span class="number">0.00</span>    <span class="operator">|</span>       <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------+---------------+------+-----+---------+-------+</span></span><br><span class="line"><span class="number">6</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.01</span> sec)</span><br></pre></td></tr></table></figure>

<h4 id="2、修改字段的名称"><a href="#2、修改字段的名称" class="headerlink" title="2、修改字段的名称"></a>2、修改字段的名称</h4><p>修改字段的名称使用 CHANGE 选项。语法格式如下：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> <span class="operator">&lt;</span>表名<span class="operator">&gt;</span> CHANGE <span class="keyword">COLUMN</span> <span class="operator">&lt;</span>旧列名<span class="operator">&gt;</span> <span class="operator">&lt;</span>新列名<span class="operator">&gt;</span> <span class="operator">&lt;</span>新列类型<span class="operator">&gt;</span>;</span><br><span class="line"></span><br><span class="line">说明：使用 CHANGE 选项时，如果新列名和旧列名相同，则作用和 MODIFY 相同。</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>举例：把 addr 列的名称修改为 address，类型修改为 varchar(200)，放到字段 phone 之后</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">alter</span> <span class="keyword">table</span> employee change addr address <span class="type">varchar</span>(<span class="number">200</span>) after phone;</span><br><span class="line">Query OK, <span class="number">0</span> <span class="keyword">rows</span> affected (<span class="number">0.13</span> sec)</span><br><span class="line">Records: <span class="number">0</span>  Duplicates: <span class="number">0</span>  Warnings: <span class="number">0</span></span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">desc</span> employee;</span><br><span class="line"><span class="operator">+</span><span class="comment">---------+---------------+------+-----+---------+-------+</span></span><br><span class="line"><span class="operator">|</span> Field   <span class="operator">|</span> Type          <span class="operator">|</span> <span class="keyword">Null</span> <span class="operator">|</span> Key <span class="operator">|</span> <span class="keyword">Default</span> <span class="operator">|</span> Extra <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------+---------------+------+-----+---------+-------+</span></span><br><span class="line"><span class="operator">|</span> id      <span class="operator">|</span> <span class="type">int</span>(<span class="number">11</span>)       <span class="operator">|</span> <span class="keyword">NO</span>   <span class="operator">|</span> PRI <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>       <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> name    <span class="operator">|</span> <span class="type">varchar</span>(<span class="number">20</span>)   <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>       <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> birth   <span class="operator">|</span> datetime      <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>       <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> phone   <span class="operator">|</span> <span class="type">char</span>(<span class="number">20</span>)      <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>       <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> address <span class="operator">|</span> <span class="type">varchar</span>(<span class="number">200</span>)  <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>       <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> salary  <span class="operator">|</span> <span class="type">decimal</span>(<span class="number">10</span>,<span class="number">2</span>) <span class="operator">|</span> <span class="keyword">NO</span>   <span class="operator">|</span>     <span class="operator">|</span> <span class="number">0.00</span>    <span class="operator">|</span>       <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------+---------------+------+-----+---------+-------+</span></span><br><span class="line"><span class="number">6</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h4 id="3、更改字段的位置"><a href="#3、更改字段的位置" class="headerlink" title="3、更改字段的位置"></a>3、更改字段的位置</h4><p>在使用 ADD 选项添加字段、使用 MODIFY 选项修改字段的类型和长度、使用 CHANGE 选项修改字段名称和类型时，可以使用 [FIRST | AFTER 列名] 选项 指定字段的位置。语法格式如下：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--添加字段同时指定新增字段的位置</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> <span class="operator">&lt;</span>表名<span class="operator">&gt;</span> <span class="keyword">ADD</span> <span class="keyword">COLUMN</span> <span class="operator">&lt;</span>列名<span class="operator">&gt;</span> <span class="operator">&lt;</span>类型<span class="operator">&gt;</span> <span class="operator">&lt;</span>完整性约束<span class="operator">&gt;</span> [<span class="keyword">FIRST</span> <span class="operator">|</span> AFTER 列名]; </span><br><span class="line"><span class="comment">--修改字段的类型和长度同时指定字段的位置</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> <span class="operator">&lt;</span>表名<span class="operator">&gt;</span> MODIFY <span class="keyword">COLUMN</span> <span class="operator">&lt;</span>列名<span class="operator">&gt;</span> <span class="operator">&lt;</span>类型<span class="operator">&gt;</span> [<span class="keyword">FIRST</span> <span class="operator">|</span> AFTER 列名];</span><br><span class="line"><span class="comment">--修改字段的名称、类型和长度同时指定字段的位置</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> <span class="operator">&lt;</span>表名<span class="operator">&gt;</span> CHANGE <span class="keyword">COLUMN</span> <span class="operator">&lt;</span>旧列名<span class="operator">&gt;</span> <span class="operator">&lt;</span>新列名<span class="operator">&gt;</span> <span class="operator">&lt;</span>新列类型<span class="operator">&gt;</span> [<span class="keyword">FIRST</span> <span class="operator">|</span> AFTER 列名];</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>举例：</p>
<p>（1）添加一个字段 comm，类型为 varchar(500)，位置放在第一位</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">alter</span> <span class="keyword">table</span> employee <span class="keyword">add</span> comm <span class="type">varchar</span>(<span class="number">500</span>) <span class="keyword">first</span>;</span><br><span class="line">Query OK, <span class="number">0</span> <span class="keyword">rows</span> affected (<span class="number">0.09</span> sec)</span><br><span class="line">Records: <span class="number">0</span>  Duplicates: <span class="number">0</span>  Warnings: <span class="number">0</span></span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">desc</span> employee;</span><br><span class="line"><span class="operator">+</span><span class="comment">---------+---------------+------+-----+---------+-------+</span></span><br><span class="line"><span class="operator">|</span> Field   <span class="operator">|</span> Type          <span class="operator">|</span> <span class="keyword">Null</span> <span class="operator">|</span> Key <span class="operator">|</span> <span class="keyword">Default</span> <span class="operator">|</span> Extra <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------+---------------+------+-----+---------+-------+</span></span><br><span class="line"><span class="operator">|</span> comm    <span class="operator">|</span> <span class="type">varchar</span>(<span class="number">500</span>)  <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>       <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> id      <span class="operator">|</span> <span class="type">int</span>(<span class="number">11</span>)       <span class="operator">|</span> <span class="keyword">NO</span>   <span class="operator">|</span> PRI <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>       <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> name    <span class="operator">|</span> <span class="type">varchar</span>(<span class="number">20</span>)   <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>       <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> birth   <span class="operator">|</span> datetime      <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>       <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> phone   <span class="operator">|</span> <span class="type">char</span>(<span class="number">20</span>)      <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>       <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> address <span class="operator">|</span> <span class="type">varchar</span>(<span class="number">200</span>)  <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>       <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> salary  <span class="operator">|</span> <span class="type">decimal</span>(<span class="number">10</span>,<span class="number">2</span>) <span class="operator">|</span> <span class="keyword">NO</span>   <span class="operator">|</span>     <span class="operator">|</span> <span class="number">0.00</span>    <span class="operator">|</span>       <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------+---------------+------+-----+---------+-------+</span></span><br><span class="line"><span class="number">7</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.01</span> sec)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>2）把字段 comm 的长度修改为 1000，并放在字段 salary 之前</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">alter</span> <span class="keyword">table</span> employee modify comm <span class="type">varchar</span>(<span class="number">1000</span>) after address;</span><br><span class="line">Query OK, <span class="number">0</span> <span class="keyword">rows</span> affected (<span class="number">0.08</span> sec)</span><br><span class="line">Records: <span class="number">0</span>  Duplicates: <span class="number">0</span>  Warnings: <span class="number">0</span></span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">desc</span> employee;</span><br><span class="line"><span class="operator">+</span><span class="comment">---------+---------------+------+-----+---------+-------+</span></span><br><span class="line"><span class="operator">|</span> Field   <span class="operator">|</span> Type          <span class="operator">|</span> <span class="keyword">Null</span> <span class="operator">|</span> Key <span class="operator">|</span> <span class="keyword">Default</span> <span class="operator">|</span> Extra <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------+---------------+------+-----+---------+-------+</span></span><br><span class="line"><span class="operator">|</span> id      <span class="operator">|</span> <span class="type">int</span>(<span class="number">11</span>)       <span class="operator">|</span> <span class="keyword">NO</span>   <span class="operator">|</span> PRI <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>       <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> name    <span class="operator">|</span> <span class="type">varchar</span>(<span class="number">20</span>)   <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>       <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> birth   <span class="operator">|</span> datetime      <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>       <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> phone   <span class="operator">|</span> <span class="type">char</span>(<span class="number">20</span>)      <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>       <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> address <span class="operator">|</span> <span class="type">varchar</span>(<span class="number">200</span>)  <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>       <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> comm    <span class="operator">|</span> <span class="type">varchar</span>(<span class="number">1000</span>) <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>       <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> salary  <span class="operator">|</span> <span class="type">decimal</span>(<span class="number">10</span>,<span class="number">2</span>) <span class="operator">|</span> <span class="keyword">NO</span>   <span class="operator">|</span>     <span class="operator">|</span> <span class="number">0.00</span>    <span class="operator">|</span>       <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------+---------------+------+-----+---------+-------+</span></span><br><span class="line"><span class="number">7</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.01</span> sec)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>（3）把字段 comm 的名称修改为 comme，并放在表的结尾</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">alter</span> <span class="keyword">table</span> employee change comm comme <span class="type">varchar</span>(<span class="number">1000</span>) after salary;</span><br><span class="line">Query OK, <span class="number">0</span> <span class="keyword">rows</span> affected (<span class="number">0.07</span> sec)</span><br><span class="line">Records: <span class="number">0</span>  Duplicates: <span class="number">0</span>  Warnings: <span class="number">0</span></span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">desc</span> employee;</span><br><span class="line"><span class="operator">+</span><span class="comment">---------+---------------+------+-----+---------+-------+</span></span><br><span class="line"><span class="operator">|</span> Field   <span class="operator">|</span> Type          <span class="operator">|</span> <span class="keyword">Null</span> <span class="operator">|</span> Key <span class="operator">|</span> <span class="keyword">Default</span> <span class="operator">|</span> Extra <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------+---------------+------+-----+---------+-------+</span></span><br><span class="line"><span class="operator">|</span> id      <span class="operator">|</span> <span class="type">int</span>(<span class="number">11</span>)       <span class="operator">|</span> <span class="keyword">NO</span>   <span class="operator">|</span> PRI <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>       <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> name    <span class="operator">|</span> <span class="type">varchar</span>(<span class="number">20</span>)   <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>       <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> birth   <span class="operator">|</span> datetime      <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>       <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> phone   <span class="operator">|</span> <span class="type">char</span>(<span class="number">20</span>)      <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>       <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> address <span class="operator">|</span> <span class="type">varchar</span>(<span class="number">200</span>)  <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>       <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> salary  <span class="operator">|</span> <span class="type">decimal</span>(<span class="number">10</span>,<span class="number">2</span>) <span class="operator">|</span> <span class="keyword">NO</span>   <span class="operator">|</span>     <span class="operator">|</span> <span class="number">0.00</span>    <span class="operator">|</span>       <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> comme   <span class="operator">|</span> <span class="type">varchar</span>(<span class="number">1000</span>) <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>       <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------+---------------+------+-----+---------+-------+</span></span><br><span class="line"><span class="number">7</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="三、修改表名"><a href="#三、修改表名" class="headerlink" title="三、修改表名"></a>三、修改表名</h2><p>语法格式如下：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> <span class="operator">&lt;</span>表名<span class="operator">&gt;</span> RENAME [<span class="keyword">TO</span>] <span class="operator">&lt;</span>新表名<span class="operator">&gt;</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>举例：把数据表 employee 名称修改为 emp</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">alter</span> <span class="keyword">table</span> employee rename emp;</span><br><span class="line">Query OK, <span class="number">0</span> <span class="keyword">rows</span> affected (<span class="number">0.10</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">show</span> tables;</span><br><span class="line"><span class="operator">+</span><span class="comment">-----------------+</span></span><br><span class="line"><span class="operator">|</span> Tables_in_hist  <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-----------------+</span></span><br><span class="line"><span class="operator">|</span> dept            <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> emp             <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> stu             <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> student         <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> user_permission <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-----------------+</span></span><br><span class="line"><span class="number">5</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h1 id="数据更新之INSERT"><a href="#数据更新之INSERT" class="headerlink" title="数据更新之INSERT"></a>数据更新之INSERT</h1><p>MySQL 数据库和其它的<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=%E5%85%B3%E7%B3%BB%E5%9E%8B%E6%95%B0%E6%8D%AE%E5%BA%93&spm=1001.2101.3001.7020">关系型数据库</a>一样，支持数据的增（插入：insert）、删（删除：delete）、改（更新：update）、查（查询：select）操作。</p>
<h2 id="一、数据准备"><a href="#一、数据准备" class="headerlink" title="一、数据准备"></a>一、数据准备</h2><p>创建两张表：部门（dept）和员工（emp），表结构如下：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">desc</span> dept;</span><br><span class="line"><span class="operator">+</span><span class="comment">-----------+----------+------+-----+---------+-------+</span></span><br><span class="line"><span class="operator">|</span> Field     <span class="operator">|</span> Type     <span class="operator">|</span> <span class="keyword">Null</span> <span class="operator">|</span> Key <span class="operator">|</span> <span class="keyword">Default</span> <span class="operator">|</span> Extra <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-----------+----------+------+-----+---------+-------+</span></span><br><span class="line"><span class="operator">|</span> dept_id   <span class="operator">|</span> <span class="type">int</span>(<span class="number">11</span>)  <span class="operator">|</span> <span class="keyword">NO</span>   <span class="operator">|</span> PRI <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>       <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> dept_name <span class="operator">|</span> <span class="type">char</span>(<span class="number">20</span>) <span class="operator">|</span> <span class="keyword">NO</span>   <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>       <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-----------+----------+------+-----+---------+-------+</span></span><br><span class="line"><span class="number">2</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">desc</span> emp;</span><br><span class="line"><span class="operator">+</span><span class="comment">----------+----------+------+-----+---------+----------------+</span></span><br><span class="line"><span class="operator">|</span> Field    <span class="operator">|</span> Type     <span class="operator">|</span> <span class="keyword">Null</span> <span class="operator">|</span> Key <span class="operator">|</span> <span class="keyword">Default</span> <span class="operator">|</span> Extra          <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----------+----------+------+-----+---------+----------------+</span></span><br><span class="line"><span class="operator">|</span> emp_id   <span class="operator">|</span> <span class="type">int</span>(<span class="number">11</span>)  <span class="operator">|</span> <span class="keyword">NO</span>   <span class="operator">|</span> PRI <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span> auto_increment <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> emp_name <span class="operator">|</span> <span class="type">char</span>(<span class="number">20</span>) <span class="operator">|</span> <span class="keyword">NO</span>   <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>                <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> gender   <span class="operator">|</span> <span class="type">char</span>(<span class="number">2</span>)  <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> 男      <span class="operator">|</span>                <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> birth    <span class="operator">|</span> datetime <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>                <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> phone    <span class="operator">|</span> <span class="type">char</span>(<span class="number">20</span>) <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>                <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> dept_id  <span class="operator">|</span> <span class="type">int</span>(<span class="number">11</span>)  <span class="operator">|</span> YES  <span class="operator">|</span> MUL <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>                <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----------+----------+------+-----+---------+----------------+</span></span><br><span class="line"><span class="number">6</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.01</span> sec)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="二、数据的插入操作"><a href="#二、数据的插入操作" class="headerlink" title="二、数据的插入操作"></a>二、数据的插入操作</h2><p>插入数据使用 Insert 命令，Insert 命令有三种用法：</p>
<h4 id="1、插入一条或多条数据记录"><a href="#1、插入一条或多条数据记录" class="headerlink" title="1、插入一条或多条数据记录"></a>1、插入一条或多条数据记录</h4><p>语法如下：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 下面的命令一次可以插入一条或多条数据记录</span></span><br><span class="line"><span class="keyword">INSERT</span> [<span class="keyword">INTO</span>] 表名 [(列名,...)]</span><br><span class="line">    <span class="keyword">VALUES</span> (&#123;表达式 <span class="operator">|</span> <span class="keyword">DEFAULT</span>&#125;, ...), (...),...</span><br><span class="line">说明：</span><br><span class="line">（<span class="number">1</span>）每条数据记录包含在一对括号中。</span><br><span class="line">（<span class="number">2</span>）如果省略表名后面的列名，则 <span class="keyword">values</span> 后面的数据必须和表中字段的数量与顺序对应。</span><br><span class="line">（<span class="number">3</span>）使用 <span class="keyword">DEFAULT</span> 可以把字段的默认值插入表中。</span><br><span class="line">（<span class="number">4</span>）使用一条 <span class="keyword">INSERT</span> 命令插入多条数据记录时，多条记录之间用逗号分开。</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="（1）用-insert-命令一次插入一条记录"><a href="#（1）用-insert-命令一次插入一条记录" class="headerlink" title="（1）用 insert 命令一次插入一条记录"></a>（1）用 insert 命令一次插入一条记录</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">insert</span> <span class="keyword">into</span> dept <span class="keyword">values</span>(<span class="number">11</span>,<span class="string">&#x27;人事部&#x27;</span>);</span><br><span class="line">Query OK, <span class="number">1</span> <span class="type">row</span> affected (<span class="number">0.01</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">insert</span> <span class="keyword">into</span> dept(dept_id,dept_name) <span class="keyword">values</span>(<span class="number">12</span>,<span class="string">&#x27;财务部&#x27;</span>);</span><br><span class="line">Query OK, <span class="number">1</span> <span class="type">row</span> affected (<span class="number">0.02</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> dept;</span><br><span class="line"><span class="operator">+</span><span class="comment">---------+-----------+</span></span><br><span class="line"><span class="operator">|</span> dept_id <span class="operator">|</span> dept_name <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------+-----------+</span></span><br><span class="line"><span class="operator">|</span>      <span class="number">11</span> <span class="operator">|</span> 人事部    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>      <span class="number">12</span> <span class="operator">|</span> 财务部    <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------+-----------+</span></span><br><span class="line"><span class="number">2</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">insert</span> <span class="keyword">into</span> emp(emp_name,gender,birth,phone,dept_id)</span><br><span class="line">     <span class="keyword">values</span>(<span class="string">&#x27;Jack&#x27;</span>,<span class="keyword">default</span>,<span class="string">&#x27;1995-2-3&#x27;</span>,<span class="string">&#x27;15937321555&#x27;</span>,<span class="number">11</span>);</span><br><span class="line">Query OK, <span class="number">1</span> <span class="type">row</span> affected (<span class="number">0.01</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">insert</span> <span class="keyword">into</span> emp <span class="keyword">values</span>(<span class="number">1101</span>,<span class="string">&#x27;Mark&#x27;</span>,<span class="string">&#x27;男&#x27;</span>,<span class="string">&#x27;1997-12-15&#x27;</span>,<span class="string">&#x27;15903732155&#x27;</span>,<span class="number">11</span>);</span><br><span class="line">Query OK, <span class="number">1</span> <span class="type">row</span> affected (<span class="number">0.02</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">insert</span> <span class="keyword">into</span> emp(emp_name,gender,birth,phone,dept_id)</span><br><span class="line">     <span class="keyword">values</span>(<span class="string">&#x27;Jack&#x27;</span>,<span class="string">&#x27;女&#x27;</span>,<span class="keyword">null</span>,<span class="string">&#x27;15937321666&#x27;</span>,<span class="number">12</span>);</span><br><span class="line">Query OK, <span class="number">1</span> <span class="type">row</span> affected (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">insert</span> <span class="keyword">into</span> emp(emp_name,gender,dept_id)</span><br><span class="line">     <span class="keyword">values</span>(<span class="string">&#x27;Jack&#x27;</span>,<span class="keyword">default</span>,<span class="number">12</span>);</span><br><span class="line">Query OK, <span class="number">1</span> <span class="type">row</span> affected (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> mysql<span class="operator">&gt;</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp;</span><br><span class="line"><span class="operator">+</span><span class="comment">--------+----------+--------+---------------------+-------------+---------+</span></span><br><span class="line"><span class="operator">|</span> emp_id <span class="operator">|</span> emp_name <span class="operator">|</span> gender <span class="operator">|</span> birth               <span class="operator">|</span> phone       <span class="operator">|</span> dept_id <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------+----------+--------+---------------------+-------------+---------+</span></span><br><span class="line"><span class="operator">|</span>      <span class="number">1</span> <span class="operator">|</span> Jack     <span class="operator">|</span> 男     <span class="operator">|</span> <span class="number">1995</span><span class="number">-02</span><span class="number">-03</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> <span class="operator">|</span> <span class="number">15937321555</span> <span class="operator">|</span>      <span class="number">11</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>   <span class="number">1101</span> <span class="operator">|</span> Mark     <span class="operator">|</span> 男     <span class="operator">|</span> <span class="number">1997</span><span class="number">-12</span><span class="number">-15</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> <span class="operator">|</span> <span class="number">15903732155</span> <span class="operator">|</span>      <span class="number">11</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>   <span class="number">1102</span> <span class="operator">|</span> Jack     <span class="operator">|</span> 女     <span class="operator">|</span> <span class="keyword">NULL</span>                <span class="operator">|</span> <span class="number">15937321666</span> <span class="operator">|</span>      <span class="number">12</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>   <span class="number">1103</span> <span class="operator">|</span> Jack     <span class="operator">|</span> 男     <span class="operator">|</span> <span class="keyword">NULL</span>                <span class="operator">|</span> <span class="keyword">NULL</span>        <span class="operator">|</span>      <span class="number">12</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------+----------+--------+---------------------+-------------+---------+</span></span><br><span class="line"><span class="number">4</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="（2）用-insert-命令一次插入多条记录"><a href="#（2）用-insert-命令一次插入多条记录" class="headerlink" title="（2）用 insert 命令一次插入多条记录"></a>（2）用 insert 命令一次插入多条记录</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">insert</span> <span class="keyword">into</span> dept <span class="keyword">values</span>(<span class="number">13</span>,<span class="string">&#x27;生产制造部&#x27;</span>),(<span class="number">14</span>,<span class="string">&#x27;销售部&#x27;</span>),(<span class="number">15</span>,<span class="string">&#x27;公关部&#x27;</span>);</span><br><span class="line">Query OK, <span class="number">3</span> <span class="keyword">rows</span> affected (<span class="number">0.01</span> sec)</span><br><span class="line">Records: <span class="number">3</span>  Duplicates: <span class="number">0</span>  Warnings: <span class="number">0</span></span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> dept;</span><br><span class="line"><span class="operator">+</span><span class="comment">---------+-----------------+</span></span><br><span class="line"><span class="operator">|</span> dept_id <span class="operator">|</span> dept_name       <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------+-----------------+</span></span><br><span class="line"><span class="operator">|</span>      <span class="number">11</span> <span class="operator">|</span> 人事部          <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>      <span class="number">12</span> <span class="operator">|</span> 财务部          <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>      <span class="number">13</span> <span class="operator">|</span> 生产制造部      <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>      <span class="number">14</span> <span class="operator">|</span> 销售部          <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>      <span class="number">15</span> <span class="operator">|</span> 公关部          <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------+-----------------+</span></span><br><span class="line"><span class="number">5</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="2、使用-set-参数插入数据"><a href="#2、使用-set-参数插入数据" class="headerlink" title="2、使用 set 参数插入数据"></a>2、使用 set 参数插入数据</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> [<span class="keyword">INTO</span>] 表名</span><br><span class="line">    <span class="keyword">SET</span> col_name<span class="operator">=</span>&#123;表达式 <span class="operator">|</span> <span class="keyword">DEFAULT</span>&#125;, ...</span><br><span class="line">    </span><br><span class="line">说明：使用这种形式的 <span class="keyword">INSERT</span> 语句不能插入多行。</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>举例 :</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">insert</span> <span class="keyword">into</span> dept <span class="keyword">set</span> dept_id<span class="operator">=</span><span class="number">16</span>,dept_name<span class="operator">=</span><span class="string">&#x27;信息部&#x27;</span>;</span><br><span class="line">Query OK, <span class="number">1</span> <span class="type">row</span> affected (<span class="number">0.01</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> dept;</span><br><span class="line"><span class="operator">+</span><span class="comment">---------+-----------------+</span></span><br><span class="line"><span class="operator">|</span> dept_id <span class="operator">|</span> dept_name       <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------+-----------------+</span></span><br><span class="line"><span class="operator">|</span>      <span class="number">11</span> <span class="operator">|</span> 人事部          <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>      <span class="number">12</span> <span class="operator">|</span> 财务部          <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>      <span class="number">13</span> <span class="operator">|</span> 生产制造部      <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>      <span class="number">14</span> <span class="operator">|</span> 销售部          <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>      <span class="number">15</span> <span class="operator">|</span> 公关部          <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>      <span class="number">16</span> <span class="operator">|</span> 信息部          <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------+-----------------+</span></span><br><span class="line"><span class="number">6</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h4 id="3、把一个查询的结果插入到数据表中"><a href="#3、把一个查询的结果插入到数据表中" class="headerlink" title="3、把一个查询的结果插入到数据表中"></a>3、把一个查询的结果插入到数据表中</h4><p>格式如下：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> [<span class="keyword">INTO</span>] 表名 [(列名,...)]</span><br><span class="line">    <span class="keyword">SELECT</span> ...</span><br><span class="line">    </span><br><span class="line">说明：查询命令不能包含 <span class="keyword">ORDER</span> <span class="keyword">BY</span>子句，而且<span class="keyword">INSERT</span>语句的目的表不能出现在查询命令的 <span class="keyword">FROM</span> 子句中。</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>举例：</p>
<h4 id="（1）创建一张数据表"><a href="#（1）创建一张数据表" class="headerlink" title="（1）创建一张数据表"></a>（1）创建一张数据表</h4><p>表结构如下：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">create</span> <span class="keyword">table</span> emp001 <span class="keyword">select</span> emp_id,emp_name,phone <span class="keyword">from</span> emp <span class="keyword">where</span> <span class="number">2</span><span class="operator">=</span><span class="number">3</span>;</span><br><span class="line">Query OK, <span class="number">0</span> <span class="keyword">rows</span> affected (<span class="number">0.04</span> sec)</span><br><span class="line">Records: <span class="number">0</span>  Duplicates: <span class="number">0</span>  Warnings: <span class="number">0</span></span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">desc</span> emp001;</span><br><span class="line"><span class="operator">+</span><span class="comment">----------+----------+------+-----+---------+-------+</span></span><br><span class="line"><span class="operator">|</span> Field    <span class="operator">|</span> Type     <span class="operator">|</span> <span class="keyword">Null</span> <span class="operator">|</span> Key <span class="operator">|</span> <span class="keyword">Default</span> <span class="operator">|</span> Extra <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----------+----------+------+-----+---------+-------+</span></span><br><span class="line"><span class="operator">|</span> emp_id   <span class="operator">|</span> <span class="type">int</span>(<span class="number">11</span>)  <span class="operator">|</span> <span class="keyword">NO</span>   <span class="operator">|</span>     <span class="operator">|</span> <span class="number">0</span>       <span class="operator">|</span>       <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> emp_name <span class="operator">|</span> <span class="type">char</span>(<span class="number">20</span>) <span class="operator">|</span> <span class="keyword">NO</span>   <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>       <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> phone    <span class="operator">|</span> <span class="type">char</span>(<span class="number">20</span>) <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>       <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----------+----------+------+-----+---------+-------+</span></span><br><span class="line"><span class="number">3</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp001;</span><br><span class="line"><span class="keyword">Empty</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="（2）从-emp-表中查询中男性员工的信息插入-emp001-表中"><a href="#（2）从-emp-表中查询中男性员工的信息插入-emp001-表中" class="headerlink" title="（2）从 emp 表中查询中男性员工的信息插入 emp001 表中"></a>（2）从 emp 表中查询中男性员工的信息插入 emp001 表中</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">insert</span> <span class="keyword">into</span> emp001 <span class="keyword">select</span> emp_id,emp_name,phone <span class="keyword">from</span> emp <span class="keyword">where</span> gender<span class="operator">=</span><span class="string">&#x27;男&#x27;</span>;</span><br><span class="line">Query OK, <span class="number">3</span> <span class="keyword">rows</span> affected (<span class="number">0.02</span> sec)</span><br><span class="line">Records: <span class="number">3</span>  Duplicates: <span class="number">0</span>  Warnings: <span class="number">0</span></span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp001;</span><br><span class="line"><span class="operator">+</span><span class="comment">--------+----------+-------------+</span></span><br><span class="line"><span class="operator">|</span> emp_id <span class="operator">|</span> emp_name <span class="operator">|</span> phone       <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------+----------+-------------+</span></span><br><span class="line"><span class="operator">|</span>      <span class="number">1</span> <span class="operator">|</span> Jack     <span class="operator">|</span> <span class="number">15937321555</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>   <span class="number">1101</span> <span class="operator">|</span> Mark     <span class="operator">|</span> <span class="number">15903732155</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>   <span class="number">1103</span> <span class="operator">|</span> Jack     <span class="operator">|</span> <span class="keyword">NULL</span>        <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------+----------+-------------+</span></span><br><span class="line"><span class="number">3</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="4、replace-into-命令"><a href="#4、replace-into-命令" class="headerlink" title="4、replace into 命令"></a>4、replace into 命令</h4><p>replace into 命令的格式与 insert into 命令基本相同。使用 insert into 命令插入数据时，如果主键重复，则插入失败，使用replace into 命令插入数据时，如果主键重复，则替换该行的所有数据，相当于将主键这条记录彻底删除，再插入新的记录。也就是说，将所有的字段都更新了。</p>
<p>语法如下：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">REPLACE [<span class="keyword">INTO</span>] 表名 [(列名, ...)]</span><br><span class="line">　　<span class="keyword">VALUES</span> (expr, ...),(...),...</span><br><span class="line"></span><br><span class="line">REPLACE [<span class="keyword">INTO</span>] 表名 [(列名, ...)]</span><br><span class="line">　　<span class="keyword">SELECT</span> ...</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>举例：在 dept 表中插入一个新部门：技术部</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> dept;</span><br><span class="line"><span class="operator">+</span><span class="comment">---------+-----------------+</span></span><br><span class="line"><span class="operator">|</span> dept_id <span class="operator">|</span> dept_name       <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------+-----------------+</span></span><br><span class="line"><span class="operator">|</span>      <span class="number">11</span> <span class="operator">|</span> 人事部          <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>      <span class="number">12</span> <span class="operator">|</span> 财务部          <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>      <span class="number">13</span> <span class="operator">|</span> 生产制造部      <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>      <span class="number">14</span> <span class="operator">|</span> 销售部          <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>      <span class="number">15</span> <span class="operator">|</span> 公关部          <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>      <span class="number">16</span> <span class="operator">|</span> 信息部          <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------+-----------------+</span></span><br><span class="line"><span class="number">6</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> replace <span class="keyword">into</span> dept <span class="keyword">values</span>(<span class="number">16</span>,<span class="string">&#x27;技术部&#x27;</span>);</span><br><span class="line">Query OK, <span class="number">2</span> <span class="keyword">rows</span> affected (<span class="number">0.01</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> dept;</span><br><span class="line"><span class="operator">+</span><span class="comment">---------+-----------------+</span></span><br><span class="line"><span class="operator">|</span> dept_id <span class="operator">|</span> dept_name       <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------+-----------------+</span></span><br><span class="line"><span class="operator">|</span>      <span class="number">11</span> <span class="operator">|</span> 人事部          <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>      <span class="number">12</span> <span class="operator">|</span> 财务部          <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>      <span class="number">13</span> <span class="operator">|</span> 生产制造部      <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>      <span class="number">14</span> <span class="operator">|</span> 销售部          <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>      <span class="number">15</span> <span class="operator">|</span> 公关部          <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>      <span class="number">16</span> <span class="operator">|</span> 技术部          <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------+-----------------+</span></span><br><span class="line"><span class="number">6</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 可以看到，当命令执行成功后，“信息部”被替换为了“技术部”。</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="数据更新之UPDATE"><a href="#数据更新之UPDATE" class="headerlink" title="数据更新之UPDATE"></a>数据更新之UPDATE</h1><p>MySQL 数据库和其它的<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=%E5%85%B3%E7%B3%BB%E5%9E%8B%E6%95%B0%E6%8D%AE%E5%BA%93&spm=1001.2101.3001.7020">关系型数据库</a>一样，支持数据的增（插入：insert）、删（删除：delete）、改（更新：update）、查（查询：select）操作。</p>
<h2 id="一、数据准备-1"><a href="#一、数据准备-1" class="headerlink" title="一、数据准备"></a>一、数据准备</h2><p>创建两张表：部门（dept）和员工（emp），表结构如下：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">desc</span> dept;</span><br><span class="line"><span class="operator">+</span><span class="comment">-----------+----------+------+-----+---------+-------+</span></span><br><span class="line"><span class="operator">|</span> Field     <span class="operator">|</span> Type     <span class="operator">|</span> <span class="keyword">Null</span> <span class="operator">|</span> Key <span class="operator">|</span> <span class="keyword">Default</span> <span class="operator">|</span> Extra <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-----------+----------+------+-----+---------+-------+</span></span><br><span class="line"><span class="operator">|</span> dept_id   <span class="operator">|</span> <span class="type">int</span>(<span class="number">11</span>)  <span class="operator">|</span> <span class="keyword">NO</span>   <span class="operator">|</span> PRI <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>       <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> dept_name <span class="operator">|</span> <span class="type">char</span>(<span class="number">20</span>) <span class="operator">|</span> <span class="keyword">NO</span>   <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>       <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-----------+----------+------+-----+---------+-------+</span></span><br><span class="line"><span class="number">2</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">desc</span> emp;</span><br><span class="line"><span class="operator">+</span><span class="comment">----------+----------+------+-----+---------+----------------+</span></span><br><span class="line"><span class="operator">|</span> Field    <span class="operator">|</span> Type     <span class="operator">|</span> <span class="keyword">Null</span> <span class="operator">|</span> Key <span class="operator">|</span> <span class="keyword">Default</span> <span class="operator">|</span> Extra          <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----------+----------+------+-----+---------+----------------+</span></span><br><span class="line"><span class="operator">|</span> emp_id   <span class="operator">|</span> <span class="type">int</span>(<span class="number">11</span>)  <span class="operator">|</span> <span class="keyword">NO</span>   <span class="operator">|</span> PRI <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span> auto_increment <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> emp_name <span class="operator">|</span> <span class="type">char</span>(<span class="number">20</span>) <span class="operator">|</span> <span class="keyword">NO</span>   <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>                <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> gender   <span class="operator">|</span> <span class="type">char</span>(<span class="number">2</span>)  <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> 男      <span class="operator">|</span>                <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> birth    <span class="operator">|</span> datetime <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>                <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> phone    <span class="operator">|</span> <span class="type">char</span>(<span class="number">20</span>) <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>                <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> dept_id  <span class="operator">|</span> <span class="type">int</span>(<span class="number">11</span>)  <span class="operator">|</span> YES  <span class="operator">|</span> MUL <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>                <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----------+----------+------+-----+---------+----------------+</span></span><br><span class="line"><span class="number">6</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.01</span> sec)</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="二、数据更新操作"><a href="#二、数据更新操作" class="headerlink" title="二、数据更新操作"></a>二、数据更新操作</h2><p>使用 UPDATE 命令可以对表中的数据进行更新，该命令有两种用法：</p>
<h4 id="1、为表中的字段指定一个常量或表达式"><a href="#1、为表中的字段指定一个常量或表达式" class="headerlink" title="1、为表中的字段指定一个常量或表达式"></a>1、为表中的字段指定一个常量或表达式</h4><p>格式如下：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">UPDATE</span> 表名</span><br><span class="line">    <span class="keyword">SET</span> 列名 <span class="operator">=</span> 表达式 [, 列名 <span class="operator">=</span> 表达式 ...]</span><br><span class="line">    [<span class="keyword">WHERE</span> 条件]</span><br><span class="line">    [<span class="keyword">ORDER</span> <span class="keyword">BY</span> ...]</span><br><span class="line">    [LIMIT row_count]</span><br><span class="line">说明：</span><br><span class="line">（<span class="number">1</span>） <span class="keyword">ORDER</span> <span class="keyword">BY</span>：按照指定的顺序对行进行更新。</span><br><span class="line">（<span class="number">2</span>） LIMIT：限制可更新的行数。</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>举例：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp;</span><br><span class="line"><span class="operator">+</span><span class="comment">--------+----------+--------+---------+-------------+---------+</span></span><br><span class="line"><span class="operator">|</span> emp_id <span class="operator">|</span> emp_name <span class="operator">|</span> gender <span class="operator">|</span> salary  <span class="operator">|</span> phone       <span class="operator">|</span> dept_id <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------+----------+--------+---------+-------------+---------+</span></span><br><span class="line"><span class="operator">|</span>      <span class="number">1</span> <span class="operator">|</span> Jack     <span class="operator">|</span> 男     <span class="operator">|</span> <span class="number">4500.00</span> <span class="operator">|</span> <span class="number">15937321555</span> <span class="operator">|</span>      <span class="number">11</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>   <span class="number">1101</span> <span class="operator">|</span> Mark     <span class="operator">|</span> 男     <span class="operator">|</span> <span class="number">7100.00</span> <span class="operator">|</span> <span class="number">15903732155</span> <span class="operator">|</span>      <span class="number">11</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>   <span class="number">1102</span> <span class="operator">|</span> Rose     <span class="operator">|</span> 女     <span class="operator">|</span> <span class="number">6200.00</span> <span class="operator">|</span> <span class="number">15937321666</span> <span class="operator">|</span>      <span class="number">12</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>   <span class="number">1103</span> <span class="operator">|</span> Jerry    <span class="operator">|</span> 男     <span class="operator">|</span> <span class="number">3700.00</span> <span class="operator">|</span> <span class="keyword">NULL</span>        <span class="operator">|</span>      <span class="number">12</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------+----------+--------+---------+-------------+---------+</span></span><br><span class="line"><span class="number">4</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">update</span> emp <span class="keyword">set</span> phone<span class="operator">=</span><span class="string">&#x27;15537312999&#x27;</span> <span class="keyword">where</span> emp_id<span class="operator">=</span><span class="number">1103</span>;<span class="comment">--更新1103员工的电话</span></span><br><span class="line">Query OK, <span class="number">1</span> <span class="type">row</span> affected (<span class="number">0.01</span> sec)</span><br><span class="line"><span class="keyword">Rows</span> matched: <span class="number">1</span>  Changed: <span class="number">1</span>  Warnings: <span class="number">0</span></span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">update</span> emp <span class="keyword">set</span> salary<span class="operator">=</span>salary<span class="operator">*</span><span class="number">1.05</span>;  <span class="comment">--所有人工资增加 5%</span></span><br><span class="line">Query OK, <span class="number">4</span> <span class="keyword">rows</span> affected (<span class="number">0.04</span> sec)</span><br><span class="line"><span class="keyword">Rows</span> matched: <span class="number">4</span>  Changed: <span class="number">4</span>  Warnings: <span class="number">0</span></span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp;</span><br><span class="line"><span class="operator">+</span><span class="comment">--------+----------+--------+---------+-------------+---------+</span></span><br><span class="line"><span class="operator">|</span> emp_id <span class="operator">|</span> emp_name <span class="operator">|</span> gender <span class="operator">|</span> salary  <span class="operator">|</span> phone       <span class="operator">|</span> dept_id <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------+----------+--------+---------+-------------+---------+</span></span><br><span class="line"><span class="operator">|</span>      <span class="number">1</span> <span class="operator">|</span> Jack     <span class="operator">|</span> 男     <span class="operator">|</span> <span class="number">4725.00</span> <span class="operator">|</span> <span class="number">15937321555</span> <span class="operator">|</span>      <span class="number">11</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>   <span class="number">1101</span> <span class="operator">|</span> Mark     <span class="operator">|</span> 男     <span class="operator">|</span> <span class="number">7455.00</span> <span class="operator">|</span> <span class="number">15903732155</span> <span class="operator">|</span>      <span class="number">11</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>   <span class="number">1102</span> <span class="operator">|</span> Rose     <span class="operator">|</span> 女     <span class="operator">|</span> <span class="number">6510.00</span> <span class="operator">|</span> <span class="number">15937321666</span> <span class="operator">|</span>      <span class="number">12</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>   <span class="number">1103</span> <span class="operator">|</span> Jerry    <span class="operator">|</span> 男     <span class="operator">|</span> <span class="number">3885.00</span> <span class="operator">|</span> <span class="number">15537312999</span> <span class="operator">|</span>      <span class="number">12</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------+----------+--------+---------+-------------+---------+</span></span><br><span class="line"><span class="number">4</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="2、利用另一个表中的数据更新当前表"><a href="#2、利用另一个表中的数据更新当前表" class="headerlink" title="2、利用另一个表中的数据更新当前表"></a>2、利用另一个表中的数据更新当前表</h4><p>格式如下：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">UPDATE</span> 表<span class="number">1</span> <span class="keyword">join</span> 表<span class="number">2</span> <span class="keyword">on</span> 表<span class="number">1.</span>列名 <span class="operator">=</span> 表<span class="number">2.</span>列名</span><br><span class="line">    <span class="keyword">SET</span> 列名 <span class="operator">=</span> 表达式 [, 列名 <span class="operator">=</span> 表达式 ...]</span><br><span class="line">    [<span class="keyword">WHERE</span> 条件]</span><br><span class="line">说明：</span><br><span class="line">（<span class="number">1</span>）利用 表<span class="number">2</span> 中的数据更新 表<span class="number">1</span>，要求两个表必须存在关联字段。</span><br><span class="line">（<span class="number">2</span>）表<span class="number">1</span> 和 表<span class="number">2</span> 关联的条件为 表<span class="number">1.</span>列名 <span class="operator">=</span> 表<span class="number">2.</span>列名。</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>举例：</p>
<p>（1）为 emp 表添加一个列 dept_name，并使用 dept 表的相关数据进行填充</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">alter</span> <span class="keyword">table</span> emp <span class="keyword">add</span> dept_name <span class="type">char</span>(<span class="number">20</span>);</span><br><span class="line">Query OK, <span class="number">0</span> <span class="keyword">rows</span> affected (<span class="number">0.07</span> sec)</span><br><span class="line">Records: <span class="number">0</span>  Duplicates: <span class="number">0</span>  Warnings: <span class="number">0</span></span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp;</span><br><span class="line"><span class="operator">+</span><span class="comment">--------+----------+--------+---------+-------------+---------+-----------+</span></span><br><span class="line"><span class="operator">|</span> emp_id <span class="operator">|</span> emp_name <span class="operator">|</span> gender <span class="operator">|</span> salary  <span class="operator">|</span> phone       <span class="operator">|</span> dept_id <span class="operator">|</span> dept_name <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------+----------+--------+---------+-------------+---------+-----------+</span></span><br><span class="line"><span class="operator">|</span>      <span class="number">1</span> <span class="operator">|</span> Jack     <span class="operator">|</span> 男     <span class="operator">|</span> <span class="number">4725.00</span> <span class="operator">|</span> <span class="number">15937321555</span> <span class="operator">|</span>      <span class="number">11</span> <span class="operator">|</span> <span class="keyword">NULL</span>      <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>   <span class="number">1101</span> <span class="operator">|</span> Mark     <span class="operator">|</span> 男     <span class="operator">|</span> <span class="number">7455.00</span> <span class="operator">|</span> <span class="number">15903732155</span> <span class="operator">|</span>      <span class="number">11</span> <span class="operator">|</span> <span class="keyword">NULL</span>      <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>   <span class="number">1102</span> <span class="operator">|</span> Rose     <span class="operator">|</span> 女     <span class="operator">|</span> <span class="number">6510.00</span> <span class="operator">|</span> <span class="number">15937321666</span> <span class="operator">|</span>      <span class="number">12</span> <span class="operator">|</span> <span class="keyword">NULL</span>      <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>   <span class="number">1103</span> <span class="operator">|</span> Jerry    <span class="operator">|</span> 男     <span class="operator">|</span> <span class="number">3885.00</span> <span class="operator">|</span> <span class="number">15537312999</span> <span class="operator">|</span>      <span class="number">12</span> <span class="operator">|</span> <span class="keyword">NULL</span>      <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------+----------+--------+---------+-------------+---------+-----------+</span></span><br><span class="line"><span class="number">4</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">update</span> emp <span class="keyword">join</span> dept <span class="keyword">on</span> emp.dept_id <span class="operator">=</span> dept.dept_id</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">set</span> emp.dept_name <span class="operator">=</span> dept.dept_name</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">where</span> emp.dept_id <span class="operator">=</span> <span class="number">11</span>;</span><br><span class="line">Query OK, <span class="number">2</span> <span class="keyword">rows</span> affected (<span class="number">0.01</span> sec)</span><br><span class="line"><span class="keyword">Rows</span> matched: <span class="number">2</span>  Changed: <span class="number">2</span>  Warnings: <span class="number">0</span></span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> </span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp;</span><br><span class="line"><span class="operator">+</span><span class="comment">--------+----------+--------+---------+-------------+---------+-----------+</span></span><br><span class="line"><span class="operator">|</span> emp_id <span class="operator">|</span> emp_name <span class="operator">|</span> gender <span class="operator">|</span> salary  <span class="operator">|</span> phone       <span class="operator">|</span> dept_id <span class="operator">|</span> dept_name <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------+----------+--------+---------+-------------+---------+-----------+</span></span><br><span class="line"><span class="operator">|</span>      <span class="number">1</span> <span class="operator">|</span> Jack     <span class="operator">|</span> 男     <span class="operator">|</span> <span class="number">4725.00</span> <span class="operator">|</span> <span class="number">15937321555</span> <span class="operator">|</span>      <span class="number">11</span> <span class="operator">|</span> 人事部    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>   <span class="number">1101</span> <span class="operator">|</span> Mark     <span class="operator">|</span> 男     <span class="operator">|</span> <span class="number">7455.00</span> <span class="operator">|</span> <span class="number">15903732155</span> <span class="operator">|</span>      <span class="number">11</span> <span class="operator">|</span> 人事部    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>   <span class="number">1102</span> <span class="operator">|</span> Rose     <span class="operator">|</span> 女     <span class="operator">|</span> <span class="number">6510.00</span> <span class="operator">|</span> <span class="number">15937321666</span> <span class="operator">|</span>      <span class="number">12</span> <span class="operator">|</span> <span class="keyword">NULL</span>      <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>   <span class="number">1103</span> <span class="operator">|</span> Jerry    <span class="operator">|</span> 男     <span class="operator">|</span> <span class="number">3885.00</span> <span class="operator">|</span> <span class="number">15537312999</span> <span class="operator">|</span>      <span class="number">12</span> <span class="operator">|</span> <span class="keyword">NULL</span>      <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------+----------+--------+---------+-------------+---------+-----------+</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>（2）有两个表 stu 和 certificate，使用 stu 表的 s_name 和 phone 列的数据更新 certificate 表。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> stu;</span><br><span class="line"><span class="operator">+</span><span class="comment">------+--------+---------------------+-------------+----------+</span></span><br><span class="line"><span class="operator">|</span> s_no <span class="operator">|</span> s_name <span class="operator">|</span> birth               <span class="operator">|</span> phone       <span class="operator">|</span> addr     <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------+--------+---------------------+-------------+----------+</span></span><br><span class="line"><span class="operator">|</span>    <span class="number">1</span> <span class="operator">|</span> Jack   <span class="operator">|</span> <span class="number">1999</span><span class="number">-01</span><span class="number">-23</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> <span class="operator">|</span> <span class="number">13703735566</span> <span class="operator">|</span> Beijing  <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>    <span class="number">2</span> <span class="operator">|</span> Mark   <span class="operator">|</span> <span class="number">1999</span><span class="number">-10</span><span class="number">-03</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> <span class="operator">|</span> <span class="number">13783735566</span> <span class="operator">|</span> Beijing  <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>    <span class="number">3</span> <span class="operator">|</span> Rose   <span class="operator">|</span> <span class="number">2000</span><span class="number">-11</span><span class="number">-21</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> <span class="operator">|</span> <span class="number">13783735522</span> <span class="operator">|</span> Shanghai <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>    <span class="number">4</span> <span class="operator">|</span> John   <span class="operator">|</span> <span class="number">2000</span><span class="number">-03</span><span class="number">-04</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> <span class="operator">|</span> <span class="number">18503735214</span> <span class="operator">|</span> Xinxiang <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>    <span class="number">5</span> <span class="operator">|</span> Jerry  <span class="operator">|</span> <span class="number">2001</span><span class="number">-04</span><span class="number">-25</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> <span class="operator">|</span> <span class="number">13303735266</span> <span class="operator">|</span> Xinxiang <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------+--------+---------------------+-------------+----------+</span></span><br><span class="line"><span class="number">5</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> certificate;</span><br><span class="line"><span class="operator">+</span><span class="comment">------+--------+-------+-----------------+</span></span><br><span class="line"><span class="operator">|</span> s_no <span class="operator">|</span> s_name <span class="operator">|</span> phone <span class="operator">|</span> certificate     <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------+--------+-------+-----------------+</span></span><br><span class="line"><span class="operator">|</span>    <span class="number">1</span> <span class="operator">|</span> <span class="keyword">NULL</span>   <span class="operator">|</span> <span class="keyword">NULL</span>  <span class="operator">|</span> 英语四级        <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>    <span class="number">2</span> <span class="operator">|</span> <span class="keyword">NULL</span>   <span class="operator">|</span> <span class="keyword">NULL</span>  <span class="operator">|</span> 英语四级        <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>    <span class="number">3</span> <span class="operator">|</span> <span class="keyword">NULL</span>   <span class="operator">|</span> <span class="keyword">NULL</span>  <span class="operator">|</span> 英语六级        <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>    <span class="number">4</span> <span class="operator">|</span> <span class="keyword">NULL</span>   <span class="operator">|</span> <span class="keyword">NULL</span>  <span class="operator">|</span> 计算机二级      <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>    <span class="number">5</span> <span class="operator">|</span> <span class="keyword">NULL</span>   <span class="operator">|</span> <span class="keyword">NULL</span>  <span class="operator">|</span> 英语四级        <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------+--------+-------+-----------------+</span></span><br><span class="line"><span class="number">5</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">update</span> certificate c <span class="keyword">join</span> stu s <span class="keyword">on</span> c.s_no <span class="operator">=</span> s.s_no</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">set</span> c.s_name <span class="operator">=</span> s.s_name, c.phone <span class="operator">=</span> s.phone;</span><br><span class="line">Query OK, <span class="number">5</span> <span class="keyword">rows</span> affected (<span class="number">0.01</span> sec)</span><br><span class="line"><span class="keyword">Rows</span> matched: <span class="number">5</span>  Changed: <span class="number">5</span>  Warnings: <span class="number">0</span></span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> certificate;</span><br><span class="line"><span class="operator">+</span><span class="comment">------+--------+-------------+-----------------+</span></span><br><span class="line"><span class="operator">|</span> s_no <span class="operator">|</span> s_name <span class="operator">|</span> phone       <span class="operator">|</span> certificate     <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------+--------+-------------+-----------------+</span></span><br><span class="line"><span class="operator">|</span>    <span class="number">1</span> <span class="operator">|</span> Jack   <span class="operator">|</span> <span class="number">13703735566</span> <span class="operator">|</span> 英语四级        <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>    <span class="number">2</span> <span class="operator">|</span> Mark   <span class="operator">|</span> <span class="number">13783735566</span> <span class="operator">|</span> 英语四级        <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>    <span class="number">3</span> <span class="operator">|</span> Rose   <span class="operator">|</span> <span class="number">13783735522</span> <span class="operator">|</span> 英语六级        <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>    <span class="number">4</span> <span class="operator">|</span> John   <span class="operator">|</span> <span class="number">18503735214</span> <span class="operator">|</span> 计算机二级      <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>    <span class="number">5</span> <span class="operator">|</span> Jerry  <span class="operator">|</span> <span class="number">13303735266</span> <span class="operator">|</span> 英语四级        <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------+--------+-------------+-----------------+</span></span><br><span class="line"><span class="number">5</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h1 id="数据更新之DELETE"><a href="#数据更新之DELETE" class="headerlink" title="数据更新之DELETE"></a>数据更新之DELETE</h1><h2 id="一、使用-delete-命令删除表中的数据"><a href="#一、使用-delete-命令删除表中的数据" class="headerlink" title="一、使用 delete 命令删除表中的数据"></a>一、使用 delete 命令删除表中的数据</h2><p>格式如下：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> 表名</span><br><span class="line">    [<span class="keyword">WHERE</span> 条件]</span><br><span class="line">    [<span class="keyword">ORDER</span> <span class="keyword">BY</span> ...]</span><br><span class="line">    [LIMIT row_count]</span><br><span class="line">    </span><br><span class="line">说明：</span><br><span class="line">（<span class="number">1</span>） <span class="keyword">ORDER</span> <span class="keyword">BY</span>：按照指定的顺序对行删除操作。</span><br><span class="line">（<span class="number">2</span>） LIMIT：限制可删除的行数。</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>举例：</p>
<p>（1）从 certificate 表删除 phone 为 133 开头的记录</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> certificate;</span><br><span class="line"><span class="operator">+</span><span class="comment">------+--------+-------------+-----------------+</span></span><br><span class="line"><span class="operator">|</span> s_no <span class="operator">|</span> s_name <span class="operator">|</span> phone       <span class="operator">|</span> certificate     <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------+--------+-------------+-----------------+</span></span><br><span class="line"><span class="operator">|</span>    <span class="number">1</span> <span class="operator">|</span> Jack   <span class="operator">|</span> <span class="number">13703735566</span> <span class="operator">|</span> 英语四级        <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>    <span class="number">2</span> <span class="operator">|</span> Mark   <span class="operator">|</span> <span class="number">13783735566</span> <span class="operator">|</span> 英语四级        <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>    <span class="number">3</span> <span class="operator">|</span> Rose   <span class="operator">|</span> <span class="number">13783735522</span> <span class="operator">|</span> 英语六级        <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>    <span class="number">4</span> <span class="operator">|</span> John   <span class="operator">|</span> <span class="number">18503735214</span> <span class="operator">|</span> 计算机二级      <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>    <span class="number">5</span> <span class="operator">|</span> Jerry  <span class="operator">|</span> <span class="number">13303735266</span> <span class="operator">|</span> 英语四级        <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------+--------+-------------+-----------------+</span></span><br><span class="line"><span class="number">5</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">delete</span> <span class="keyword">from</span> certificate <span class="keyword">where</span> phone <span class="keyword">like</span> <span class="string">&#x27;133%&#x27;</span>;</span><br><span class="line">Query OK, <span class="number">1</span> <span class="type">row</span> affected (<span class="number">0.02</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> certificate;</span><br><span class="line"><span class="operator">+</span><span class="comment">------+--------+-------------+-----------------+</span></span><br><span class="line"><span class="operator">|</span> s_no <span class="operator">|</span> s_name <span class="operator">|</span> phone       <span class="operator">|</span> certificate     <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------+--------+-------------+-----------------+</span></span><br><span class="line"><span class="operator">|</span>    <span class="number">1</span> <span class="operator">|</span> Jack   <span class="operator">|</span> <span class="number">13703735566</span> <span class="operator">|</span> 英语四级        <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>    <span class="number">2</span> <span class="operator">|</span> Mark   <span class="operator">|</span> <span class="number">13783735566</span> <span class="operator">|</span> 英语四级        <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>    <span class="number">3</span> <span class="operator">|</span> Rose   <span class="operator">|</span> <span class="number">13783735522</span> <span class="operator">|</span> 英语六级        <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>    <span class="number">4</span> <span class="operator">|</span> John   <span class="operator">|</span> <span class="number">18503735214</span> <span class="operator">|</span> 计算机二级      <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------+--------+-------------+-----------------+</span></span><br><span class="line"><span class="number">4</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>（2）删除时限制删除的行数：从 certificate 表删除 phone 为 137 开头的记录，但一次最多删除两行。并且按学号降序的顺序删除。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> certificate;</span><br><span class="line"><span class="operator">+</span><span class="comment">------+--------+-------------+-----------------+</span></span><br><span class="line"><span class="operator">|</span> s_no <span class="operator">|</span> s_name <span class="operator">|</span> phone       <span class="operator">|</span> certificate     <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------+--------+-------------+-----------------+</span></span><br><span class="line"><span class="operator">|</span>    <span class="number">1</span> <span class="operator">|</span> Jack   <span class="operator">|</span> <span class="number">13703735566</span> <span class="operator">|</span> 英语四级        <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>    <span class="number">2</span> <span class="operator">|</span> Mark   <span class="operator">|</span> <span class="number">13783735566</span> <span class="operator">|</span> 英语四级        <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>    <span class="number">3</span> <span class="operator">|</span> Rose   <span class="operator">|</span> <span class="number">13783735522</span> <span class="operator">|</span> 英语六级        <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>    <span class="number">4</span> <span class="operator">|</span> John   <span class="operator">|</span> <span class="number">18503735214</span> <span class="operator">|</span> 计算机二级      <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------+--------+-------------+-----------------+</span></span><br><span class="line"><span class="number">4</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">delete</span> <span class="keyword">from</span> certificate <span class="keyword">where</span> phone <span class="keyword">like</span> <span class="string">&#x27;137%&#x27;</span></span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">order</span> <span class="keyword">by</span> s_no <span class="keyword">desc</span></span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> limit <span class="number">2</span>;</span><br><span class="line">Query OK, <span class="number">2</span> <span class="keyword">rows</span> affected (<span class="number">0.07</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> certificate;</span><br><span class="line"><span class="operator">+</span><span class="comment">------+--------+-------------+-----------------+</span></span><br><span class="line"><span class="operator">|</span> s_no <span class="operator">|</span> s_name <span class="operator">|</span> phone       <span class="operator">|</span> certificate     <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------+--------+-------------+-----------------+</span></span><br><span class="line"><span class="operator">|</span>    <span class="number">1</span> <span class="operator">|</span> Jack   <span class="operator">|</span> <span class="number">13703735566</span> <span class="operator">|</span> 英语四级        <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>    <span class="number">4</span> <span class="operator">|</span> John   <span class="operator">|</span> <span class="number">18503735214</span> <span class="operator">|</span> 计算机二级      <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------+--------+-------------+-----------------+</span></span><br><span class="line"><span class="number">2</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.01</span> sec)</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>二、使用 truncate 命令删除表中的数据<br>使用 truncate 命令可以删除表中的所有数据，和不带条件的 delete 命令结果相同。两个命令的区别有两点：<br>（1）delete 命令在删除时逐行判断和删除，效率较低；truncate 命令是直接删除表，然后重建表，因此删除的效率很高。<br>（2）当表中有自增字段时，如果使用 delete 命令删除全部记录，当重新插入记录时，自增字段的值从删除之前的编号的最大值开始增加。如果使用 truncate 命令删除全部记录，重新插入记录时，自增字段的值将重新开始编号。</p>
<p>truncate 命令的语法如下：</p>
<p>truncate [TABLE] 表名;<br>1<br>举例：</p>
<p>（1）创建表 t1，id 为自增字段，初始值为 1，然后插入数据。根据 t1 表生成 t2，t2 表的结构和数据与 t1 表完全相同。</p>
<p>结果如下：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">desc</span> t1;</span><br><span class="line"><span class="operator">+</span><span class="comment">-------+----------+------+-----+---------+----------------+</span></span><br><span class="line"><span class="operator">|</span> Field <span class="operator">|</span> Type     <span class="operator">|</span> <span class="keyword">Null</span> <span class="operator">|</span> Key <span class="operator">|</span> <span class="keyword">Default</span> <span class="operator">|</span> Extra          <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------+----------+------+-----+---------+----------------+</span></span><br><span class="line"><span class="operator">|</span> id    <span class="operator">|</span> <span class="type">int</span>(<span class="number">11</span>)  <span class="operator">|</span> <span class="keyword">NO</span>   <span class="operator">|</span> PRI <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span> auto_increment <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> name  <span class="operator">|</span> <span class="type">char</span>(<span class="number">20</span>) <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>                <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------+----------+------+-----+---------+----------------+</span></span><br><span class="line"><span class="number">2</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> t1;</span><br><span class="line"><span class="operator">+</span><span class="comment">----+-------+</span></span><br><span class="line"><span class="operator">|</span> id <span class="operator">|</span> name  <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----+-------+</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">1</span> <span class="operator">|</span> zhang <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">2</span> <span class="operator">|</span> wang  <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">3</span> <span class="operator">|</span> li    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">4</span> <span class="operator">|</span> zhao  <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">5</span> <span class="operator">|</span> liu   <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----+-------+</span></span><br><span class="line"><span class="number">5</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">create</span> <span class="keyword">table</span> t2 <span class="keyword">like</span> t1;</span><br><span class="line">Query OK, <span class="number">0</span> <span class="keyword">rows</span> affected (<span class="number">0.02</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">insert</span> <span class="keyword">into</span> t2 <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> t1;</span><br><span class="line">Query OK, <span class="number">5</span> <span class="keyword">rows</span> affected (<span class="number">0.08</span> sec)</span><br><span class="line">Records: <span class="number">5</span>  Duplicates: <span class="number">0</span>  Warnings: <span class="number">0</span></span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">desc</span> t2;</span><br><span class="line"><span class="operator">+</span><span class="comment">-------+----------+------+-----+---------+----------------+</span></span><br><span class="line"><span class="operator">|</span> Field <span class="operator">|</span> Type     <span class="operator">|</span> <span class="keyword">Null</span> <span class="operator">|</span> Key <span class="operator">|</span> <span class="keyword">Default</span> <span class="operator">|</span> Extra          <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------+----------+------+-----+---------+----------------+</span></span><br><span class="line"><span class="operator">|</span> id    <span class="operator">|</span> <span class="type">int</span>(<span class="number">11</span>)  <span class="operator">|</span> <span class="keyword">NO</span>   <span class="operator">|</span> PRI <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span> auto_increment <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> name  <span class="operator">|</span> <span class="type">char</span>(<span class="number">20</span>) <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>                <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------+----------+------+-----+---------+----------------+</span></span><br><span class="line"><span class="number">2</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> t2;</span><br><span class="line"><span class="operator">+</span><span class="comment">----+-------+</span></span><br><span class="line"><span class="operator">|</span> id <span class="operator">|</span> name  <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----+-------+</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">1</span> <span class="operator">|</span> zhang <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">2</span> <span class="operator">|</span> wang  <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">3</span> <span class="operator">|</span> li    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">4</span> <span class="operator">|</span> zhao  <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">5</span> <span class="operator">|</span> liu   <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----+-------+</span></span><br><span class="line"><span class="number">5</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>（2）使用 delete 命令删除 t1 表中的所有数据，然后插入新记录</p>
<p>可以看到，新插入的记录 id 从 6 开始编号。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">delete</span> <span class="keyword">from</span> t1;</span><br><span class="line">Query OK, <span class="number">5</span> <span class="keyword">rows</span> affected (<span class="number">0.02</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">insert</span> <span class="keyword">into</span> t1(name) <span class="keyword">values</span>(<span class="string">&#x27;Tom&#x27;</span>),(<span class="string">&#x27;Jack&#x27;</span>),(<span class="string">&#x27;Jerry&#x27;</span>);</span><br><span class="line">Query OK, <span class="number">3</span> <span class="keyword">rows</span> affected (<span class="number">0.02</span> sec)</span><br><span class="line">Records: <span class="number">3</span>  Duplicates: <span class="number">0</span>  Warnings: <span class="number">0</span></span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> t1;</span><br><span class="line"><span class="operator">+</span><span class="comment">----+-------+</span></span><br><span class="line"><span class="operator">|</span> id <span class="operator">|</span> name  <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----+-------+</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">6</span> <span class="operator">|</span> Tom   <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">7</span> <span class="operator">|</span> Jack  <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">8</span> <span class="operator">|</span> Jerry <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----+-------+</span></span><br><span class="line"><span class="number">3</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>（3）使用 truncate 命令删除 t2 表中的所有数据，然后插入新记录</p>
<p>可以看到，新插入的记录 id 从 1 重新开始编号。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">truncate</span> <span class="keyword">table</span> t2;</span><br><span class="line">Query OK, <span class="number">0</span> <span class="keyword">rows</span> affected (<span class="number">0.03</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">insert</span> <span class="keyword">into</span> t2(name) <span class="keyword">values</span>(<span class="string">&#x27;Tom&#x27;</span>),(<span class="string">&#x27;Jack&#x27;</span>),(<span class="string">&#x27;Jerry&#x27;</span>);</span><br><span class="line">Query OK, <span class="number">3</span> <span class="keyword">rows</span> affected (<span class="number">0.03</span> sec)</span><br><span class="line">Records: <span class="number">3</span>  Duplicates: <span class="number">0</span>  Warnings: <span class="number">0</span></span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> t2;</span><br><span class="line"><span class="operator">+</span><span class="comment">----+-------+</span></span><br><span class="line"><span class="operator">|</span> id <span class="operator">|</span> name  <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----+-------+</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">1</span> <span class="operator">|</span> Tom   <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">2</span> <span class="operator">|</span> Jack  <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">3</span> <span class="operator">|</span> Jerry <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----+-------+</span></span><br><span class="line"><span class="number">3</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="完整性约束概述"><a href="#完整性约束概述" class="headerlink" title="完整性约束概述"></a>完整性约束概述</h1><p>数据完整性是指数据的正确性和相容性，是为了防止数据库中存在不符合语义的数据，即防止数据库中存在不正确的数据。在MySQL中提供了多种完整性约束。完整性约束根据约束的规则不同可分为三类：</p>
<p>（1）实体完整性：可以保证数据的唯一性。可以使用主键约束与唯一性约束来定义。<br>（2）参照完整性：一个表中某个字段的取值要参照另一个表的主键。使用外键约束来定义。<br>（3）域完整性：又称为用户自定义完整性。可以针对某个列的取值由用户定义约束的规则。</p>
<p>MySQL中的完整性约束如下表所示：</p>
<p>完整性约束	说明<br>PRIMARY KEY	主键约束（实体完整性）<br>UNIQUE	唯一性约束（实体完整性）<br>FOREIGN KEY	外键约束（参照完整性）<br>NOT NULL	非空约束（域完整性）<br>AUTO_INCREMENT	自增字段<br>DEFAULT	默认值</p>
<h2 id="一、主键约束"><a href="#一、主键约束" class="headerlink" title="一、主键约束"></a>一、主键约束</h2><p>主键是表中的某一个或多个列，由多个列组合而成的主键也称为复合主键。主键的取值能够唯一标识表中的记录。主键的定义必须遵守以下规则：</p>
<p>（1）一个表只能定义一个主键。<br>（2）主键的值必须能够唯一标识表中的每一条记录，且不能为空（NULL）。</p>
<h3 id="创建表时定义"><a href="#创建表时定义" class="headerlink" title="创建表时定义"></a>创建表时定义</h3><h4 id="1、定义列时同时定义主键"><a href="#1、定义列时同时定义主键" class="headerlink" title="1、定义列时同时定义主键"></a>1、定义列时同时定义主键</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> 表名 (</span><br><span class="line">    <span class="operator">&lt;</span>字段名<span class="operator">&gt;</span> <span class="operator">&lt;</span>数据类型<span class="operator">&gt;</span> <span class="keyword">PRIMARY</span> KEY [AUTO_INCREMENT],</span><br><span class="line">    ....</span><br><span class="line">);</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">create</span> <span class="keyword">table</span> emp001(</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span>     id <span class="type">int</span> <span class="keyword">primary</span> key auto_increment,</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span>     name <span class="type">char</span>(<span class="number">20</span>),</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span>     salary <span class="type">decimal</span>(<span class="number">8</span>,<span class="number">1</span>)</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> );</span><br><span class="line">Query OK, <span class="number">0</span> <span class="keyword">rows</span> affected (<span class="number">0.02</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">desc</span> emp001;</span><br><span class="line"><span class="operator">+</span><span class="comment">--------+--------------+------+-----+---------+----------------+</span></span><br><span class="line"><span class="operator">|</span> Field  <span class="operator">|</span> Type         <span class="operator">|</span> <span class="keyword">Null</span> <span class="operator">|</span> Key <span class="operator">|</span> <span class="keyword">Default</span> <span class="operator">|</span> Extra          <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------+--------------+------+-----+---------+----------------+</span></span><br><span class="line"><span class="operator">|</span> id     <span class="operator">|</span> <span class="type">int</span>(<span class="number">11</span>)      <span class="operator">|</span> <span class="keyword">NO</span>   <span class="operator">|</span> PRI <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span> auto_increment <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> name   <span class="operator">|</span> <span class="type">char</span>(<span class="number">20</span>)     <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>                <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> salary <span class="operator">|</span> <span class="type">decimal</span>(<span class="number">8</span>,<span class="number">1</span>) <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>                <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------+--------------+------+-----+---------+----------------+</span></span><br><span class="line"><span class="number">3</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">show</span> <span class="keyword">create</span> <span class="keyword">table</span> emp001\G</span><br><span class="line"><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span> <span class="number">1.</span> <span class="type">row</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">       <span class="keyword">Table</span>: emp001</span><br><span class="line"><span class="keyword">Create</span> <span class="keyword">Table</span>: <span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `emp001` (</span><br><span class="line">  `id` <span class="type">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT,</span><br><span class="line">  `name` <span class="type">char</span>(<span class="number">20</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `salary` <span class="type">decimal</span>(<span class="number">8</span>,<span class="number">1</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  <span class="keyword">PRIMARY</span> KEY (`id`)</span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8mb4</span><br><span class="line"><span class="number">1</span> <span class="type">row</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="2、在定义完所有列之后定义主键"><a href="#2、在定义完所有列之后定义主键" class="headerlink" title="2、在定义完所有列之后定义主键"></a>2、在定义完所有列之后定义主键</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> 表名 (</span><br><span class="line">    <span class="operator">&lt;</span>字段定义<span class="operator">&gt;</span>... ,</span><br><span class="line">    <span class="keyword">PRIMARY</span> KEY (字段名)</span><br><span class="line">);</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">create</span> <span class="keyword">table</span> stu001(</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span>     s_no <span class="type">char</span>(<span class="number">11</span>),</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span>     s_name <span class="type">char</span>(<span class="number">20</span>),</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span>     birth datetime,</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span>     <span class="keyword">primary</span> key(s_no)</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> );</span><br><span class="line">Query OK, <span class="number">0</span> <span class="keyword">rows</span> affected (<span class="number">0.04</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">desc</span> stu001;</span><br><span class="line"><span class="operator">+</span><span class="comment">--------+----------+------+-----+---------+-------+</span></span><br><span class="line"><span class="operator">|</span> Field  <span class="operator">|</span> Type     <span class="operator">|</span> <span class="keyword">Null</span> <span class="operator">|</span> Key <span class="operator">|</span> <span class="keyword">Default</span> <span class="operator">|</span> Extra <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------+----------+------+-----+---------+-------+</span></span><br><span class="line"><span class="operator">|</span> s_no   <span class="operator">|</span> <span class="type">char</span>(<span class="number">11</span>) <span class="operator">|</span> <span class="keyword">NO</span>   <span class="operator">|</span> PRI <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>       <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> s_name <span class="operator">|</span> <span class="type">char</span>(<span class="number">20</span>) <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>       <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> birth  <span class="operator">|</span> datetime <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>       <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------+----------+------+-----+---------+-------+</span></span><br><span class="line"><span class="number">3</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.01</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">show</span> <span class="keyword">create</span> <span class="keyword">table</span> stu001\G</span><br><span class="line"><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span> <span class="number">1.</span> <span class="type">row</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">       <span class="keyword">Table</span>: stu001</span><br><span class="line"><span class="keyword">Create</span> <span class="keyword">Table</span>: <span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `stu001` (</span><br><span class="line">  `s_no` <span class="type">char</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `s_name` <span class="type">char</span>(<span class="number">20</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `birth` datetime <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  <span class="keyword">PRIMARY</span> KEY (`s_no`)</span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8mb4</span><br><span class="line"><span class="number">1</span> <span class="type">row</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br></pre></td></tr></table></figure>





<h3 id="定义多列主键"><a href="#定义多列主键" class="headerlink" title="定义多列主键"></a>定义多列主键</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">create</span> <span class="keyword">table</span> score(</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span>     stu_no <span class="type">char</span>(<span class="number">11</span>),</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span>     course_no <span class="type">char</span>(<span class="number">10</span>),</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span>     socre <span class="type">int</span>,</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span>     <span class="keyword">primary</span> key(stu_no,course_no)</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> );</span><br><span class="line">Query OK, <span class="number">0</span> <span class="keyword">rows</span> affected (<span class="number">0.02</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">desc</span> score;</span><br><span class="line"><span class="operator">+</span><span class="comment">-----------+----------+------+-----+---------+-------+</span></span><br><span class="line"><span class="operator">|</span> Field     <span class="operator">|</span> Type     <span class="operator">|</span> <span class="keyword">Null</span> <span class="operator">|</span> Key <span class="operator">|</span> <span class="keyword">Default</span> <span class="operator">|</span> Extra <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-----------+----------+------+-----+---------+-------+</span></span><br><span class="line"><span class="operator">|</span> stu_no    <span class="operator">|</span> <span class="type">char</span>(<span class="number">11</span>) <span class="operator">|</span> <span class="keyword">NO</span>   <span class="operator">|</span> PRI <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>       <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> course_no <span class="operator">|</span> <span class="type">char</span>(<span class="number">10</span>) <span class="operator">|</span> <span class="keyword">NO</span>   <span class="operator">|</span> PRI <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>       <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> socre     <span class="operator">|</span> <span class="type">int</span>(<span class="number">11</span>)  <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>       <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-----------+----------+------+-----+---------+-------+</span></span><br><span class="line"><span class="number">3</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">show</span> <span class="keyword">create</span> <span class="keyword">table</span> score\G</span><br><span class="line"><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span> <span class="number">1.</span> <span class="type">row</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">       <span class="keyword">Table</span>: score</span><br><span class="line"><span class="keyword">Create</span> <span class="keyword">Table</span>: <span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `score` (</span><br><span class="line">  `stu_no` <span class="type">char</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `course_no` <span class="type">char</span>(<span class="number">10</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `socre` <span class="type">int</span>(<span class="number">11</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  <span class="keyword">PRIMARY</span> KEY (`stu_no`,`course_no`)</span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8mb4</span><br><span class="line"><span class="number">1</span> <span class="type">row</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="创建表之后添加主键"><a href="#创建表之后添加主键" class="headerlink" title="创建表之后添加主键"></a>创建表之后添加主键</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> 表名 <span class="keyword">add</span> 列名 类型 <span class="keyword">primary</span> key [auto_increment];</span><br></pre></td></tr></table></figure>



<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">create</span> <span class="keyword">table</span> t11(name <span class="type">char</span>(<span class="number">11</span>));</span><br><span class="line">Query OK, <span class="number">0</span> <span class="keyword">rows</span> affected (<span class="number">0.02</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">alter</span> <span class="keyword">table</span> t11 <span class="keyword">add</span> id <span class="type">int</span> <span class="keyword">primary</span> key auto_increment <span class="keyword">first</span>;</span><br><span class="line">Query OK, <span class="number">0</span> <span class="keyword">rows</span> affected (<span class="number">0.05</span> sec)</span><br><span class="line">Records: <span class="number">0</span>  Duplicates: <span class="number">0</span>  Warnings: <span class="number">0</span></span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">desc</span> t11;</span><br><span class="line"><span class="operator">+</span><span class="comment">-------+----------+------+-----+---------+----------------+</span></span><br><span class="line"><span class="operator">|</span> Field <span class="operator">|</span> Type     <span class="operator">|</span> <span class="keyword">Null</span> <span class="operator">|</span> Key <span class="operator">|</span> <span class="keyword">Default</span> <span class="operator">|</span> Extra          <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------+----------+------+-----+---------+----------------+</span></span><br><span class="line"><span class="operator">|</span> id    <span class="operator">|</span> <span class="type">int</span>(<span class="number">11</span>)  <span class="operator">|</span> <span class="keyword">NO</span>   <span class="operator">|</span> PRI <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span> auto_increment <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> name  <span class="operator">|</span> <span class="type">char</span>(<span class="number">11</span>) <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>                <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------+----------+------+-----+---------+----------------+</span></span><br><span class="line"><span class="number">2</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">show</span> <span class="keyword">create</span> <span class="keyword">table</span> t11\G</span><br><span class="line"><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span> <span class="number">1.</span> <span class="type">row</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">       <span class="keyword">Table</span>: t11</span><br><span class="line"><span class="keyword">Create</span> <span class="keyword">Table</span>: <span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `t11` (</span><br><span class="line">  `id` <span class="type">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT,</span><br><span class="line">  `name` <span class="type">char</span>(<span class="number">11</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  <span class="keyword">PRIMARY</span> KEY (`id`)</span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8mb4</span><br><span class="line"><span class="number">1</span> <span class="type">row</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="把一个已经存在的列定义为主键"><a href="#把一个已经存在的列定义为主键" class="headerlink" title="把一个已经存在的列定义为主键"></a>把一个已经存在的列定义为主键</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> 表名 <span class="keyword">add</span> <span class="keyword">primary</span> key(列名);</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">create</span> <span class="keyword">table</span> t22(</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span>     id <span class="type">int</span> <span class="keyword">not</span> <span class="keyword">null</span>,</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span>     name <span class="type">char</span>(<span class="number">20</span>)</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> );</span><br><span class="line">Query OK, <span class="number">0</span> <span class="keyword">rows</span> affected (<span class="number">0.01</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">alter</span> <span class="keyword">table</span> t22 <span class="keyword">add</span> <span class="keyword">primary</span> key(id);</span><br><span class="line">Query OK, <span class="number">0</span> <span class="keyword">rows</span> affected (<span class="number">0.06</span> sec)</span><br><span class="line">Records: <span class="number">0</span>  Duplicates: <span class="number">0</span>  Warnings: <span class="number">0</span></span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">desc</span> t22;</span><br><span class="line"><span class="operator">+</span><span class="comment">-------+----------+------+-----+---------+-------+</span></span><br><span class="line"><span class="operator">|</span> Field <span class="operator">|</span> Type     <span class="operator">|</span> <span class="keyword">Null</span> <span class="operator">|</span> Key <span class="operator">|</span> <span class="keyword">Default</span> <span class="operator">|</span> Extra <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------+----------+------+-----+---------+-------+</span></span><br><span class="line"><span class="operator">|</span> id    <span class="operator">|</span> <span class="type">int</span>(<span class="number">11</span>)  <span class="operator">|</span> <span class="keyword">NO</span>   <span class="operator">|</span> PRI <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>       <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> name  <span class="operator">|</span> <span class="type">char</span>(<span class="number">20</span>) <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>       <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------+----------+------+-----+---------+-------+</span></span><br><span class="line"><span class="number">2</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">show</span> <span class="keyword">create</span> <span class="keyword">table</span> t22\G</span><br><span class="line"><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span> <span class="number">1.</span> <span class="type">row</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">       <span class="keyword">Table</span>: t22</span><br><span class="line"><span class="keyword">Create</span> <span class="keyword">Table</span>: <span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `t22` (</span><br><span class="line">  `id` <span class="type">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `name` <span class="type">char</span>(<span class="number">20</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  <span class="keyword">PRIMARY</span> KEY (`id`)</span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8mb4</span><br><span class="line"><span class="number">1</span> <span class="type">row</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="删除主键"><a href="#删除主键" class="headerlink" title="删除主键"></a>删除主键</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">alter</span> <span class="keyword">table</span> t22 <span class="keyword">drop</span> <span class="keyword">primary</span> key;</span><br><span class="line">Query OK, <span class="number">0</span> <span class="keyword">rows</span> affected (<span class="number">0.04</span> sec)</span><br><span class="line">Records: <span class="number">0</span>  Duplicates: <span class="number">0</span>  Warnings: <span class="number">0</span></span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">desc</span> t22;</span><br><span class="line"><span class="operator">+</span><span class="comment">-------+----------+------+-----+---------+-------+</span></span><br><span class="line"><span class="operator">|</span> Field <span class="operator">|</span> Type     <span class="operator">|</span> <span class="keyword">Null</span> <span class="operator">|</span> Key <span class="operator">|</span> <span class="keyword">Default</span> <span class="operator">|</span> Extra <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------+----------+------+-----+---------+-------+</span></span><br><span class="line"><span class="operator">|</span> id    <span class="operator">|</span> <span class="type">int</span>(<span class="number">11</span>)  <span class="operator">|</span> <span class="keyword">NO</span>   <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>       <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> name  <span class="operator">|</span> <span class="type">char</span>(<span class="number">20</span>) <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>       <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------+----------+------+-----+---------+-------+</span></span><br><span class="line"><span class="number">2</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">show</span> <span class="keyword">create</span> <span class="keyword">table</span> t22\G</span><br><span class="line"><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span> <span class="number">1.</span> <span class="type">row</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">       <span class="keyword">Table</span>: t22</span><br><span class="line"><span class="keyword">Create</span> <span class="keyword">Table</span>: <span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `t22` (</span><br><span class="line">  `id` <span class="type">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `name` <span class="type">char</span>(<span class="number">20</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span></span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8mb4</span><br><span class="line"><span class="number">1</span> <span class="type">row</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br></pre></td></tr></table></figure>





<h2 id="二、唯一约束"><a href="#二、唯一约束" class="headerlink" title="二、唯一约束"></a>二、唯一约束</h2><p>唯一约束使用 UNIQUE 关键字来定义。唯一约束的要求某一列的取值必须是唯一的，不能取重复值。主键约束同时也是唯一约束，唯一约束与主键之间存在以下区别：<br>（1）一个表只能创建一个主键，但可以定义多个唯一约束。<br>（2）定义主键约束时，系统会自动创建 PRIMARY KEY 索引，定义 UNIQUE 约束时，系统会自动创建 UNIQUE 索引。</p>
<h3 id="一、UNIQUE-约束与-PRIMARY-KEY-约束的区别和联系"><a href="#一、UNIQUE-约束与-PRIMARY-KEY-约束的区别和联系" class="headerlink" title="一、UNIQUE 约束与 PRIMARY KEY 约束的区别和联系"></a>一、UNIQUE 约束与 PRIMARY KEY 约束的区别和联系</h3><p>（1）唯一性约束所在的列允许空值，但是主键约束所在的列不允许空值。<br>（2）可以把唯一性约束放在一个或者多个列上，这些列或列的组合必须有唯一的。但是，唯一性约束所在的列并不是表的主键列。<br>（3）唯一性约束强制在指定的列上创建一个唯一性索引。<br>（4）一个表最多只有一个主键，但可以有多个唯一键。<br>（5）UNIQUE 约束 &#x3D; PRIMARY KEY 约束 + NOT NULL 。</p>
<h3 id="二、创建表时，同时创建-UNIQUE-约束"><a href="#二、创建表时，同时创建-UNIQUE-约束" class="headerlink" title="二、创建表时，同时创建 UNIQUE 约束"></a>二、创建表时，同时创建 UNIQUE 约束</h3><h3 id="1、定义列的同时定义-UNIQUE-约束"><a href="#1、定义列的同时定义-UNIQUE-约束" class="headerlink" title="1、定义列的同时定义 UNIQUE 约束"></a>1、定义列的同时定义 UNIQUE 约束</h3><p>语法如下：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> 表名 (</span><br><span class="line">    列名 类型 ... ,</span><br><span class="line">    列名 类型 <span class="keyword">unique</span>,</span><br><span class="line">    ....</span><br><span class="line">);</span><br><span class="line">说明：该方法不能指定约束名。可以使用【<span class="keyword">show</span> index <span class="keyword">from</span> 表名; 】命令查看索引名。</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">create</span> <span class="keyword">table</span> t12 (</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span>     id <span class="type">int</span> <span class="keyword">primary</span> key auto_increment,</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span>     name <span class="type">char</span>(<span class="number">20</span>),</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span>     phone <span class="type">char</span>(<span class="number">11</span>) <span class="keyword">unique</span>,</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span>     ID_number <span class="type">char</span>(<span class="number">18</span>) <span class="keyword">unique</span></span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> );</span><br><span class="line">Query OK, <span class="number">0</span> <span class="keyword">rows</span> affected (<span class="number">0.02</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">desc</span> t12;</span><br><span class="line"><span class="operator">+</span><span class="comment">-----------+----------+------+-----+---------+----------------+</span></span><br><span class="line"><span class="operator">|</span> Field     <span class="operator">|</span> Type     <span class="operator">|</span> <span class="keyword">Null</span> <span class="operator">|</span> Key <span class="operator">|</span> <span class="keyword">Default</span> <span class="operator">|</span> Extra          <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-----------+----------+------+-----+---------+----------------+</span></span><br><span class="line"><span class="operator">|</span> id        <span class="operator">|</span> <span class="type">int</span>(<span class="number">11</span>)  <span class="operator">|</span> <span class="keyword">NO</span>   <span class="operator">|</span> PRI <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span> auto_increment <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> name      <span class="operator">|</span> <span class="type">char</span>(<span class="number">20</span>) <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>                <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> phone     <span class="operator">|</span> <span class="type">char</span>(<span class="number">11</span>) <span class="operator">|</span> YES  <span class="operator">|</span> UNI <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>                <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> ID_number <span class="operator">|</span> <span class="type">char</span>(<span class="number">18</span>) <span class="operator">|</span> YES  <span class="operator">|</span> UNI <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>                <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-----------+----------+------+-----+---------+----------------+</span></span><br><span class="line"><span class="number">4</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">show</span> index <span class="keyword">from</span> t12;</span><br><span class="line"><span class="operator">+</span><span class="comment">-------+------------+-----------+--------------+-------------+-----------+-------------</span></span><br><span class="line"><span class="operator">|</span> <span class="keyword">Table</span> <span class="operator">|</span> Non_unique <span class="operator">|</span> Key_name  <span class="operator">|</span> Seq_in_index <span class="operator">|</span> Column_name <span class="operator">|</span> <span class="keyword">Collation</span> <span class="operator">|</span> <span class="keyword">Cardinality</span> </span><br><span class="line"><span class="operator">+</span><span class="comment">-------+------------+-----------+--------------+-------------+-----------+-------------</span></span><br><span class="line"><span class="operator">|</span> t12   <span class="operator">|</span>          <span class="number">0</span> <span class="operator">|</span> <span class="keyword">PRIMARY</span>   <span class="operator">|</span>            <span class="number">1</span> <span class="operator">|</span> id          <span class="operator">|</span> A         <span class="operator">|</span>           <span class="number">0</span> </span><br><span class="line"><span class="operator">|</span> t12   <span class="operator">|</span>          <span class="number">0</span> <span class="operator">|</span> phone     <span class="operator">|</span>            <span class="number">1</span> <span class="operator">|</span> phone       <span class="operator">|</span> A         <span class="operator">|</span>           <span class="number">0</span> </span><br><span class="line"><span class="operator">|</span> t12   <span class="operator">|</span>          <span class="number">0</span> <span class="operator">|</span> ID_number <span class="operator">|</span>            <span class="number">1</span> <span class="operator">|</span> ID_number   <span class="operator">|</span> A         <span class="operator">|</span>           <span class="number">0</span> </span><br><span class="line"><span class="operator">+</span><span class="comment">-------+------------+-----------+--------------+-------------+-----------+-------------</span></span><br><span class="line"><span class="number">3</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line"><span class="comment">-- unique 约束的名称默认和字段名相同。</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="2、在所有的列定义之后定义-UNIQUE-约束"><a href="#2、在所有的列定义之后定义-UNIQUE-约束" class="headerlink" title="2、在所有的列定义之后定义 UNIQUE 约束"></a>2、在所有的列定义之后定义 UNIQUE 约束</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> 表名 (</span><br><span class="line">    列名 类型 ... ,</span><br><span class="line">    [<span class="keyword">constraint</span> 约束名] <span class="keyword">unique</span>(列名)</span><br><span class="line">);</span><br><span class="line">说明：该方法可以指定约束名。可以使用【<span class="keyword">show</span> index <span class="keyword">from</span> 表名; 】命令查看索引名。</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">create</span> <span class="keyword">table</span> t13 (</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span>  id <span class="type">int</span> <span class="keyword">primary</span> key auto_increment,</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span>  name <span class="type">char</span>(<span class="number">20</span>),</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span>  phone <span class="type">char</span>(<span class="number">11</span>),</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span>  ID_number <span class="type">char</span>(<span class="number">18</span>),</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span>  <span class="keyword">constraint</span> uq_phone <span class="keyword">unique</span>(phone),</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span>  <span class="keyword">constraint</span> uq_ID_number <span class="keyword">unique</span>(ID_number)</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span>);</span><br><span class="line">Query OK, <span class="number">0</span> <span class="keyword">rows</span> affected (<span class="number">0.04</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">desc</span> t13;</span><br><span class="line"><span class="operator">+</span><span class="comment">-----------+----------+------+-----+---------+----------------+</span></span><br><span class="line"><span class="operator">|</span> Field     <span class="operator">|</span> Type     <span class="operator">|</span> <span class="keyword">Null</span> <span class="operator">|</span> Key <span class="operator">|</span> <span class="keyword">Default</span> <span class="operator">|</span> Extra          <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-----------+----------+------+-----+---------+----------------+</span></span><br><span class="line"><span class="operator">|</span> id        <span class="operator">|</span> <span class="type">int</span>(<span class="number">11</span>)  <span class="operator">|</span> <span class="keyword">NO</span>   <span class="operator">|</span> PRI <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span> auto_increment <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> name      <span class="operator">|</span> <span class="type">char</span>(<span class="number">20</span>) <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>                <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> phone     <span class="operator">|</span> <span class="type">char</span>(<span class="number">11</span>) <span class="operator">|</span> YES  <span class="operator">|</span> UNI <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>                <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> ID_number <span class="operator">|</span> <span class="type">char</span>(<span class="number">18</span>) <span class="operator">|</span> YES  <span class="operator">|</span> UNI <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>                <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-----------+----------+------+-----+---------+----------------+</span></span><br><span class="line"><span class="number">4</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">show</span> index <span class="keyword">from</span> t13;</span><br><span class="line"><span class="operator">+</span><span class="comment">-------+------------+--------------+--------------+-------------+-----------</span></span><br><span class="line"><span class="operator">|</span> <span class="keyword">Table</span> <span class="operator">|</span> Non_unique <span class="operator">|</span> Key_name     <span class="operator">|</span> Seq_in_index <span class="operator">|</span> Column_name <span class="operator">|</span> <span class="keyword">Collation</span> </span><br><span class="line"><span class="operator">+</span><span class="comment">-------+------------+--------------+--------------+-------------+-----------</span></span><br><span class="line"><span class="operator">|</span> t13   <span class="operator">|</span>          <span class="number">0</span> <span class="operator">|</span> <span class="keyword">PRIMARY</span>      <span class="operator">|</span>            <span class="number">1</span> <span class="operator">|</span> id          <span class="operator">|</span> A         </span><br><span class="line"><span class="operator">|</span> t13   <span class="operator">|</span>          <span class="number">0</span> <span class="operator">|</span> uq_phone     <span class="operator">|</span>            <span class="number">1</span> <span class="operator">|</span> phone       <span class="operator">|</span> A         </span><br><span class="line"><span class="operator">|</span> t13   <span class="operator">|</span>          <span class="number">0</span> <span class="operator">|</span> uq_ID_number <span class="operator">|</span>            <span class="number">1</span> <span class="operator">|</span> ID_number   <span class="operator">|</span> A         </span><br><span class="line"><span class="operator">+</span><span class="comment">-------+------------+--------------+--------------+-------------+-----------</span></span><br><span class="line"><span class="number">3</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="三、创建表之后添加-UNIQUE-约束"><a href="#三、创建表之后添加-UNIQUE-约束" class="headerlink" title="三、创建表之后添加 UNIQUE 约束"></a>三、创建表之后添加 UNIQUE 约束</h3><p>创建表之后可以添加 UNIQUE 约束，语法格式如下：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> 表名 <span class="keyword">add</span> [<span class="keyword">constraint</span> 约束名] <span class="keyword">unique</span>(列名);</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">create</span> <span class="keyword">table</span> t14(</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span>     id <span class="type">int</span> <span class="keyword">primary</span> key auto_increment,</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span>     name <span class="type">char</span>(<span class="number">20</span>),</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span>     phone <span class="type">char</span>(<span class="number">11</span>)</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> );</span><br><span class="line">Query OK, <span class="number">0</span> <span class="keyword">rows</span> affected (<span class="number">0.04</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">alter</span> <span class="keyword">table</span> t14 <span class="keyword">add</span> <span class="keyword">constraint</span> uq_phone <span class="keyword">unique</span>(phone);</span><br><span class="line">Query OK, <span class="number">0</span> <span class="keyword">rows</span> affected (<span class="number">0.03</span> sec)</span><br><span class="line">Records: <span class="number">0</span>  Duplicates: <span class="number">0</span>  Warnings: <span class="number">0</span></span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">desc</span> t14;</span><br><span class="line"><span class="operator">+</span><span class="comment">-------+----------+------+-----+---------+----------------+</span></span><br><span class="line"><span class="operator">|</span> Field <span class="operator">|</span> Type     <span class="operator">|</span> <span class="keyword">Null</span> <span class="operator">|</span> Key <span class="operator">|</span> <span class="keyword">Default</span> <span class="operator">|</span> Extra          <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------+----------+------+-----+---------+----------------+</span></span><br><span class="line"><span class="operator">|</span> id    <span class="operator">|</span> <span class="type">int</span>(<span class="number">11</span>)  <span class="operator">|</span> <span class="keyword">NO</span>   <span class="operator">|</span> PRI <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span> auto_increment <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> name  <span class="operator">|</span> <span class="type">char</span>(<span class="number">20</span>) <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>                <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> phone <span class="operator">|</span> <span class="type">char</span>(<span class="number">11</span>) <span class="operator">|</span> YES  <span class="operator">|</span> UNI <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>                <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------+----------+------+-----+---------+----------------+</span></span><br><span class="line"><span class="number">3</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">show</span> index <span class="keyword">from</span> t14;</span><br><span class="line"><span class="operator">+</span><span class="comment">-------+------------+----------+--------------+-------------+-----------</span></span><br><span class="line"><span class="operator">|</span> <span class="keyword">Table</span> <span class="operator">|</span> Non_unique <span class="operator">|</span> Key_name <span class="operator">|</span> Seq_in_index <span class="operator">|</span> Column_name <span class="operator">|</span> <span class="keyword">Collation</span> </span><br><span class="line"><span class="operator">+</span><span class="comment">-------+------------+----------+--------------+-------------+-----------</span></span><br><span class="line"><span class="operator">|</span> t14   <span class="operator">|</span>          <span class="number">0</span> <span class="operator">|</span> <span class="keyword">PRIMARY</span>  <span class="operator">|</span>            <span class="number">1</span> <span class="operator">|</span> id          <span class="operator">|</span> A         </span><br><span class="line"><span class="operator">|</span> t14   <span class="operator">|</span>          <span class="number">0</span> <span class="operator">|</span> uq_phone <span class="operator">|</span>            <span class="number">1</span> <span class="operator">|</span> phone       <span class="operator">|</span> A         </span><br><span class="line"><span class="operator">+</span><span class="comment">-------+------------+----------+--------------+-------------+-----------</span></span><br><span class="line"><span class="number">2</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="四、删除-UNIQUE-约束"><a href="#四、删除-UNIQUE-约束" class="headerlink" title="四、删除 UNIQUE 约束"></a>四、删除 UNIQUE 约束</h3><p>删除 UNIQUE 约束之前可以使用 【show index from 表名; 】查看 UNIQUE 约束的名称。删除 UNIQUE 约束的命令格式如下：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> 表名 <span class="keyword">drop</span> index 约束名;</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">show</span> index <span class="keyword">from</span> t13;</span><br><span class="line"><span class="operator">+</span><span class="comment">-------+------------+--------------+--------------+-------------+-----------</span></span><br><span class="line"><span class="operator">|</span> <span class="keyword">Table</span> <span class="operator">|</span> Non_unique <span class="operator">|</span> Key_name     <span class="operator">|</span> Seq_in_index <span class="operator">|</span> Column_name <span class="operator">|</span> <span class="keyword">Collation</span> </span><br><span class="line"><span class="operator">+</span><span class="comment">-------+------------+--------------+--------------+-------------+-----------</span></span><br><span class="line"><span class="operator">|</span> t13   <span class="operator">|</span>          <span class="number">0</span> <span class="operator">|</span> <span class="keyword">PRIMARY</span>      <span class="operator">|</span>            <span class="number">1</span> <span class="operator">|</span> id          <span class="operator">|</span> A         </span><br><span class="line"><span class="operator">|</span> t13   <span class="operator">|</span>          <span class="number">0</span> <span class="operator">|</span> uq_phone     <span class="operator">|</span>            <span class="number">1</span> <span class="operator">|</span> phone       <span class="operator">|</span> A         </span><br><span class="line"><span class="operator">|</span> t13   <span class="operator">|</span>          <span class="number">0</span> <span class="operator">|</span> uq_ID_number <span class="operator">|</span>            <span class="number">1</span> <span class="operator">|</span> ID_number   <span class="operator">|</span> A         </span><br><span class="line"><span class="operator">+</span><span class="comment">-------+------------+--------------+--------------+-------------+-----------</span></span><br><span class="line"><span class="number">3</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">alter</span> <span class="keyword">table</span> t13 <span class="keyword">drop</span> index uq_ID_number;</span><br><span class="line">Query OK, <span class="number">0</span> <span class="keyword">rows</span> affected (<span class="number">0.02</span> sec)</span><br><span class="line">Records: <span class="number">0</span>  Duplicates: <span class="number">0</span>  Warnings: <span class="number">0</span></span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">show</span> index <span class="keyword">from</span> t13;</span><br><span class="line"><span class="operator">+</span><span class="comment">-------+------------+----------+--------------+-------------+-----------</span></span><br><span class="line"><span class="operator">|</span> <span class="keyword">Table</span> <span class="operator">|</span> Non_unique <span class="operator">|</span> Key_name <span class="operator">|</span> Seq_in_index <span class="operator">|</span> Column_name <span class="operator">|</span> <span class="keyword">Collation</span> </span><br><span class="line"><span class="operator">+</span><span class="comment">-------+------------+----------+--------------+-------------+-----------</span></span><br><span class="line"><span class="operator">|</span> t13   <span class="operator">|</span>          <span class="number">0</span> <span class="operator">|</span> <span class="keyword">PRIMARY</span>  <span class="operator">|</span>            <span class="number">1</span> <span class="operator">|</span> id          <span class="operator">|</span> A         </span><br><span class="line"><span class="operator">|</span> t13   <span class="operator">|</span>          <span class="number">0</span> <span class="operator">|</span> uq_phone <span class="operator">|</span>            <span class="number">1</span> <span class="operator">|</span> phone       <span class="operator">|</span> A         </span><br><span class="line"><span class="operator">+</span><span class="comment">-------+------------+----------+--------------+-------------+-----------</span></span><br><span class="line"><span class="number">2</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="三、外键约束"><a href="#三、外键约束" class="headerlink" title="三、外键约束"></a>三、外键约束</h2><p>两个表必须是 InnoDB 存储引擎</p>
<p>一个表外键所包含的列的类型和与之发生关联的另一个表的<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=%E4%B8%BB%E9%94%AE&spm=1001.2101.3001.7020">主键</a>列的数据类型必须相似，也就是可以相互转换类型的列，数据类型最好相同。</p>
<p>外键用于定义多个表之间的参照完整性。参照完整性指多个表之间的对应关系，在一张表中执行数据的插入、更新、删除等操作时，会和另一张表进行对照，以确保数据存储的完整性。</p>
<p>外键约束必须遵守以下规则：</p>
<p>（1）某一个表中的某个字段的取值依赖于另一张表中某个字段的值。<br>（2）主键所在的表为主表，外键所在的表为从表，每一个外键值必须与另一个表中的主键值相对应。</p>
<h3 id="一、创建表的同时定义外键"><a href="#一、创建表的同时定义外键" class="headerlink" title="一、创建表的同时定义外键"></a>一、创建表的同时定义外键</h3><p>在创建表时可以同时创建外键，语法如下：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> 表名 (</span><br><span class="line">    列名 类型 ... ,</span><br><span class="line">    [<span class="keyword">CONSTRAINT</span> 约束名] <span class="keyword">FOREIGN</span> KEY (列名)</span><br><span class="line">    <span class="keyword">REFERENCES</span> 表名 (列名)</span><br><span class="line">    [<span class="keyword">ON</span> <span class="keyword">DELETE</span> &#123;RESTRICT <span class="operator">|</span> CASCADE <span class="operator">|</span> <span class="keyword">SET</span> <span class="keyword">NULL</span> <span class="operator">|</span> <span class="keyword">NO</span> ACTION <span class="operator">|</span> <span class="keyword">SET</span> <span class="keyword">DEFAULT</span>&#125;]</span><br><span class="line">    [<span class="keyword">ON</span> <span class="keyword">UPDATE</span> &#123;RESTRICT <span class="operator">|</span> CASCADE <span class="operator">|</span> <span class="keyword">SET</span> <span class="keyword">NULL</span> <span class="operator">|</span> <span class="keyword">NO</span> ACTION <span class="operator">|</span> <span class="keyword">SET</span> <span class="keyword">DEFAULT</span>&#125;]</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">说明：定义了外键约束之后，在删除父表记录和更新父表的主键时可以设置以下操作方式。</span><br><span class="line">（<span class="number">1</span>）cascade 方式：在父表上更新和删除记录时，子表匹配的记录也同步进行更新（级联更新）和删除（级联删除）；</span><br><span class="line">（<span class="number">2</span>）<span class="keyword">set</span> <span class="keyword">null</span> 方式：在父表上更新和删除记录时，子表匹配的记录的外键设为<span class="keyword">null</span>；</span><br><span class="line">（<span class="number">3</span>）<span class="keyword">No</span> action 方式：如果子表中有匹配的记录，则不允许对父表对应的主键进行更新和删除操作；</span><br><span class="line">（<span class="number">4</span>）Restrict 方式：同 <span class="keyword">no</span> action, 都是立即检查外键约束；</span><br><span class="line">（<span class="number">5</span>）<span class="keyword">Set</span> <span class="keyword">default</span> 方式：父表上更新和删除记录时，子表将外键列设置成一个默认的值；</span><br><span class="line">（<span class="number">6</span>）系统默认为<span class="keyword">No</span> action 方式。</span><br></pre></td></tr></table></figure>

<p>例子：</p>
<h4 id="1、创建部门（dept）和员工（emp）表，并创建外键。"><a href="#1、创建部门（dept）和员工（emp）表，并创建外键。" class="headerlink" title="1、创建部门（dept）和员工（emp）表，并创建外键。"></a>1、创建部门（dept）和员工（emp）表，并创建外键。</h4><p>（1）创建表</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> dept (</span><br><span class="line">    id <span class="type">int</span> <span class="keyword">primary</span> key auto_increment,</span><br><span class="line">    name <span class="type">char</span>(<span class="number">20</span>)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> emp (</span><br><span class="line">    id <span class="type">int</span> <span class="keyword">primary</span> key auto_increment,</span><br><span class="line">    name <span class="type">char</span>(<span class="number">20</span>),</span><br><span class="line">    salary <span class="type">decimal</span>(<span class="number">8</span>,<span class="number">2</span>),</span><br><span class="line">    dept_id <span class="type">int</span>,</span><br><span class="line">    <span class="keyword">foreign</span> key(dept_id) <span class="keyword">references</span> dept(id)</span><br><span class="line">);</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>(2) 插入数据</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> dept;</span><br><span class="line"><span class="operator">+</span><span class="comment">----+-----------+</span></span><br><span class="line"><span class="operator">|</span> id <span class="operator">|</span> name      <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----+-----------+</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">1</span> <span class="operator">|</span> 人事部    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">2</span> <span class="operator">|</span> 销售部    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">3</span> <span class="operator">|</span> 技术部    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">4</span> <span class="operator">|</span> 财务部    <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----+-----------+</span></span><br><span class="line"><span class="number">4</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp;</span><br><span class="line"><span class="operator">+</span><span class="comment">----+-----------+---------+---------+</span></span><br><span class="line"><span class="operator">|</span> id <span class="operator">|</span> name      <span class="operator">|</span> salary  <span class="operator">|</span> dept_id <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----+-----------+---------+---------+</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">1</span> <span class="operator">|</span> 张鹏      <span class="operator">|</span> <span class="number">4500.00</span> <span class="operator">|</span>       <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">2</span> <span class="operator">|</span> 王晶      <span class="operator">|</span> <span class="number">5700.00</span> <span class="operator">|</span>       <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">3</span> <span class="operator">|</span> 刘云      <span class="operator">|</span> <span class="number">4900.00</span> <span class="operator">|</span>       <span class="number">2</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">4</span> <span class="operator">|</span> 王晓刚    <span class="operator">|</span> <span class="number">5200.00</span> <span class="operator">|</span>       <span class="number">2</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">5</span> <span class="operator">|</span> 刘大鹏    <span class="operator">|</span> <span class="number">4200.00</span> <span class="operator">|</span>       <span class="number">2</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">6</span> <span class="operator">|</span> 王军军    <span class="operator">|</span> <span class="number">5600.00</span> <span class="operator">|</span>       <span class="number">3</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----+-----------+---------+---------+</span></span><br><span class="line"><span class="number">6</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>（3）验证外键约束</p>
<p>在删除父表记录和更新父表的主键时，子表的操作方式默认为No action 方式。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 1、删除 dept 表（父表）：删除失败</span></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">drop</span> <span class="keyword">table</span> dept;</span><br><span class="line">ERROR <span class="number">1217</span> (<span class="number">23000</span>): Cannot <span class="keyword">delete</span> <span class="keyword">or</span> <span class="keyword">update</span> a parent <span class="type">row</span>: a <span class="keyword">foreign</span> key <span class="keyword">constraint</span> fails</span><br><span class="line"><span class="comment">-- 2、删除 dept 表（父表）中的 1号部门（人事部）：子表中有相关记录，删除失败</span></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">delete</span> <span class="keyword">from</span> dept <span class="keyword">where</span> id<span class="operator">=</span><span class="number">1</span>;</span><br><span class="line">ERROR <span class="number">1451</span> (<span class="number">23000</span>): Cannot <span class="keyword">delete</span> <span class="keyword">or</span> <span class="keyword">update</span> a parent <span class="type">row</span>: a <span class="keyword">foreign</span> key <span class="keyword">constraint</span> fails (`wgx`.`emp`, <span class="keyword">CONSTRAINT</span> `emp_ibfk_1` <span class="keyword">FOREIGN</span> KEY (`dept_id`) <span class="keyword">REFERENCES</span> `dept` (`id`))</span><br><span class="line"><span class="comment">-- 3、删除 dept 表（父表）中的 4号部门（财务部）：由于子表中没有相关记录，成功删除</span></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">delete</span> <span class="keyword">from</span> dept <span class="keyword">where</span> id<span class="operator">=</span><span class="number">4</span>;</span><br><span class="line">Query OK, <span class="number">1</span> <span class="type">row</span> affected (<span class="number">0.01</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> dept;</span><br><span class="line"><span class="operator">+</span><span class="comment">----+-----------+</span></span><br><span class="line"><span class="operator">|</span> id <span class="operator">|</span> name      <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----+-----------+</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">1</span> <span class="operator">|</span> 人事部    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">2</span> <span class="operator">|</span> 销售部    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">3</span> <span class="operator">|</span> 技术部    <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----+-----------+</span></span><br><span class="line"><span class="number">3</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"><span class="comment">-- 4、重新插入财务部的信息</span></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">insert</span> <span class="keyword">into</span> dept(id,name)  <span class="keyword">values</span>(<span class="number">4</span>,<span class="string">&#x27;财务部&#x27;</span>);</span><br><span class="line">Query OK, <span class="number">1</span> <span class="type">row</span> affected (<span class="number">0.02</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> dept;</span><br><span class="line"><span class="operator">+</span><span class="comment">----+-----------+</span></span><br><span class="line"><span class="operator">|</span> id <span class="operator">|</span> name      <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----+-----------+</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">1</span> <span class="operator">|</span> 人事部    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">2</span> <span class="operator">|</span> 销售部    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">3</span> <span class="operator">|</span> 技术部    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">4</span> <span class="operator">|</span> 财务部    <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----+-----------+</span></span><br><span class="line"><span class="number">4</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"><span class="comment">-- 5、更新父表的字段 id，更新人事部的 id 失败，因为子表中存在相关记录</span></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">update</span> dept <span class="keyword">set</span> id<span class="operator">=</span><span class="number">11</span> <span class="keyword">where</span> id<span class="operator">=</span><span class="number">1</span>;</span><br><span class="line">ERROR <span class="number">1451</span> (<span class="number">23000</span>): Cannot <span class="keyword">delete</span> <span class="keyword">or</span> <span class="keyword">update</span> a parent <span class="type">row</span>: a <span class="keyword">foreign</span> key <span class="keyword">constraint</span> fails (`wgx`.`emp`, <span class="keyword">CONSTRAINT</span> `emp_ibfk_1` <span class="keyword">FOREIGN</span> KEY (`dept_id`) <span class="keyword">REFERENCES</span> `dept` (`id`))</span><br><span class="line"><span class="comment">-- 6、更新父表的字段 id，更新财务部的 id 成功，因为子表中不存在相关记录</span></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">update</span> dept <span class="keyword">set</span> id<span class="operator">=</span><span class="number">44</span> <span class="keyword">where</span> id<span class="operator">=</span><span class="number">4</span>;</span><br><span class="line">Query OK, <span class="number">1</span> <span class="type">row</span> affected (<span class="number">0.00</span> sec)</span><br><span class="line"><span class="keyword">Rows</span> matched: <span class="number">1</span>  Changed: <span class="number">1</span>  Warnings: <span class="number">0</span></span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> dept;</span><br><span class="line"><span class="operator">+</span><span class="comment">----+-----------+</span></span><br><span class="line"><span class="operator">|</span> id <span class="operator">|</span> name      <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----+-----------+</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">1</span> <span class="operator">|</span> 人事部    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">2</span> <span class="operator">|</span> 销售部    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">3</span> <span class="operator">|</span> 技术部    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">44</span> <span class="operator">|</span> 财务部    <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----+-----------+</span></span><br><span class="line"><span class="number">4</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="2、把-emp-表的外键设置为级联更新和级联删除"><a href="#2、把-emp-表的外键设置为级联更新和级联删除" class="headerlink" title="2、把 emp 表的外键设置为级联更新和级联删除"></a>2、把 emp 表的外键设置为级联更新和级联删除</h4><p>不提供对外键的直接修改，可以先删除外键，然后再重新创建。</p>
<p>（1）查看外键约束的名称</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">show</span> <span class="keyword">create</span> <span class="keyword">table</span> emp\G</span><br><span class="line"><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span> <span class="number">1.</span> <span class="type">row</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">       <span class="keyword">Table</span>: emp</span><br><span class="line"><span class="keyword">Create</span> <span class="keyword">Table</span>: <span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `emp` (</span><br><span class="line">  `id` <span class="type">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT,</span><br><span class="line">  `name` <span class="type">char</span>(<span class="number">20</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `salary` <span class="type">decimal</span>(<span class="number">8</span>,<span class="number">2</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `dept_id` <span class="type">int</span>(<span class="number">11</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  <span class="keyword">PRIMARY</span> KEY (`id`),</span><br><span class="line">  KEY `dept_id` (`dept_id`),</span><br><span class="line">  <span class="keyword">CONSTRAINT</span> `emp_ibfk_1` <span class="keyword">FOREIGN</span> KEY (`dept_id`) <span class="keyword">REFERENCES</span> `dept` (`id`)</span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB AUTO_INCREMENT<span class="operator">=</span><span class="number">7</span> <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8mb4</span><br><span class="line"><span class="number">1</span> <span class="type">row</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 外键约束的名称为：emp_ibfk_1</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>（2）删除外键约束</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">alter</span> <span class="keyword">table</span> emp <span class="keyword">drop</span> <span class="keyword">foreign</span> key emp_ibfk_1;</span><br><span class="line">Query OK, <span class="number">0</span> <span class="keyword">rows</span> affected (<span class="number">0.02</span> sec)</span><br><span class="line">Records: <span class="number">0</span>  Duplicates: <span class="number">0</span>  Warnings: <span class="number">0</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>（3）重新添加外键约束</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">alter</span> <span class="keyword">table</span> emp </span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">add</span> <span class="keyword">constraint</span> fk_emp_dept_id <span class="keyword">foreign</span> key(dept_id) </span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">references</span> dept(id)</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">on</span> <span class="keyword">update</span> cascade</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">on</span> <span class="keyword">delete</span> cascade;</span><br><span class="line">Query OK, <span class="number">6</span> <span class="keyword">rows</span> affected (<span class="number">0.06</span> sec)</span><br><span class="line">Records: <span class="number">6</span>  Duplicates: <span class="number">0</span>  Warnings: <span class="number">0</span></span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">show</span> <span class="keyword">create</span> <span class="keyword">table</span> emp\G</span><br><span class="line"><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span> <span class="number">1.</span> <span class="type">row</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">       <span class="keyword">Table</span>: emp</span><br><span class="line"><span class="keyword">Create</span> <span class="keyword">Table</span>: <span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `emp` (</span><br><span class="line">  `id` <span class="type">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT,</span><br><span class="line">  `name` <span class="type">char</span>(<span class="number">20</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `salary` <span class="type">decimal</span>(<span class="number">8</span>,<span class="number">2</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `dept_id` <span class="type">int</span>(<span class="number">11</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  <span class="keyword">PRIMARY</span> KEY (`id`),</span><br><span class="line">  KEY `fk_emp_dept_id` (`dept_id`),</span><br><span class="line">  <span class="keyword">CONSTRAINT</span> `fk_emp_dept_id` <span class="keyword">FOREIGN</span> KEY (`dept_id`) <span class="keyword">REFERENCES</span> `dept` (`id`) <span class="keyword">ON</span> <span class="keyword">DELETE</span> CASCADE <span class="keyword">ON</span> <span class="keyword">UPDATE</span> CASCADE</span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB AUTO_INCREMENT<span class="operator">=</span><span class="number">7</span> <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8mb4</span><br><span class="line"><span class="number">1</span> <span class="type">row</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>（4）测试外键约束</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 1、在dept表中把人事部的编号修改为11，销售部的编号修改22，技术部的编号修改为33</span></span><br><span class="line"><span class="comment">-- 可以看到，子表中对应的部门编号自动被修改</span></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">update</span> dept <span class="keyword">set</span> id<span class="operator">=</span><span class="number">11</span> <span class="keyword">where</span> id<span class="operator">=</span><span class="number">1</span>;</span><br><span class="line">Query OK, <span class="number">1</span> <span class="type">row</span> affected (<span class="number">0.03</span> sec)</span><br><span class="line"><span class="keyword">Rows</span> matched: <span class="number">1</span>  Changed: <span class="number">1</span>  Warnings: <span class="number">0</span></span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">update</span> dept <span class="keyword">set</span> id<span class="operator">=</span><span class="number">22</span> <span class="keyword">where</span> id<span class="operator">=</span><span class="number">2</span>;</span><br><span class="line">Query OK, <span class="number">1</span> <span class="type">row</span> affected (<span class="number">0.02</span> sec)</span><br><span class="line"><span class="keyword">Rows</span> matched: <span class="number">1</span>  Changed: <span class="number">1</span>  Warnings: <span class="number">0</span></span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">update</span> dept <span class="keyword">set</span> id<span class="operator">=</span><span class="number">33</span> <span class="keyword">where</span> id<span class="operator">=</span><span class="number">3</span>;</span><br><span class="line">Query OK, <span class="number">1</span> <span class="type">row</span> affected (<span class="number">0.01</span> sec)</span><br><span class="line"><span class="keyword">Rows</span> matched: <span class="number">1</span>  Changed: <span class="number">1</span>  Warnings: <span class="number">0</span></span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> dept;</span><br><span class="line"><span class="operator">+</span><span class="comment">----+-----------+</span></span><br><span class="line"><span class="operator">|</span> id <span class="operator">|</span> name      <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----+-----------+</span></span><br><span class="line"><span class="operator">|</span> <span class="number">11</span> <span class="operator">|</span> 人事部    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">22</span> <span class="operator">|</span> 销售部    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">33</span> <span class="operator">|</span> 技术部    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">44</span> <span class="operator">|</span> 财务部    <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----+-----------+</span></span><br><span class="line"><span class="number">4</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp;</span><br><span class="line"><span class="operator">+</span><span class="comment">----+-----------+---------+---------+</span></span><br><span class="line"><span class="operator">|</span> id <span class="operator">|</span> name      <span class="operator">|</span> salary  <span class="operator">|</span> dept_id <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----+-----------+---------+---------+</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">1</span> <span class="operator">|</span> 张鹏      <span class="operator">|</span> <span class="number">4500.00</span> <span class="operator">|</span>      <span class="number">11</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">2</span> <span class="operator">|</span> 王晶      <span class="operator">|</span> <span class="number">5700.00</span> <span class="operator">|</span>      <span class="number">11</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">3</span> <span class="operator">|</span> 刘云      <span class="operator">|</span> <span class="number">4900.00</span> <span class="operator">|</span>      <span class="number">22</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">4</span> <span class="operator">|</span> 王晓刚    <span class="operator">|</span> <span class="number">5200.00</span> <span class="operator">|</span>      <span class="number">22</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">5</span> <span class="operator">|</span> 刘大鹏    <span class="operator">|</span> <span class="number">4200.00</span> <span class="operator">|</span>      <span class="number">22</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">6</span> <span class="operator">|</span> 王军军    <span class="operator">|</span> <span class="number">5600.00</span> <span class="operator">|</span>      <span class="number">33</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----+-----------+---------+---------+</span></span><br><span class="line"><span class="number">6</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.01</span> sec)</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 2、在dept表中删除技术部的信息</span></span><br><span class="line"><span class="comment">-- 可以看到，技术部的员工自动被删除</span></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">delete</span> <span class="keyword">from</span> dept <span class="keyword">where</span> id<span class="operator">=</span><span class="number">33</span>;</span><br><span class="line">Query OK, <span class="number">1</span> <span class="type">row</span> affected (<span class="number">0.01</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> dept;</span><br><span class="line"><span class="operator">+</span><span class="comment">----+-----------+</span></span><br><span class="line"><span class="operator">|</span> id <span class="operator">|</span> name      <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----+-----------+</span></span><br><span class="line"><span class="operator">|</span> <span class="number">11</span> <span class="operator">|</span> 人事部    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">22</span> <span class="operator">|</span> 销售部    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">44</span> <span class="operator">|</span> 财务部    <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----+-----------+</span></span><br><span class="line"><span class="number">3</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp;</span><br><span class="line"><span class="operator">+</span><span class="comment">----+-----------+---------+---------+</span></span><br><span class="line"><span class="operator">|</span> id <span class="operator">|</span> name      <span class="operator">|</span> salary  <span class="operator">|</span> dept_id <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----+-----------+---------+---------+</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">1</span> <span class="operator">|</span> 张鹏      <span class="operator">|</span> <span class="number">4500.00</span> <span class="operator">|</span>      <span class="number">11</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">2</span> <span class="operator">|</span> 王晶      <span class="operator">|</span> <span class="number">5700.00</span> <span class="operator">|</span>      <span class="number">11</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">3</span> <span class="operator">|</span> 刘云      <span class="operator">|</span> <span class="number">4900.00</span> <span class="operator">|</span>      <span class="number">22</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">4</span> <span class="operator">|</span> 王晓刚    <span class="operator">|</span> <span class="number">5200.00</span> <span class="operator">|</span>      <span class="number">22</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">5</span> <span class="operator">|</span> 刘大鹏    <span class="operator">|</span> <span class="number">4200.00</span> <span class="operator">|</span>      <span class="number">22</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----+-----------+---------+---------+</span></span><br><span class="line"><span class="number">5</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="二、删除外键约束"><a href="#二、删除外键约束" class="headerlink" title="二、删除外键约束"></a>二、删除外键约束</h3><p>删除外键约束的语法格式如下：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> 表名 <span class="keyword">drop</span> <span class="keyword">foreign</span> key 约束名;</span><br></pre></td></tr></table></figure>

<p>删除外键约束之前需要先查询外键约束名，可以使用 show create table 表名：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 查看外键约束名</span></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">show</span> <span class="keyword">create</span> <span class="keyword">table</span> emp\G</span><br><span class="line"><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span> <span class="number">1.</span> <span class="type">row</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">       <span class="keyword">Table</span>: emp</span><br><span class="line"><span class="keyword">Create</span> <span class="keyword">Table</span>: <span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `emp` (</span><br><span class="line">  `id` <span class="type">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT,</span><br><span class="line">  `name` <span class="type">char</span>(<span class="number">20</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `salary` <span class="type">decimal</span>(<span class="number">8</span>,<span class="number">2</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `dept_id` <span class="type">int</span>(<span class="number">11</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  <span class="keyword">PRIMARY</span> KEY (`id`),</span><br><span class="line">  KEY `fk_emp_dept_id` (`dept_id`),</span><br><span class="line">  <span class="keyword">CONSTRAINT</span> `fk_emp_dept_id` <span class="keyword">FOREIGN</span> KEY (`dept_id`) <span class="keyword">REFERENCES</span> `dept` (`id`) <span class="keyword">ON</span> <span class="keyword">DELETE</span> CASCADE <span class="keyword">ON</span> <span class="keyword">UPDATE</span> CASCADE</span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB AUTO_INCREMENT<span class="operator">=</span><span class="number">7</span> <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8mb4</span><br><span class="line"><span class="number">1</span> <span class="type">row</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"><span class="comment">-- 创建外键约束会自动创建一个索引</span></span><br><span class="line"><span class="comment">-- 查看外键约束对应的索引</span></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">show</span> index <span class="keyword">from</span> emp;</span><br><span class="line"><span class="operator">+</span><span class="comment">-------+------------+----------------+--------------+-------------+-----------</span></span><br><span class="line"><span class="operator">|</span> <span class="keyword">Table</span> <span class="operator">|</span> Non_unique <span class="operator">|</span> Key_name       <span class="operator">|</span> Seq_in_index <span class="operator">|</span> Column_name <span class="operator">|</span> <span class="keyword">Collation</span> </span><br><span class="line"><span class="operator">+</span><span class="comment">-------+------------+----------------+--------------+-------------+-----------</span></span><br><span class="line"><span class="operator">|</span> emp   <span class="operator">|</span>          <span class="number">0</span> <span class="operator">|</span> <span class="keyword">PRIMARY</span>        <span class="operator">|</span>            <span class="number">1</span> <span class="operator">|</span> id          <span class="operator">|</span> A         </span><br><span class="line"><span class="operator">|</span> emp   <span class="operator">|</span>          <span class="number">1</span> <span class="operator">|</span> fk_emp_dept_id <span class="operator">|</span>            <span class="number">1</span> <span class="operator">|</span> dept_id     <span class="operator">|</span> A         </span><br><span class="line"><span class="operator">+</span><span class="comment">-------+------------+----------------+--------------+-------------+-----------</span></span><br><span class="line"><span class="number">2</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>举例：删除 emp 表的外键约束</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">alter</span> <span class="keyword">table</span> emp <span class="keyword">drop</span> <span class="keyword">foreign</span> key fk_emp_dept_id;</span><br><span class="line">Query OK, <span class="number">0</span> <span class="keyword">rows</span> affected (<span class="number">0.02</span> sec)</span><br><span class="line">Records: <span class="number">0</span>  Duplicates: <span class="number">0</span>  Warnings: <span class="number">0</span></span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">show</span> <span class="keyword">create</span> <span class="keyword">table</span> emp\G</span><br><span class="line"><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span> <span class="number">1.</span> <span class="type">row</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">       <span class="keyword">Table</span>: emp</span><br><span class="line"><span class="keyword">Create</span> <span class="keyword">Table</span>: <span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `emp` (</span><br><span class="line">  `id` <span class="type">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT,</span><br><span class="line">  `name` <span class="type">char</span>(<span class="number">20</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `salary` <span class="type">decimal</span>(<span class="number">8</span>,<span class="number">2</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `dept_id` <span class="type">int</span>(<span class="number">11</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  <span class="keyword">PRIMARY</span> KEY (`id`),</span><br><span class="line">  KEY `fk_emp_dept_id` (`dept_id`)</span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB AUTO_INCREMENT<span class="operator">=</span><span class="number">7</span> <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8mb4</span><br><span class="line"><span class="number">1</span> <span class="type">row</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"><span class="comment">-- 删除约束不会自动删除约束对应的索引</span></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">show</span> index <span class="keyword">from</span> emp;</span><br><span class="line"><span class="operator">+</span><span class="comment">-------+------------+----------------+--------------+-------------+-----------</span></span><br><span class="line"><span class="operator">|</span> <span class="keyword">Table</span> <span class="operator">|</span> Non_unique <span class="operator">|</span> Key_name       <span class="operator">|</span> Seq_in_index <span class="operator">|</span> Column_name <span class="operator">|</span> <span class="keyword">Collation</span> </span><br><span class="line"><span class="operator">+</span><span class="comment">-------+------------+----------------+--------------+-------------+-----------</span></span><br><span class="line"><span class="operator">|</span> emp   <span class="operator">|</span>          <span class="number">0</span> <span class="operator">|</span> <span class="keyword">PRIMARY</span>        <span class="operator">|</span>            <span class="number">1</span> <span class="operator">|</span> id          <span class="operator">|</span> A         </span><br><span class="line"><span class="operator">|</span> emp   <span class="operator">|</span>          <span class="number">1</span> <span class="operator">|</span> fk_emp_dept_id <span class="operator">|</span>            <span class="number">1</span> <span class="operator">|</span> dept_id     <span class="operator">|</span> A         </span><br><span class="line"><span class="operator">+</span><span class="comment">-------+------------+----------------+--------------+-------------+-----------</span></span><br><span class="line"><span class="number">2</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"><span class="comment">-- 手工删除外键约束对应的索引</span></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">alter</span> <span class="keyword">table</span> emp <span class="keyword">drop</span> index fk_emp_dept_id;</span><br><span class="line">Query OK, <span class="number">0</span> <span class="keyword">rows</span> affected (<span class="number">0.02</span> sec)</span><br><span class="line">Records: <span class="number">0</span>  Duplicates: <span class="number">0</span>  Warnings: <span class="number">0</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="三、为已有的表添加外键约束"><a href="#三、为已有的表添加外键约束" class="headerlink" title="三、为已有的表添加外键约束"></a>三、为已有的表添加外键约束</h3><p>命令格式如下：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> 表名</span><br><span class="line"><span class="keyword">add</span> <span class="keyword">constraint</span> 约束名</span><br><span class="line"><span class="keyword">foreign</span> key(列名) <span class="keyword">references</span> 父表名(列名)</span><br><span class="line">[<span class="keyword">ON</span> <span class="keyword">DELETE</span> &#123;RESTRICT <span class="operator">|</span> CASCADE <span class="operator">|</span> <span class="keyword">SET</span> <span class="keyword">NULL</span> <span class="operator">|</span> <span class="keyword">NO</span> ACTION <span class="operator">|</span> <span class="keyword">SET</span> <span class="keyword">DEFAULT</span>&#125;]</span><br><span class="line">[<span class="keyword">ON</span> <span class="keyword">UPDATE</span> &#123;RESTRICT <span class="operator">|</span> CASCADE <span class="operator">|</span> <span class="keyword">SET</span> <span class="keyword">NULL</span> <span class="operator">|</span> <span class="keyword">NO</span> ACTION <span class="operator">|</span> <span class="keyword">SET</span> <span class="keyword">DEFAULT</span>&#125;]</span><br><span class="line">;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>举例：为 emp 表添加外键约束，名称为 fk_emp_dept_id，on delete 设置为 set null，on update 设置为 cascade。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">alter</span> <span class="keyword">table</span> emp </span><br><span class="line">       <span class="keyword">add</span> <span class="keyword">constraint</span> fk_emp_dept_id </span><br><span class="line">       <span class="keyword">foreign</span> key(dept_id) </span><br><span class="line">       <span class="keyword">references</span> dept(id)</span><br><span class="line">       <span class="keyword">on</span> <span class="keyword">delete</span> <span class="keyword">set</span> <span class="keyword">null</span> <span class="keyword">on</span> <span class="keyword">update</span> cascade;</span><br><span class="line">Query OK, <span class="number">5</span> <span class="keyword">rows</span> affected (<span class="number">0.03</span> sec)</span><br><span class="line">Records: <span class="number">5</span>  Duplicates: <span class="number">0</span>  Warnings: <span class="number">0</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="四、非空约束"><a href="#四、非空约束" class="headerlink" title="四、非空约束"></a>四、非空约束</h2><p>非空约束就是限制必须为某个列提供值。空值（NULL）既不是数字0，也不是空字符串。空值用 NULL 表示，使用空值参与的运算结果仍然为空值。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> 表名(</span><br><span class="line">    列名 类型 <span class="keyword">not</span> <span class="keyword">null</span>,</span><br><span class="line">    ....</span><br><span class="line">);</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="五、默认值"><a href="#五、默认值" class="headerlink" title="五、默认值"></a>五、默认值</h2><p>可通过关键字 DEFAULT 为某个字段设置默认值。如果为某个字段设置了默认值，当在数据表中插入一条新记录时，如果没有为某个字段赋值，则自动为这个字段插入默认值。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> 表名 (</span><br><span class="line">    <span class="operator">&lt;</span>字段名<span class="operator">&gt;</span> <span class="operator">&lt;</span>数据类型<span class="operator">&gt;</span> <span class="keyword">DEFAULT</span> <span class="operator">&lt;</span>默认值<span class="operator">&gt;</span>,</span><br><span class="line">    ....</span><br><span class="line">);</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="六、自增列"><a href="#六、自增列" class="headerlink" title="六、自增列"></a>六、自增列</h2><p>可以使用关键字 AUTO_INCREMENT 把某个字段设置为自增列，当向数据表中插入新记录时，该字段上的值会自动生成唯一的ID。<br>一个表只能把一个字段设置为自增字段，并且字段的数据类型必须是整型。由于设置 AUTO_INCREMENT 约束后的字段会生成唯一的 ID，因此该字段也经常会同时设置成主键</p>
<p>插入数据：插入数据时如果手工指定自增列的数据，则自增列的起始值变为新插入的数据，下次插入数据时从当前插入的数据值递增。</p>
<p>修改表结构重新定义字段类型，并且去掉 auto_increment 关键词即可</p>
<p>alter table t2 modify id int auto_increment;</p>
<h4 id="3、修改自增列的起始值"><a href="#3、修改自增列的起始值" class="headerlink" title="3、修改自增列的起始值"></a>3、修改自增列的起始值</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">alter</span> <span class="keyword">table</span> t2 auto_increment<span class="operator">=</span><span class="number">1001</span>;</span><br><span class="line">Query OK, <span class="number">0</span> <span class="keyword">rows</span> affected (<span class="number">0.01</span> sec)</span><br><span class="line">Records: <span class="number">0</span>  Duplicates: <span class="number">0</span>  Warnings: <span class="number">0</span></span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">show</span> <span class="keyword">create</span> <span class="keyword">table</span> t2\G</span><br><span class="line"><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span> <span class="number">1.</span> <span class="type">row</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">       <span class="keyword">Table</span>: t2</span><br><span class="line"><span class="keyword">Create</span> <span class="keyword">Table</span>: <span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `t2` (</span><br><span class="line">  `id` <span class="type">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT,</span><br><span class="line">  `name` <span class="type">char</span>(<span class="number">20</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  <span class="keyword">PRIMARY</span> KEY (`id`)</span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB AUTO_INCREMENT<span class="operator">=</span><span class="number">1001</span> <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8mb4</span><br><span class="line"><span class="number">1</span> <span class="type">row</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="索引"><a href="#索引" class="headerlink" title="索引"></a>索引</h1><p>索引包含了对表中所有记录的引用指针，通俗地说，索引好比是一本书前面的目录，能加快数据库的查询速度，索引用于快速找出在某个列中有一特定值的行。当执行查询操作时，如果不使用索引，MySQL 必须从第一条记录开始读完整个表，直到找出相关的行，表越大，查询数据所花费的时间就越多。如果表中查询的列有一个索引，MySQL 能够快速到达一个位置去搜索数据文件，而不必查看所有数据。MySQL 索引的存储类型有两种：BTREE 和 HASH，也就是用树或者Hash值来存储索引字段。</p>
<p>一、使用索引的优点<br>使用索引可以加快数据的查询速度。</p>
<p>例如：有一张 person 表，其中有 2W 条记录，记录着 2W 个人的信息。有一个 Phone 字段记录每个人的电话号码，现在想要查询出电话号码为 xxxx 的人的信息。如果没有索引，将从表中第一条记录一条条往下遍历，直到找到该条信息为止。如果根据 Phone 字段创建了索引，会将该字段通过一定的方法进行存储，当查询该字段上的信息时，能够快速找到对应的数据，而不必再去遍历 2W 条数据了。</p>
<p>二、使用索引的缺点<br>虽然通过创建索引可以提供查询数据的速度，但过多的创建索引也存在一些问题。</p>
<p>1、创建索引和维护索引需要耗费时间，并且随着数据量的增加所耗费的时间也会增加。因此，不要创建非必要的索引。<br>2、索引需要占用存储空间。<br>3、当对表中的数据进行增删改操作时，索引也需要动态的维护，降低了数据维护的速度。</p>
<p>三、索引的使用原则<br>通过对索引优缺点的分析，应该知道：索引并不是越多越好，而是根据自己的需要创建索引，创建索引的原则如下：<br>（1）经常进行数据更新的表要避免创建过多的索引，而经常用于查询的字段应该创建索引。<br>（2）数据量小的表最好不要使用索引。如果数据较少，可能查询全部数据花费的时间比遍历索引的时间还要短。<br>（3）如果一个字段的值大量重复，则不要创建索引，比如学生表的性别字段上只有男，女两个不同值。</p>
<p>四、索引的分类<br>1、根据索引的存储结构划分<br>按索引的存储结构分为 BTREE 索引和 HASH 索引。MyISAM 和 InnoDB 存储引擎，只支持 BTREE 索引；MEMORY 和 HEAP 存储引擎，支持 BTREE 索引和 HASH 索引。</p>
<p>2、根据索引所包含的列数划分<br>根据索引所包含的列数分为单列索引和组合索引。<br>（1）单列索引：一个索引只包含一个列。<br>（2）组合索引：根据表中多个字段的组合创建索引。只有在查询条件中使用了这些字段的左边字段时，索引才会被使用，使用组合索引时遵循最左前缀原则。</p>
<p>3、根据索引对数据的要求划分<br>根据索引对数据的要求分为普通索引、唯一索引和主键索引。<br>（1）普通索引：MySQL 中基本的索引类型，对数据没有什么限制，允许在定义索引的列中插入重复值和空值。<br>（2）唯一索引：要求索引列中的值必须唯一，但是允许为空值。<br>（3）主键索引：是一种特殊的唯一索引，除了要求索引列中的值必须唯一之外，还不允许有空值。</p>
<p>创建索引分两种情况：（1）在创建表时同时创建索引。（2）创建表之后有需要时再创建索引。</p>
<h2 id="在创建表时同时创建索引"><a href="#在创建表时同时创建索引" class="headerlink" title="在创建表时同时创建索引"></a>在创建表时同时创建索引</h2><p>举例：创建一张表 employee，并且为相应的字段创建索引。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> dept (</span><br><span class="line">    dept_id <span class="type">int</span> <span class="keyword">primary</span> key,</span><br><span class="line">    dept_name <span class="type">char</span>(<span class="number">20</span>)</span><br><span class="line">);</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> emp (</span><br><span class="line">    e_id <span class="type">int</span> <span class="keyword">primary</span> key auto_increment,</span><br><span class="line">    e_name <span class="type">char</span>(<span class="number">20</span>),</span><br><span class="line">    birth datetime,</span><br><span class="line">    salary <span class="type">decimal</span>(<span class="number">10</span>,<span class="number">2</span>),</span><br><span class="line">    phone <span class="type">char</span>(<span class="number">20</span>),</span><br><span class="line">    addr <span class="type">varchar</span>(<span class="number">100</span>),</span><br><span class="line">    dept_id <span class="type">int</span>,</span><br><span class="line">    <span class="keyword">foreign</span> key(dept_id) <span class="keyword">references</span> dept(dept_id),</span><br><span class="line">    index idx_ename(e_name),</span><br><span class="line">    <span class="keyword">unique</span> key uq_idx_phone(phone),</span><br><span class="line">    index idx_addr(addr(<span class="number">10</span>))</span><br><span class="line">);</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>查看索引</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">show</span> index <span class="keyword">from</span> dept\G</span><br><span class="line"><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span> <span class="number">1.</span> <span class="type">row</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">        <span class="keyword">Table</span>: dept</span><br><span class="line">   Non_unique: <span class="number">0</span></span><br><span class="line">     Key_name: <span class="keyword">PRIMARY</span></span><br><span class="line"> Seq_in_index: <span class="number">1</span></span><br><span class="line">  Column_name: dept_id</span><br><span class="line">    <span class="keyword">Collation</span>: A</span><br><span class="line">  <span class="keyword">Cardinality</span>: <span class="number">0</span></span><br><span class="line">     Sub_part: <span class="keyword">NULL</span></span><br><span class="line">       Packed: <span class="keyword">NULL</span></span><br><span class="line">         <span class="keyword">Null</span>: </span><br><span class="line">   Index_type: BTREE</span><br><span class="line">      Comment: </span><br><span class="line">Index_comment: </span><br><span class="line"><span class="number">1</span> <span class="type">row</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="创建表之后有需要时再创建索引"><a href="#创建表之后有需要时再创建索引" class="headerlink" title="创建表之后有需要时再创建索引"></a>创建表之后有需要时再创建索引</h2><h3 id="Alter-添加索引"><a href="#Alter-添加索引" class="headerlink" title="Alter 添加索引"></a>Alter 添加索引</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> 表名 </span><br><span class="line"><span class="keyword">ADD</span> [<span class="keyword">UNIQUE</span><span class="operator">|</span>FULLTEXT<span class="operator">|</span>SPATIAL] INDEX<span class="operator">|</span>KEY [索引名](字段名[(长度)] [<span class="keyword">ASC</span> <span class="operator">|</span> <span class="keyword">DESC</span>]);</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> stu (</span><br><span class="line">    s_id <span class="type">int</span> <span class="keyword">primary</span> key auto_increment,</span><br><span class="line">    s_name <span class="type">char</span>(<span class="number">20</span>),</span><br><span class="line">    gender <span class="type">char</span>(<span class="number">2</span>),</span><br><span class="line">    birth datetime,</span><br><span class="line">    phone <span class="type">char</span>(<span class="number">20</span>),</span><br><span class="line">    weight <span class="type">decimal</span>(<span class="number">4</span>,<span class="number">1</span>),</span><br><span class="line">    class <span class="type">char</span>(<span class="number">10</span>)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">alter</span> <span class="keyword">table</span> stu <span class="keyword">add</span> index idx_sname (s_name);</span><br><span class="line">Query OK, <span class="number">0</span> <span class="keyword">rows</span> affected (<span class="number">0.04</span> sec)</span><br><span class="line">Records: <span class="number">0</span>  Duplicates: <span class="number">0</span>  Warnings: <span class="number">0</span></span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">alter</span> <span class="keyword">table</span> stu <span class="keyword">add</span> <span class="keyword">unique</span> index uq_idx_phone (phone);</span><br><span class="line">Query OK, <span class="number">0</span> <span class="keyword">rows</span> affected (<span class="number">0.03</span> sec)</span><br><span class="line">Records: <span class="number">0</span>  Duplicates: <span class="number">0</span>  Warnings: <span class="number">0</span></span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">alter</span> <span class="keyword">table</span> stu <span class="keyword">add</span> index idx_class_sname (class,s_name);</span><br><span class="line">Query OK, <span class="number">0</span> <span class="keyword">rows</span> affected (<span class="number">0.04</span> sec)</span><br><span class="line">Records: <span class="number">0</span>  Duplicates: <span class="number">0</span>  Warnings: <span class="number">0</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="使用-create-index-命令添加索引"><a href="#使用-create-index-命令添加索引" class="headerlink" title="使用 create index 命令添加索引"></a>使用 create index 命令添加索引</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span>  [<span class="keyword">UNIQUE</span> <span class="operator">|</span> FULLTEXT <span class="operator">|</span> SPATIAL]  INDEX  索引名 <span class="keyword">ON</span>  表名(字段名);</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> book (</span><br><span class="line">    id <span class="type">int</span> <span class="keyword">primary</span> key auto_increment,</span><br><span class="line">    name <span class="type">char</span>(<span class="number">20</span>),</span><br><span class="line">    isbn <span class="type">char</span>(<span class="number">20</span>),</span><br><span class="line">    author <span class="type">char</span>(<span class="number">20</span>),</span><br><span class="line">    publisher <span class="type">char</span>(<span class="number">100</span>),</span><br><span class="line">    price <span class="type">decimal</span>(<span class="number">10</span>,<span class="number">2</span>)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">create</span> index idx_name <span class="keyword">on</span> book(name);</span><br><span class="line">Query OK, <span class="number">0</span> <span class="keyword">rows</span> affected (<span class="number">0.06</span> sec)</span><br><span class="line">Records: <span class="number">0</span>  Duplicates: <span class="number">0</span>  Warnings: <span class="number">0</span></span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">create</span> <span class="keyword">unique</span> index uq_idx_isbn <span class="keyword">on</span> book(isbn);</span><br><span class="line">Query OK, <span class="number">0</span> <span class="keyword">rows</span> affected (<span class="number">0.02</span> sec)</span><br><span class="line">Records: <span class="number">0</span>  Duplicates: <span class="number">0</span>  Warnings: <span class="number">0</span></span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">create</span> index idx_publisher_price <span class="keyword">on</span> book(publisher,price);</span><br><span class="line">Query OK, <span class="number">0</span> <span class="keyword">rows</span> affected (<span class="number">0.02</span> sec)</span><br><span class="line">Records: <span class="number">0</span>  Duplicates: <span class="number">0</span>  Warnings: <span class="number">0</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">show</span> index <span class="keyword">from</span> book\G</span><br><span class="line"><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span> <span class="number">1.</span> <span class="type">row</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">        <span class="keyword">Table</span>: book</span><br><span class="line">   Non_unique: <span class="number">0</span></span><br><span class="line">     Key_name: <span class="keyword">PRIMARY</span></span><br><span class="line"> Seq_in_index: <span class="number">1</span></span><br><span class="line">  Column_name: id</span><br><span class="line">    <span class="keyword">Collation</span>: A</span><br><span class="line">  <span class="keyword">Cardinality</span>: <span class="number">0</span></span><br><span class="line">     Sub_part: <span class="keyword">NULL</span></span><br><span class="line">       Packed: <span class="keyword">NULL</span></span><br><span class="line">         <span class="keyword">Null</span>: </span><br><span class="line">   Index_type: BTREE</span><br><span class="line">      Comment: </span><br><span class="line">Index_comment: </span><br><span class="line"><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span> <span class="number">2.</span> <span class="type">row</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">        <span class="keyword">Table</span>: book</span><br><span class="line">   Non_unique: <span class="number">0</span></span><br><span class="line">     Key_name: uq_idx_isbn</span><br><span class="line"> Seq_in_index: <span class="number">1</span></span><br><span class="line">  Column_name: isbn</span><br><span class="line">    <span class="keyword">Collation</span>: A</span><br><span class="line">  <span class="keyword">Cardinality</span>: <span class="number">0</span></span><br><span class="line">     Sub_part: <span class="keyword">NULL</span></span><br><span class="line">       Packed: <span class="keyword">NULL</span></span><br><span class="line">         <span class="keyword">Null</span>: YES</span><br><span class="line">   Index_type: BTREE</span><br><span class="line">      Comment: </span><br><span class="line">Index_comment: </span><br><span class="line"><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span> <span class="number">3.</span> <span class="type">row</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">        <span class="keyword">Table</span>: book</span><br><span class="line">   Non_unique: <span class="number">1</span></span><br><span class="line">     Key_name: idx_name</span><br><span class="line"> Seq_in_index: <span class="number">1</span></span><br><span class="line">  Column_name: name</span><br><span class="line">    <span class="keyword">Collation</span>: A</span><br><span class="line">  <span class="keyword">Cardinality</span>: <span class="number">0</span></span><br><span class="line">     Sub_part: <span class="keyword">NULL</span></span><br><span class="line">       Packed: <span class="keyword">NULL</span></span><br><span class="line">         <span class="keyword">Null</span>: YES</span><br><span class="line">   Index_type: BTREE</span><br><span class="line">      Comment: </span><br><span class="line">Index_comment: </span><br><span class="line"><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span> <span class="number">4.</span> <span class="type">row</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">        <span class="keyword">Table</span>: book</span><br><span class="line">   Non_unique: <span class="number">1</span></span><br><span class="line">     Key_name: idx_publisher_price</span><br><span class="line"> Seq_in_index: <span class="number">1</span></span><br><span class="line">  Column_name: publisher</span><br><span class="line">    <span class="keyword">Collation</span>: A</span><br><span class="line">  <span class="keyword">Cardinality</span>: <span class="number">0</span></span><br><span class="line">     Sub_part: <span class="keyword">NULL</span></span><br><span class="line">       Packed: <span class="keyword">NULL</span></span><br><span class="line">         <span class="keyword">Null</span>: YES</span><br><span class="line">   Index_type: BTREE</span><br><span class="line">      Comment: </span><br><span class="line">Index_comment: </span><br><span class="line"><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span> <span class="number">5.</span> <span class="type">row</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">        <span class="keyword">Table</span>: book</span><br><span class="line">   Non_unique: <span class="number">1</span></span><br><span class="line">     Key_name: idx_publisher_price</span><br><span class="line"> Seq_in_index: <span class="number">2</span></span><br><span class="line">  Column_name: price</span><br><span class="line">    <span class="keyword">Collation</span>: A</span><br><span class="line">  <span class="keyword">Cardinality</span>: <span class="number">0</span></span><br><span class="line">     Sub_part: <span class="keyword">NULL</span></span><br><span class="line">       Packed: <span class="keyword">NULL</span></span><br><span class="line">         <span class="keyword">Null</span>: YES</span><br><span class="line">   Index_type: BTREE</span><br><span class="line">      Comment: </span><br><span class="line">Index_comment: </span><br><span class="line"><span class="number">5</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="使用-alter-table-命令删除索引"><a href="#使用-alter-table-命令删除索引" class="headerlink" title="使用 alter table 命令删除索引"></a>使用 alter table 命令删除索引</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> 表名 <span class="keyword">DROP</span> INDEX 索引名;</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">show</span> index <span class="keyword">from</span> stu;</span><br><span class="line"><span class="operator">+</span><span class="comment">-------+------------+-----------------+--------------+-------------+-----------</span></span><br><span class="line"><span class="operator">|</span> <span class="keyword">Table</span> <span class="operator">|</span> Non_unique <span class="operator">|</span> Key_name        <span class="operator">|</span> Seq_in_index <span class="operator">|</span> Column_name <span class="operator">|</span> <span class="keyword">Collation</span> </span><br><span class="line"><span class="operator">+</span><span class="comment">-------+------------+-----------------+--------------+-------------+-----------</span></span><br><span class="line"><span class="operator">|</span> stu   <span class="operator">|</span>          <span class="number">0</span> <span class="operator">|</span> <span class="keyword">PRIMARY</span>         <span class="operator">|</span>            <span class="number">1</span> <span class="operator">|</span> s_id        <span class="operator">|</span> A         </span><br><span class="line"><span class="operator">|</span> stu   <span class="operator">|</span>          <span class="number">0</span> <span class="operator">|</span> uq_idx_phone    <span class="operator">|</span>            <span class="number">1</span> <span class="operator">|</span> phone       <span class="operator">|</span> A         </span><br><span class="line"><span class="operator">|</span> stu   <span class="operator">|</span>          <span class="number">1</span> <span class="operator">|</span> idx_sname       <span class="operator">|</span>            <span class="number">1</span> <span class="operator">|</span> s_name      <span class="operator">|</span> A         </span><br><span class="line"><span class="operator">|</span> stu   <span class="operator">|</span>          <span class="number">1</span> <span class="operator">|</span> idx_class_sname <span class="operator">|</span>            <span class="number">1</span> <span class="operator">|</span> class       <span class="operator">|</span> A         </span><br><span class="line"><span class="operator">|</span> stu   <span class="operator">|</span>          <span class="number">1</span> <span class="operator">|</span> idx_class_sname <span class="operator">|</span>            <span class="number">2</span> <span class="operator">|</span> s_name      <span class="operator">|</span> A         </span><br><span class="line"><span class="operator">+</span><span class="comment">-------+------------+-----------------+--------------+-------------+-----------</span></span><br><span class="line"><span class="number">5</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">alter</span> <span class="keyword">table</span> stu <span class="keyword">drop</span> index idx_sname;</span><br><span class="line">Query OK, <span class="number">0</span> <span class="keyword">rows</span> affected (<span class="number">0.02</span> sec)</span><br><span class="line">Records: <span class="number">0</span>  Duplicates: <span class="number">0</span>  Warnings: <span class="number">0</span></span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">alter</span> <span class="keyword">table</span> stu <span class="keyword">drop</span> index idx_class_sname;</span><br><span class="line">Query OK, <span class="number">0</span> <span class="keyword">rows</span> affected (<span class="number">0.04</span> sec)</span><br><span class="line">Records: <span class="number">0</span>  Duplicates: <span class="number">0</span>  Warnings: <span class="number">0</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="使用-drop-index-命令删除索引"><a href="#使用-drop-index-命令删除索引" class="headerlink" title="使用 drop index 命令删除索引"></a>使用 drop index 命令删除索引</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> INDEX 索引名 <span class="keyword">ON</span> 表名;</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">show</span> index <span class="keyword">from</span> book;</span><br><span class="line"><span class="operator">+</span><span class="comment">-------+------------+---------------------+--------------+-------------+-----------</span></span><br><span class="line"><span class="operator">|</span> <span class="keyword">Table</span> <span class="operator">|</span> Non_unique <span class="operator">|</span> Key_name            <span class="operator">|</span> Seq_in_index <span class="operator">|</span> Column_name <span class="operator">|</span> <span class="keyword">Collation</span> </span><br><span class="line"><span class="operator">+</span><span class="comment">-------+------------+---------------------+--------------+-------------+-----------</span></span><br><span class="line"><span class="operator">|</span> book  <span class="operator">|</span>          <span class="number">0</span> <span class="operator">|</span> <span class="keyword">PRIMARY</span>             <span class="operator">|</span>            <span class="number">1</span> <span class="operator">|</span> id          <span class="operator">|</span> A         </span><br><span class="line"><span class="operator">|</span> book  <span class="operator">|</span>          <span class="number">0</span> <span class="operator">|</span> uq_idx_isbn         <span class="operator">|</span>            <span class="number">1</span> <span class="operator">|</span> isbn        <span class="operator">|</span> A         </span><br><span class="line"><span class="operator">|</span> book  <span class="operator">|</span>          <span class="number">1</span> <span class="operator">|</span> idx_name            <span class="operator">|</span>            <span class="number">1</span> <span class="operator">|</span> name        <span class="operator">|</span> A         </span><br><span class="line"><span class="operator">|</span> book  <span class="operator">|</span>          <span class="number">1</span> <span class="operator">|</span> idx_publisher_price <span class="operator">|</span>            <span class="number">1</span> <span class="operator">|</span> publisher   <span class="operator">|</span> A         </span><br><span class="line"><span class="operator">|</span> book  <span class="operator">|</span>          <span class="number">1</span> <span class="operator">|</span> idx_publisher_price <span class="operator">|</span>            <span class="number">2</span> <span class="operator">|</span> price       <span class="operator">|</span> A         </span><br><span class="line"><span class="operator">+</span><span class="comment">-------+------------+---------------------+--------------+-------------+-----------</span></span><br><span class="line"><span class="number">5</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">drop</span> index idx_name <span class="keyword">on</span> book;</span><br><span class="line">Query OK, <span class="number">0</span> <span class="keyword">rows</span> affected (<span class="number">0.06</span> sec)</span><br><span class="line">Records: <span class="number">0</span>  Duplicates: <span class="number">0</span>  Warnings: <span class="number">0</span></span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">drop</span> index idx_publisher_price <span class="keyword">on</span> book;</span><br><span class="line">Query OK, <span class="number">0</span> <span class="keyword">rows</span> affected (<span class="number">0.02</span> sec)</span><br><span class="line">Records: <span class="number">0</span>  Duplicates: <span class="number">0</span>  Warnings: <span class="number">0</span></span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">show</span> index <span class="keyword">from</span> book\G</span><br><span class="line"><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span> <span class="number">1.</span> <span class="type">row</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">        <span class="keyword">Table</span>: book</span><br><span class="line">   Non_unique: <span class="number">0</span></span><br><span class="line">     Key_name: <span class="keyword">PRIMARY</span></span><br><span class="line"> Seq_in_index: <span class="number">1</span></span><br><span class="line">  Column_name: id</span><br><span class="line">    <span class="keyword">Collation</span>: A</span><br><span class="line">  <span class="keyword">Cardinality</span>: <span class="number">0</span></span><br><span class="line">     Sub_part: <span class="keyword">NULL</span></span><br><span class="line">       Packed: <span class="keyword">NULL</span></span><br><span class="line">         <span class="keyword">Null</span>: </span><br><span class="line">   Index_type: BTREE</span><br><span class="line">      Comment: </span><br><span class="line">Index_comment: </span><br><span class="line"><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span> <span class="number">2.</span> <span class="type">row</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">        <span class="keyword">Table</span>: book</span><br><span class="line">   Non_unique: <span class="number">0</span></span><br><span class="line">     Key_name: uq_idx_isbn</span><br><span class="line"> Seq_in_index: <span class="number">1</span></span><br><span class="line">  Column_name: isbn</span><br><span class="line">    <span class="keyword">Collation</span>: A</span><br><span class="line">  <span class="keyword">Cardinality</span>: <span class="number">0</span></span><br><span class="line">     Sub_part: <span class="keyword">NULL</span></span><br><span class="line">       Packed: <span class="keyword">NULL</span></span><br><span class="line">         <span class="keyword">Null</span>: YES</span><br><span class="line">   Index_type: BTREE</span><br><span class="line">      Comment: </span><br><span class="line">Index_comment: </span><br><span class="line"><span class="number">2</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h1 id="explain分析索引使用情况"><a href="#explain分析索引使用情况" class="headerlink" title="explain分析索引使用情况"></a>explain分析索引使用情况</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">explain <span class="keyword">select</span> 语句;</span><br></pre></td></tr></table></figure>

<h2 id="一、数据准备-2"><a href="#一、数据准备-2" class="headerlink" title="一、数据准备"></a>一、数据准备</h2><p>有一个 emp 表，表中的索引信息如下：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">show</span> index <span class="keyword">from</span> emp;</span><br><span class="line"><span class="operator">+</span><span class="comment">-------+------------+--------------+--------------+-------------+-----------</span></span><br><span class="line"><span class="operator">|</span> <span class="keyword">Table</span> <span class="operator">|</span> Non_unique <span class="operator">|</span> Key_name     <span class="operator">|</span> Seq_in_index <span class="operator">|</span> Column_name <span class="operator">|</span> <span class="keyword">Collation</span> </span><br><span class="line"><span class="operator">+</span><span class="comment">-------+------------+--------------+--------------+-------------+-----------</span></span><br><span class="line"><span class="operator">|</span> emp   <span class="operator">|</span>          <span class="number">0</span> <span class="operator">|</span> <span class="keyword">PRIMARY</span>      <span class="operator">|</span>            <span class="number">1</span> <span class="operator">|</span> e_id        <span class="operator">|</span> A         </span><br><span class="line"><span class="operator">|</span> emp   <span class="operator">|</span>          <span class="number">0</span> <span class="operator">|</span> uq_idx_phone <span class="operator">|</span>            <span class="number">1</span> <span class="operator">|</span> phone       <span class="operator">|</span> A         </span><br><span class="line"><span class="operator">|</span> emp   <span class="operator">|</span>          <span class="number">1</span> <span class="operator">|</span> dept_id      <span class="operator">|</span>            <span class="number">1</span> <span class="operator">|</span> dept_id     <span class="operator">|</span> A         </span><br><span class="line"><span class="operator">|</span> emp   <span class="operator">|</span>          <span class="number">1</span> <span class="operator">|</span> idx_ename    <span class="operator">|</span>            <span class="number">1</span> <span class="operator">|</span> e_name      <span class="operator">|</span> A         </span><br><span class="line"><span class="operator">|</span> emp   <span class="operator">|</span>          <span class="number">1</span> <span class="operator">|</span> idx_addr     <span class="operator">|</span>            <span class="number">1</span> <span class="operator">|</span> addr        <span class="operator">|</span> A         </span><br><span class="line"><span class="operator">+</span><span class="comment">-------+------------+--------------+--------------+-------------+-----------</span></span><br><span class="line"><span class="number">5</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="二、使用-explain-分析查询"><a href="#二、使用-explain-分析查询" class="headerlink" title="二、使用 explain 分析查询"></a>二、使用 explain 分析查询</h2><p>执行以下命令：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> explain <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">where</span> e_name<span class="operator">=</span><span class="string">&#x27;Mark&#x27;</span>\G</span><br><span class="line"><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span> <span class="number">1.</span> <span class="type">row</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">           id: <span class="number">1</span></span><br><span class="line">  select_type: SIMPLE</span><br><span class="line">        <span class="keyword">table</span>: emp</span><br><span class="line">   partitions: <span class="keyword">NULL</span></span><br><span class="line">         type: <span class="keyword">ref</span></span><br><span class="line">possible_keys: idx_ename</span><br><span class="line">          key: idx_ename</span><br><span class="line">      key_len: <span class="number">81</span></span><br><span class="line">          <span class="keyword">ref</span>: const</span><br><span class="line">         <span class="keyword">rows</span>: <span class="number">1</span></span><br><span class="line">     filtered: <span class="number">100.00</span></span><br><span class="line">        Extra: <span class="keyword">NULL</span></span><br><span class="line"><span class="number">1</span> <span class="type">row</span> <span class="keyword">in</span> <span class="keyword">set</span>, <span class="number">1</span> warning (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>查询结果中的各个选项的含义如下：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">（<span class="number">1</span>） id：<span class="keyword">SELECT</span> 识别符</span><br><span class="line">（<span class="number">2</span>） select_type：<span class="keyword">SELECT</span> 查询的类型</span><br><span class="line">（<span class="number">3</span>） <span class="keyword">table</span>：数据表的名字</span><br><span class="line">（<span class="number">4</span>） partitions：匹配的分区</span><br><span class="line">（<span class="number">5</span>） type：访问表的方式</span><br><span class="line">（<span class="number">6</span>） possible_keys：查询时可能使用的索引</span><br><span class="line">（<span class="number">7</span>） key：实际使用的索引</span><br><span class="line">（<span class="number">8</span>） key_len：索引字段的长度</span><br><span class="line">（<span class="number">9</span>） <span class="keyword">ref</span>：连接查询时，用于显示关联的字段</span><br><span class="line">（<span class="number">10</span>） <span class="keyword">rows</span>：需要扫描的行数(估算的行数)</span><br><span class="line">（<span class="number">11</span>） filtered：按条件过滤后查询到的记录的百分比</span><br><span class="line">（<span class="number">12</span>） Extra：执行情况的描述和说明</span><br></pre></td></tr></table></figure>

<h2 id="三、explain-各个选项的详细说明及举例"><a href="#三、explain-各个选项的详细说明及举例" class="headerlink" title="三、explain 各个选项的详细说明及举例"></a>三、explain 各个选项的详细说明及举例</h2><h4 id="1、id"><a href="#1、id" class="headerlink" title="1、id"></a>1、id</h4><p>SELECT 识别符，是SELECT 查询的序列号。表示查询中执行 select 子句或操作表的顺序，id 相同，执行顺序从上到下，id 不同，id 值越大则执行的优先级越高。例如：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> explain <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">where</span> dept_id<span class="operator">=</span>(<span class="keyword">select</span> dept_id <span class="keyword">from</span> dept <span class="keyword">where</span> dept_name<span class="operator">=</span><span class="string">&#x27;财务部&#x27;</span>)\G</span><br><span class="line"><span class="comment">--如果包含子查询，id 的序号会递增，id 值越大执行优先级越高</span></span><br><span class="line"><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span> <span class="number">1.</span> <span class="type">row</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">           id: <span class="number">1</span>     <span class="comment">---外部查询</span></span><br><span class="line">  select_type: <span class="keyword">PRIMARY</span></span><br><span class="line">        <span class="keyword">table</span>: emp</span><br><span class="line"><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span> <span class="number">2.</span> <span class="type">row</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">           id: <span class="number">2</span>   <span class="comment">---子查询</span></span><br><span class="line">  select_type: SUBQUERY</span><br><span class="line"><span class="comment">--id相同，执行顺序从上到下</span></span><br><span class="line">mysql<span class="operator">&gt;</span> explain <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp,dept <span class="keyword">where</span> emp.dept_id<span class="operator">=</span>dept.dept_id\G</span><br><span class="line"><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span> <span class="number">1.</span> <span class="type">row</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">           id: <span class="number">1</span></span><br><span class="line">  select_type: SIMPLE</span><br><span class="line">        <span class="keyword">table</span>: dept</span><br><span class="line"><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span> <span class="number">2.</span> <span class="type">row</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">           id: <span class="number">1</span></span><br><span class="line">  select_type: SIMPLE</span><br><span class="line">        <span class="keyword">table</span>: emp</span><br></pre></td></tr></table></figure>

<h4 id="2、select-type"><a href="#2、select-type" class="headerlink" title="2、select_type"></a>2、select_type</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">表示查询中每个 <span class="keyword">select</span> 子句的类型。有以下几种类型：</span><br><span class="line">(<span class="number">1</span>) SIMPLE（简单的 <span class="keyword">select</span> 查询，查询中不包含子查询或 <span class="keyword">union</span> 查询）</span><br><span class="line">例如：</span><br><span class="line">mysql<span class="operator">&gt;</span> explain <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> dept\G</span><br><span class="line"><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span> <span class="number">1.</span> <span class="type">row</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">           id: <span class="number">1</span></span><br><span class="line">  select_type: SIMPLE</span><br><span class="line">(<span class="number">2</span>) <span class="keyword">PRIMARY</span>（子查询中最外层查询，查询中若包含任何复杂的子部分，最外层的 <span class="keyword">select</span> 被标记为 <span class="keyword">PRIMARY</span>）</span><br><span class="line">例如：</span><br><span class="line">mysql<span class="operator">&gt;</span> explain <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">where</span> dept_id<span class="operator">=</span>(<span class="keyword">select</span> dept_id <span class="keyword">from</span> dept <span class="keyword">where</span> dept_name<span class="operator">=</span><span class="string">&#x27;财务部&#x27;</span>)\G</span><br><span class="line"><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span> <span class="number">1.</span> <span class="type">row</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">           id: <span class="number">1</span>     <span class="comment">---外部查询</span></span><br><span class="line">  select_type: <span class="keyword">PRIMARY</span></span><br><span class="line">        <span class="keyword">table</span>: emp</span><br><span class="line"><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span> <span class="number">2.</span> <span class="type">row</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">           id: <span class="number">2</span>   <span class="comment">---子查询</span></span><br><span class="line">  select_type: SUBQUERY</span><br><span class="line">(<span class="number">3</span>) SUBQUERY（子查询中的第一个<span class="keyword">SELECT</span>，结果不依赖于外部查询）</span><br><span class="line">例如：见上一个例子。</span><br><span class="line">(<span class="number">4</span>) DEPENDENT SUBQUERY(子查询中的第一个<span class="keyword">SELECT</span>，依赖于外部查询)</span><br><span class="line">例如：</span><br><span class="line">mysql<span class="operator">&gt;</span> explain <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> dept <span class="keyword">where</span> <span class="keyword">exists</span> (<span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">where</span> emp.dept_id<span class="operator">=</span>dept.dept_id)\G</span><br><span class="line"><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span> <span class="number">1.</span> <span class="type">row</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">           id: <span class="number">1</span></span><br><span class="line">  select_type: <span class="keyword">PRIMARY</span></span><br><span class="line"><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span> <span class="number">2.</span> <span class="type">row</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">           id: <span class="number">2</span></span><br><span class="line">  select_type: DEPENDENT SUBQUERY </span><br><span class="line">(<span class="number">5</span>) <span class="keyword">UNION</span>（<span class="keyword">UNION</span>中的第二个或后面的<span class="keyword">SELECT</span>语句）</span><br><span class="line">例如：</span><br><span class="line">mysql<span class="operator">&gt;</span> explain <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">where</span> dept_id<span class="operator">=</span><span class="number">11</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">where</span> dept_id<span class="operator">=</span><span class="number">22</span>\G</span><br><span class="line"><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span> <span class="number">1.</span> <span class="type">row</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">           id: <span class="number">1</span></span><br><span class="line">  select_type: <span class="keyword">PRIMARY</span></span><br><span class="line"><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span> <span class="number">2.</span> <span class="type">row</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">           id: <span class="number">2</span></span><br><span class="line">  select_type: <span class="keyword">UNION</span></span><br><span class="line"><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span> <span class="number">3.</span> <span class="type">row</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">           id: <span class="keyword">NULL</span></span><br><span class="line">  select_type: <span class="keyword">UNION</span> <span class="keyword">RESULT</span></span><br><span class="line">(<span class="number">6</span>) <span class="keyword">UNION</span> <span class="keyword">RESULT</span>（<span class="keyword">UNION</span>的结果，<span class="keyword">union</span>语句中第二个<span class="keyword">select</span>开始后面所有<span class="keyword">select</span>）</span><br><span class="line">例如：见上一个例子</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="3、table"><a href="#3、table" class="headerlink" title="3、table"></a>3、table</h4><p>查询所用的表名称，可能是别名。例如：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> explain <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp e,dept d <span class="keyword">where</span> e.dept_id<span class="operator">=</span>d.dept_id\G</span><br><span class="line"><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span> <span class="number">1.</span> <span class="type">row</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">           id: <span class="number">1</span></span><br><span class="line">  select_type: SIMPLE</span><br><span class="line">        <span class="keyword">table</span>: d</span><br><span class="line"><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span> <span class="number">2.</span> <span class="type">row</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">           id: <span class="number">1</span></span><br><span class="line">  select_type: SIMPLE</span><br><span class="line">        <span class="keyword">table</span>: e</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> explain <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp\G</span><br><span class="line"><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span> <span class="number">1.</span> <span class="type">row</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">           id: <span class="number">1</span></span><br><span class="line">  select_type: SIMPLE</span><br><span class="line">        <span class="keyword">table</span>: emp</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="4、partitions"><a href="#4、partitions" class="headerlink" title="4、partitions"></a>4、partitions</h4><p>查询匹配的分区：例子略。</p>
<h4 id="5、type"><a href="#5、type" class="headerlink" title="5、type"></a>5、type</h4><p>访问表的方式，表示 MySQL 在表中找到所需行的方式。常用的类型有： ALL、index、range、 ref、eq_ref、const、system、NULL（从左到右，性能从差到好）。例如：</p>
<p>查询用到的表及索引情况如下：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">show</span> index <span class="keyword">from</span> dept;</span><br><span class="line"><span class="operator">+</span><span class="comment">-------+------------+----------+--------------+-------------+-----------</span></span><br><span class="line"><span class="operator">|</span> <span class="keyword">Table</span> <span class="operator">|</span> Non_unique <span class="operator">|</span> Key_name <span class="operator">|</span> Seq_in_index <span class="operator">|</span> Column_name <span class="operator">|</span> <span class="keyword">Collation</span> </span><br><span class="line"><span class="operator">+</span><span class="comment">-------+------------+----------+--------------+-------------+-----------</span></span><br><span class="line"><span class="operator">|</span> dept  <span class="operator">|</span>          <span class="number">0</span> <span class="operator">|</span> <span class="keyword">PRIMARY</span>  <span class="operator">|</span>            <span class="number">1</span> <span class="operator">|</span> dept_id     <span class="operator">|</span> A         </span><br><span class="line"><span class="operator">+</span><span class="comment">-------+------------+----------+--------------+-------------+-----------</span></span><br><span class="line"><span class="number">1</span> <span class="type">row</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">show</span> index <span class="keyword">from</span> emp;</span><br><span class="line"><span class="operator">+</span><span class="comment">-------+------------+--------------+--------------+-------------+-----------</span></span><br><span class="line"><span class="operator">|</span> <span class="keyword">Table</span> <span class="operator">|</span> Non_unique <span class="operator">|</span> Key_name     <span class="operator">|</span> Seq_in_index <span class="operator">|</span> Column_name <span class="operator">|</span> <span class="keyword">Collation</span> </span><br><span class="line"><span class="operator">+</span><span class="comment">-------+------------+--------------+--------------+-------------+-----------</span></span><br><span class="line"><span class="operator">|</span> emp   <span class="operator">|</span>          <span class="number">0</span> <span class="operator">|</span> <span class="keyword">PRIMARY</span>      <span class="operator">|</span>            <span class="number">1</span> <span class="operator">|</span> e_id        <span class="operator">|</span> A         </span><br><span class="line"><span class="operator">|</span> emp   <span class="operator">|</span>          <span class="number">0</span> <span class="operator">|</span> uq_idx_phone <span class="operator">|</span>            <span class="number">1</span> <span class="operator">|</span> phone       <span class="operator">|</span> A         </span><br><span class="line"><span class="operator">|</span> emp   <span class="operator">|</span>          <span class="number">1</span> <span class="operator">|</span> dept_id      <span class="operator">|</span>            <span class="number">1</span> <span class="operator">|</span> dept_id     <span class="operator">|</span> A         </span><br><span class="line"><span class="operator">|</span> emp   <span class="operator">|</span>          <span class="number">1</span> <span class="operator">|</span> idx_ename    <span class="operator">|</span>            <span class="number">1</span> <span class="operator">|</span> e_name      <span class="operator">|</span> A         </span><br><span class="line"><span class="operator">|</span> emp   <span class="operator">|</span>          <span class="number">1</span> <span class="operator">|</span> idx_addr     <span class="operator">|</span>            <span class="number">1</span> <span class="operator">|</span> addr        <span class="operator">|</span> A         </span><br><span class="line"><span class="operator">+</span><span class="comment">-------+------------+--------------+--------------+-------------+-----------</span></span><br><span class="line"><span class="number">5</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>常用的类型的说明及举例：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line">（<span class="number">1</span>）<span class="keyword">ALL</span>：<span class="keyword">Full</span> <span class="keyword">Table</span> Scan，如果查询没有使用索引，MySQL将遍历全表以找到匹配的行。</span><br><span class="line">例如：</span><br><span class="line">mysql<span class="operator">&gt;</span> explain <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">where</span> birth<span class="operator">=</span><span class="string">&#x27;1998-1-1&#x27;</span>\G</span><br><span class="line"><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span> <span class="number">1.</span> <span class="type">row</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">           id: <span class="number">1</span></span><br><span class="line">  select_type: SIMPLE</span><br><span class="line">        <span class="keyword">table</span>: emp</span><br><span class="line">   partitions: <span class="keyword">NULL</span></span><br><span class="line">         type: <span class="keyword">ALL</span></span><br><span class="line"><span class="comment">--该查询的条件没有创建索引，因此是全表扫描。</span></span><br><span class="line">（<span class="number">2</span>）index: 全索引扫描，和 <span class="keyword">ALL</span> 相比，index 只遍历索引树，通常比 <span class="keyword">ALL</span> 快，因为索引文件通常比数据文件小。</span><br><span class="line">例如：</span><br><span class="line">mysql<span class="operator">&gt;</span> explain <span class="keyword">select</span> e_id <span class="keyword">from</span> emp\G</span><br><span class="line"><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span> <span class="number">1.</span> <span class="type">row</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">           id: <span class="number">1</span></span><br><span class="line">  select_type: SIMPLE</span><br><span class="line">        <span class="keyword">table</span>: emp</span><br><span class="line">   partitions: <span class="keyword">NULL</span></span><br><span class="line">         type: index</span><br><span class="line"><span class="comment">--该查询是把 e_id 列中所有数据全部取出，并且对 e_id 列创建了索引，因此需要遍历整个索引树</span></span><br><span class="line">（<span class="number">3</span>）<span class="keyword">range</span>：检索给定范围的行，可以在 key 列中查看使用的索引，一般出现在 <span class="keyword">where</span> 语句的条件中，如使用<span class="keyword">between</span>、<span class="operator">&gt;</span>、<span class="operator">&lt;</span>、<span class="keyword">in</span>等查询。</span><br><span class="line">例如：</span><br><span class="line">mysql<span class="operator">&gt;</span> explain <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">where</span> e_id<span class="operator">&gt;</span><span class="number">1000</span>\G</span><br><span class="line"><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span> <span class="number">1.</span> <span class="type">row</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">           id: <span class="number">1</span></span><br><span class="line">  select_type: SIMPLE</span><br><span class="line">        <span class="keyword">table</span>: emp</span><br><span class="line">   partitions: <span class="keyword">NULL</span></span><br><span class="line">         type: <span class="keyword">range</span></span><br><span class="line">（<span class="number">4</span>）<span class="keyword">ref</span>: 非唯一性索引扫描，返回匹配某个单独值的所有行。本质上也是一种索引访问，返回匹配某条件的多行值。</span><br><span class="line">例如：</span><br><span class="line">mysql<span class="operator">&gt;</span> explain <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">where</span> dept_id<span class="operator">=</span><span class="number">11</span>\G</span><br><span class="line"><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span> <span class="number">1.</span> <span class="type">row</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">           id: <span class="number">1</span></span><br><span class="line">  select_type: SIMPLE</span><br><span class="line">        <span class="keyword">table</span>: emp</span><br><span class="line">   partitions: <span class="keyword">NULL</span></span><br><span class="line">         type: <span class="keyword">ref</span></span><br><span class="line"><span class="comment">--该查询针对 dept_id 字段进行查询，查询到多条记录，并且为 dept_id 字段创建了索引。</span></span><br><span class="line">（<span class="number">5</span>）eq_ref: 唯一索引扫描，对于每个索引键，表中只有一条记录与之匹配。常见主键或唯一索引扫描。</span><br><span class="line">mysql<span class="operator">&gt;</span> explain <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">join</span> dept <span class="keyword">on</span> emp.dept_id<span class="operator">=</span>dept.dept_id <span class="keyword">where</span> e_name<span class="operator">=</span><span class="string">&#x27;Jack&#x27;</span>\G</span><br><span class="line"><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span> <span class="number">1.</span> <span class="type">row</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">           id: <span class="number">1</span></span><br><span class="line">  select_type: SIMPLE</span><br><span class="line">        <span class="keyword">table</span>: emp</span><br><span class="line">   partitions: <span class="keyword">NULL</span></span><br><span class="line">         type: <span class="keyword">ref</span></span><br><span class="line"><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span> <span class="number">2.</span> <span class="type">row</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">           id: <span class="number">1</span></span><br><span class="line">  select_type: SIMPLE</span><br><span class="line">        <span class="keyword">table</span>: dept</span><br><span class="line">   partitions: <span class="keyword">NULL</span></span><br><span class="line">         type: eq_ref</span><br><span class="line">（<span class="number">6</span>）const: 表示通过一次索引就找到了结果，常出现于 <span class="keyword">primary</span> key 或 <span class="keyword">unique</span> 索引。因为只匹配一行数据，所以查询非常快。如将主键置于 <span class="keyword">where</span> 条件中，MySQL 就能将查询转换为一个常量。</span><br><span class="line">例如：</span><br><span class="line">mysql<span class="operator">&gt;</span> explain <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">where</span> e_id<span class="operator">=</span><span class="number">1002</span>\G</span><br><span class="line"><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span> <span class="number">1.</span> <span class="type">row</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">           id: <span class="number">1</span></span><br><span class="line">  select_type: SIMPLE</span><br><span class="line">        <span class="keyword">table</span>: emp</span><br><span class="line">   partitions: <span class="keyword">NULL</span></span><br><span class="line">         type: const</span><br><span class="line">（<span class="number">7</span>）<span class="keyword">NULL</span>: 执行时不用访问表或索引。</span><br><span class="line">例如：</span><br><span class="line">mysql<span class="operator">&gt;</span> explain <span class="keyword">select</span> <span class="number">1</span> <span class="keyword">from</span> dual\G</span><br><span class="line"><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span> <span class="number">1.</span> <span class="type">row</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">           id: <span class="number">1</span></span><br><span class="line">  select_type: SIMPLE</span><br><span class="line">        <span class="keyword">table</span>: <span class="keyword">NULL</span></span><br><span class="line">   partitions: <span class="keyword">NULL</span></span><br><span class="line">         type: <span class="keyword">NULL</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="6、possible-keys"><a href="#6、possible-keys" class="headerlink" title="6、possible_keys"></a>6、possible_keys</h4><p>显示可能应用在表中的索引，可能一个或多个。查询涉及到的字段若存在索引，则该索引将被列出，但不一定被查询实际使用。例如：</p>
<h4 id="7、key"><a href="#7、key" class="headerlink" title="7、key"></a>7、key</h4><p>实际使用的索引，如为NULL，则表示未使用索引。若查询中使用了覆盖索引，则该索引和查询的 select 字段重叠。</p>
<p>见上一个例子。</p>
<h4 id="8、key-len"><a href="#8、key-len" class="headerlink" title="8、key_len"></a>8、key_len</h4><p>表示索引所使用的字节数，可通过该列计算查询中使用的索引长度。在不损失精确性的情况下，长度越短越好。</p>
<p>例如：</p>
<h4 id="9、ref"><a href="#9、ref" class="headerlink" title="9、ref"></a>9、ref</h4><p>显示关联的字段，如果是非连接查询，则显示 const，如果是连接查询，则会显示关联的字段。例如：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> explain <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">join</span> dept <span class="keyword">on</span> emp.dept_id<span class="operator">=</span>dept.dept_id <span class="keyword">where</span> e_name<span class="operator">=</span><span class="string">&#x27;Jack&#x27;</span>\G</span><br><span class="line"><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span> <span class="number">1.</span> <span class="type">row</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">           id: <span class="number">1</span></span><br><span class="line">  select_type: SIMPLE</span><br><span class="line">        <span class="keyword">table</span>: emp</span><br><span class="line">   partitions: <span class="keyword">NULL</span></span><br><span class="line">         type: <span class="keyword">ref</span></span><br><span class="line">possible_keys: dept_id,idx_ename</span><br><span class="line">          key: idx_ename</span><br><span class="line">      key_len: <span class="number">81</span></span><br><span class="line">          <span class="keyword">ref</span>: const</span><br><span class="line"><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span> <span class="number">2.</span> <span class="type">row</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">           id: <span class="number">1</span></span><br><span class="line">  select_type: SIMPLE</span><br><span class="line">        <span class="keyword">table</span>: dept</span><br><span class="line">   partitions: <span class="keyword">NULL</span></span><br><span class="line">         type: eq_ref</span><br><span class="line">possible_keys: <span class="keyword">PRIMARY</span></span><br><span class="line">          key: <span class="keyword">PRIMARY</span></span><br><span class="line">      key_len: <span class="number">4</span></span><br><span class="line">          <span class="keyword">ref</span>: wanggx.emp.dept_id</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h4 id="11、filtered"><a href="#11、filtered" class="headerlink" title="11、filtered"></a>11、filtered</h4><p>表示选取的行和读取的行的百分比，100表示选取了100%，80表示读取了80%。例如：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> explain <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">where</span> phone <span class="operator">=</span> <span class="string">&#x27;13703735488&#x27;</span>\G</span><br><span class="line"><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span> <span class="number">1.</span> <span class="type">row</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">           id: <span class="number">1</span></span><br><span class="line">  select_type: SIMPLE</span><br><span class="line">        <span class="keyword">table</span>: emp</span><br><span class="line">   partitions: <span class="keyword">NULL</span></span><br><span class="line">         type: const</span><br><span class="line">possible_keys: uq_idx_phone</span><br><span class="line">          key: uq_idx_phone</span><br><span class="line">      key_len: <span class="number">81</span></span><br><span class="line">          <span class="keyword">ref</span>: const</span><br><span class="line">         <span class="keyword">rows</span>: <span class="number">1</span></span><br><span class="line">     filtered: <span class="number">100.00</span></span><br><span class="line">        Extra: <span class="keyword">NULL</span></span><br><span class="line"><span class="number">1</span> <span class="type">row</span> <span class="keyword">in</span> <span class="keyword">set</span>, <span class="number">1</span> warning (<span class="number">0.01</span> sec)</span><br><span class="line"><span class="comment">--根据phone创建了唯一索引，并且条件是等号（=），因此filtered为100%</span></span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> explain <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">where</span> salary <span class="operator">=</span> <span class="number">5200</span>\G</span><br><span class="line"><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span> <span class="number">1.</span> <span class="type">row</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">           id: <span class="number">1</span></span><br><span class="line">  select_type: SIMPLE</span><br><span class="line">        <span class="keyword">table</span>: emp</span><br><span class="line">   partitions: <span class="keyword">NULL</span></span><br><span class="line">         type: <span class="keyword">ALL</span></span><br><span class="line">possible_keys: <span class="keyword">NULL</span></span><br><span class="line">          key: <span class="keyword">NULL</span></span><br><span class="line">      key_len: <span class="keyword">NULL</span></span><br><span class="line">          <span class="keyword">ref</span>: <span class="keyword">NULL</span></span><br><span class="line">         <span class="keyword">rows</span>: <span class="number">2</span></span><br><span class="line">     filtered: <span class="number">50.00</span></span><br><span class="line">        Extra: <span class="keyword">Using</span> <span class="keyword">where</span></span><br><span class="line"><span class="number">1</span> <span class="type">row</span> <span class="keyword">in</span> <span class="keyword">set</span>, <span class="number">1</span> warning (<span class="number">0.00</span> sec)</span><br><span class="line"><span class="comment">--由于salary字段没有创建索引，因此执行全表扫描，filtered为50%</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h4 id="10、rows"><a href="#10、rows" class="headerlink" title="10、rows"></a>10、rows</h4><p>根据表统计信息及索引选用情况大致估算出找到所需记录所要读取的行数。当然该值越小越好。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> explain <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">where</span> salary<span class="operator">=</span><span class="number">5000</span>\G</span><br><span class="line"><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span> <span class="number">1.</span> <span class="type">row</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">           id: <span class="number">1</span></span><br><span class="line">  select_type: SIMPLE</span><br><span class="line">        <span class="keyword">table</span>: emp</span><br><span class="line">   partitions: <span class="keyword">NULL</span></span><br><span class="line">         type: <span class="keyword">ALL</span></span><br><span class="line">possible_keys: <span class="keyword">NULL</span></span><br><span class="line">          key: <span class="keyword">NULL</span></span><br><span class="line">      key_len: <span class="keyword">NULL</span></span><br><span class="line">          <span class="keyword">ref</span>: <span class="keyword">NULL</span></span><br><span class="line">         <span class="keyword">rows</span>: <span class="number">3</span></span><br><span class="line">     filtered: <span class="number">33.33</span></span><br><span class="line">        Extra: <span class="keyword">Using</span> <span class="keyword">where</span></span><br><span class="line"><span class="number">1</span> <span class="type">row</span> <span class="keyword">in</span> <span class="keyword">set</span>, <span class="number">1</span> warning (<span class="number">0.00</span> sec)</span><br><span class="line"><span class="comment">--没有使用索引，需要进行全表扫描，一共读取3行</span></span><br><span class="line">mysql<span class="operator">&gt;</span> explain <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">where</span> dept_id<span class="operator">=</span><span class="number">11</span>\G</span><br><span class="line"><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span> <span class="number">1.</span> <span class="type">row</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">           id: <span class="number">1</span></span><br><span class="line">  select_type: SIMPLE</span><br><span class="line">        <span class="keyword">table</span>: emp</span><br><span class="line">   partitions: <span class="keyword">NULL</span></span><br><span class="line">         type: <span class="keyword">ref</span></span><br><span class="line">possible_keys: dept_id</span><br><span class="line">          key: dept_id</span><br><span class="line">      key_len: <span class="number">5</span></span><br><span class="line">          <span class="keyword">ref</span>: const</span><br><span class="line">         <span class="keyword">rows</span>: <span class="number">2</span></span><br><span class="line">     filtered: <span class="number">100.00</span></span><br><span class="line">        Extra: <span class="keyword">NULL</span></span><br><span class="line"><span class="number">1</span> <span class="type">row</span> <span class="keyword">in</span> <span class="keyword">set</span>, <span class="number">1</span> warning (<span class="number">0.00</span> sec)</span><br><span class="line"><span class="comment">--使用了索引，扫描2行</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h4 id="12、extra"><a href="#12、extra" class="headerlink" title="12、extra"></a>12、extra</h4><p>显示一些重要的额外信息。一般有以下几项：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br></pre></td><td class="code"><pre><span class="line">（<span class="number">1</span>）<span class="keyword">Using</span> filesort：对数据使用一个外部的索引排序，而不是按照表内的索引顺序进行读取。当Query中包含 <span class="keyword">order</span> <span class="keyword">by</span> 操作，而且无法利用索引完成的排序操作称为“文件排序”。</span><br><span class="line">例如：</span><br><span class="line">mysql<span class="operator">&gt;</span> explain <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">order</span> <span class="keyword">by</span> salary\G</span><br><span class="line"><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span> <span class="number">1.</span> <span class="type">row</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">           id: <span class="number">1</span></span><br><span class="line">  select_type: SIMPLE</span><br><span class="line">        <span class="keyword">table</span>: emp</span><br><span class="line">   partitions: <span class="keyword">NULL</span></span><br><span class="line">         type: <span class="keyword">ALL</span></span><br><span class="line">possible_keys: <span class="keyword">NULL</span></span><br><span class="line">          key: <span class="keyword">NULL</span></span><br><span class="line">      key_len: <span class="keyword">NULL</span></span><br><span class="line">          <span class="keyword">ref</span>: <span class="keyword">NULL</span></span><br><span class="line">         <span class="keyword">rows</span>: <span class="number">2</span></span><br><span class="line">     filtered: <span class="number">100.00</span></span><br><span class="line">        Extra: <span class="keyword">Using</span> filesort</span><br><span class="line"><span class="number">1</span> <span class="type">row</span> <span class="keyword">in</span> <span class="keyword">set</span>, <span class="number">1</span> warning (<span class="number">0.01</span> sec)</span><br><span class="line">（<span class="number">2</span>）<span class="keyword">Using</span> temporary：表示MySQL需要使用临时表来存储结果集，常见于排序和分组查询，常见 <span class="keyword">group</span> <span class="keyword">by</span> 与 <span class="keyword">order</span> <span class="keyword">by</span>。</span><br><span class="line">例如：</span><br><span class="line">mysql<span class="operator">&gt;</span> explain <span class="keyword">select</span> <span class="built_in">count</span>(<span class="operator">*</span>) <span class="keyword">from</span> emp <span class="keyword">group</span> <span class="keyword">by</span> salary\G</span><br><span class="line"><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span> <span class="number">1.</span> <span class="type">row</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">           id: <span class="number">1</span></span><br><span class="line">  select_type: SIMPLE</span><br><span class="line">        <span class="keyword">table</span>: emp</span><br><span class="line">   partitions: <span class="keyword">NULL</span></span><br><span class="line">         type: <span class="keyword">ALL</span></span><br><span class="line">possible_keys: <span class="keyword">NULL</span></span><br><span class="line">          key: <span class="keyword">NULL</span></span><br><span class="line">      key_len: <span class="keyword">NULL</span></span><br><span class="line">          <span class="keyword">ref</span>: <span class="keyword">NULL</span></span><br><span class="line">         <span class="keyword">rows</span>: <span class="number">2</span></span><br><span class="line">     filtered: <span class="number">100.00</span></span><br><span class="line">        Extra: <span class="keyword">Using</span> temporary; <span class="keyword">Using</span> filesort</span><br><span class="line"><span class="number">1</span> <span class="type">row</span> <span class="keyword">in</span> <span class="keyword">set</span>, <span class="number">1</span> warning (<span class="number">0.00</span> sec)</span><br><span class="line">（<span class="number">3</span>）<span class="keyword">Using</span> index：表明相应的<span class="keyword">select</span>操作中使用了覆盖索引（<span class="keyword">select</span>的数据列只从索引中就能取得数据，不必读取数据行）。</span><br><span class="line">mysql<span class="operator">&gt;</span> explain <span class="keyword">select</span> e_name,salary <span class="keyword">from</span> emp <span class="keyword">order</span> <span class="keyword">by</span> e_name\G</span><br><span class="line"><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span> <span class="number">1.</span> <span class="type">row</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">           id: <span class="number">1</span></span><br><span class="line">  select_type: SIMPLE</span><br><span class="line">        <span class="keyword">table</span>: emp</span><br><span class="line">   partitions: <span class="keyword">NULL</span></span><br><span class="line">         type: <span class="keyword">ALL</span></span><br><span class="line">possible_keys: <span class="keyword">NULL</span></span><br><span class="line">          key: <span class="keyword">NULL</span></span><br><span class="line">      key_len: <span class="keyword">NULL</span></span><br><span class="line">          <span class="keyword">ref</span>: <span class="keyword">NULL</span></span><br><span class="line">         <span class="keyword">rows</span>: <span class="number">2</span></span><br><span class="line">     filtered: <span class="number">100.00</span></span><br><span class="line">        Extra: <span class="keyword">Using</span> filesort</span><br><span class="line"><span class="number">1</span> <span class="type">row</span> <span class="keyword">in</span> <span class="keyword">set</span>, <span class="number">1</span> warning (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> explain <span class="keyword">select</span> e_name <span class="keyword">from</span> emp <span class="keyword">order</span> <span class="keyword">by</span> e_name\G</span><br><span class="line"><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span> <span class="number">1.</span> <span class="type">row</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">           id: <span class="number">1</span></span><br><span class="line">  select_type: SIMPLE</span><br><span class="line">        <span class="keyword">table</span>: emp</span><br><span class="line">   partitions: <span class="keyword">NULL</span></span><br><span class="line">         type: index</span><br><span class="line">possible_keys: <span class="keyword">NULL</span></span><br><span class="line">          key: idx_ename</span><br><span class="line">      key_len: <span class="number">81</span></span><br><span class="line">          <span class="keyword">ref</span>: <span class="keyword">NULL</span></span><br><span class="line">         <span class="keyword">rows</span>: <span class="number">2</span></span><br><span class="line">     filtered: <span class="number">100.00</span></span><br><span class="line">        Extra: <span class="keyword">Using</span> index</span><br><span class="line"><span class="number">1</span> <span class="type">row</span> <span class="keyword">in</span> <span class="keyword">set</span>, <span class="number">1</span> warning (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">（<span class="number">4</span>）<span class="keyword">Using</span> <span class="keyword">join</span> buffer：表明在获取连接条件时没有使用索引，并且需要连接缓冲区来存储中间结果。如果出现了这个值，应注意根据查询的具体情况可能需要添加索引来改进能。</span><br><span class="line">例如：</span><br><span class="line">mysql<span class="operator">&gt;</span> explain <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">join</span> dept <span class="keyword">on</span> emp.dept_id<span class="operator">=</span>dept.dept_id\G</span><br><span class="line"><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span> <span class="number">1.</span> <span class="type">row</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">           id: <span class="number">1</span></span><br><span class="line">  select_type: SIMPLE</span><br><span class="line">        <span class="keyword">table</span>: dept</span><br><span class="line">   partitions: <span class="keyword">NULL</span></span><br><span class="line">         type: <span class="keyword">ALL</span></span><br><span class="line">possible_keys: <span class="keyword">PRIMARY</span></span><br><span class="line">          key: <span class="keyword">NULL</span></span><br><span class="line">      key_len: <span class="keyword">NULL</span></span><br><span class="line">          <span class="keyword">ref</span>: <span class="keyword">NULL</span></span><br><span class="line">         <span class="keyword">rows</span>: <span class="number">2</span></span><br><span class="line">     filtered: <span class="number">100.00</span></span><br><span class="line">        Extra: <span class="keyword">NULL</span></span><br><span class="line"><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span> <span class="number">2.</span> <span class="type">row</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">           id: <span class="number">1</span></span><br><span class="line">  select_type: SIMPLE</span><br><span class="line">        <span class="keyword">table</span>: emp</span><br><span class="line">   partitions: <span class="keyword">NULL</span></span><br><span class="line">         type: <span class="keyword">ALL</span></span><br><span class="line">possible_keys: dept_id</span><br><span class="line">          key: <span class="keyword">NULL</span></span><br><span class="line">      key_len: <span class="keyword">NULL</span></span><br><span class="line">          <span class="keyword">ref</span>: <span class="keyword">NULL</span></span><br><span class="line">         <span class="keyword">rows</span>: <span class="number">2</span></span><br><span class="line">     filtered: <span class="number">100.00</span></span><br><span class="line">        Extra: <span class="keyword">Using</span> <span class="keyword">where</span>; <span class="keyword">Using</span> <span class="keyword">join</span> buffer (Block Nested Loop)</span><br><span class="line"><span class="number">2</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span>, <span class="number">1</span> warning (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="select-查询之-select-语法"><a href="#select-查询之-select-语法" class="headerlink" title="select 查询之 select 语法"></a>select 查询之 select 语法</h1><h2 id="一、SELECT-语句的语法"><a href="#一、SELECT-语句的语法" class="headerlink" title="一、SELECT 语句的语法"></a>一、SELECT 语句的语法</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span></span><br><span class="line">    <span class="operator">&lt;</span>字段或表达式列表<span class="operator">&gt;</span></span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">    <span class="operator">&lt;</span>表名<span class="operator">&gt;</span> <span class="operator">&lt;</span>连接类型<span class="operator">&gt;</span></span><br><span class="line"><span class="keyword">JOIN</span> <span class="operator">&lt;</span>表名<span class="operator">&gt;</span> <span class="keyword">ON</span> <span class="operator">&lt;</span>连接条件<span class="operator">&gt;</span></span><br><span class="line"><span class="keyword">WHERE</span></span><br><span class="line">    <span class="operator">&lt;</span>筛选条件<span class="operator">&gt;</span></span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span></span><br><span class="line">    <span class="operator">&lt;</span>分组字段列表<span class="operator">&gt;</span></span><br><span class="line"><span class="keyword">HAVING</span></span><br><span class="line">    <span class="operator">&lt;</span>分组筛选条件<span class="operator">&gt;</span></span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span></span><br><span class="line">    <span class="operator">&lt;</span>排序字段<span class="operator">&gt;</span></span><br><span class="line">LIMIT <span class="operator">&lt;</span>m,n<span class="operator">&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="二、SELECT-语句各部分的说明"><a href="#二、SELECT-语句各部分的说明" class="headerlink" title="二、SELECT 语句各部分的说明"></a>二、SELECT 语句各部分的说明</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>、<span class="keyword">DISTINCT</span>：消除重复行。</span><br><span class="line"><span class="number">2</span>、<span class="operator">&lt;</span>字段或表达式列表<span class="operator">&gt;</span>：表示所要查询字段的名称，可以使用（<span class="operator">*</span>）表示所有字段。</span><br><span class="line"><span class="number">3</span>、<span class="operator">&lt;</span>连接类型<span class="operator">&gt;</span>：可以使用 <span class="keyword">inner</span>，<span class="keyword">left</span>，<span class="keyword">right</span> 分别表示内连接，左连接，右连接。</span><br><span class="line"><span class="number">4</span>、<span class="operator">&lt;</span>连接条件<span class="operator">&gt;</span>：一般使用两个表的共同字段进行构造连接条件。</span><br><span class="line"><span class="number">5</span>、<span class="operator">&lt;</span>筛选条件<span class="operator">&gt;</span>：限定查询数据必须满足该查询条件。</span><br><span class="line"><span class="number">6</span>、<span class="operator">&lt;</span>分组字段列表<span class="operator">&gt;</span>：按照指定的字段分组。</span><br><span class="line"><span class="number">7</span>、<span class="operator">&lt;</span>分组筛选条件<span class="operator">&gt;</span>：对分组进行筛选。</span><br><span class="line"><span class="number">8</span>、<span class="operator">&lt;</span>排序字段<span class="operator">&gt;</span>：对查询结果进行排序，可以进行升序（<span class="keyword">ASC</span>）和降序（<span class="keyword">DESC</span>）排列，默认是升序。</span><br><span class="line"><span class="number">9</span>、LIMIT <span class="operator">&lt;</span>m,n<span class="operator">&gt;</span>：分页显示数据。</span><br></pre></td></tr></table></figure>

<h2 id="利用字段名、运算符和函数构造表达式"><a href="#利用字段名、运算符和函数构造表达式" class="headerlink" title="利用字段名、运算符和函数构造表达式"></a>利用字段名、<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=%E8%BF%90%E7%AE%97%E7%AC%A6&spm=1001.2101.3001.7020">运算符</a>和函数构造表达式</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span></span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> stu_name,</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> birth,</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">year</span>(now())<span class="operator">-</span><span class="keyword">year</span>(birth)</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">FROM</span> </span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> stu;</span><br><span class="line"><span class="operator">+</span><span class="comment">-----------+---------------------+-------------------------+</span></span><br><span class="line"><span class="operator">|</span> stu_name  <span class="operator">|</span> birth               <span class="operator">|</span> <span class="keyword">year</span>(now())<span class="operator">-</span><span class="keyword">year</span>(birth) <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-----------+---------------------+-------------------------+</span></span><br><span class="line"><span class="operator">|</span> 王占峰    <span class="operator">|</span> <span class="number">1999</span><span class="number">-12</span><span class="number">-30</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> <span class="operator">|</span>                      <span class="number">21</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> 刘国量    <span class="operator">|</span> <span class="number">2000</span><span class="number">-08</span><span class="number">-14</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> <span class="operator">|</span>                      <span class="number">20</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> 巩莉      <span class="operator">|</span> <span class="number">2000</span><span class="number">-06</span><span class="number">-18</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> <span class="operator">|</span>                      <span class="number">20</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> 宋丹风    <span class="operator">|</span> <span class="number">1999</span><span class="number">-11</span><span class="number">-20</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> <span class="operator">|</span>                      <span class="number">21</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> 王艳艳    <span class="operator">|</span> <span class="number">1999</span><span class="number">-09</span><span class="number">-30</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> <span class="operator">|</span>                      <span class="number">21</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> 赵牡丹    <span class="operator">|</span> <span class="number">2001</span><span class="number">-08</span><span class="number">-10</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> <span class="operator">|</span>                      <span class="number">19</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> 王大强    <span class="operator">|</span> <span class="number">2000</span><span class="number">-10</span><span class="number">-19</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> <span class="operator">|</span>                      <span class="number">20</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> 王宏伟    <span class="operator">|</span> <span class="number">2001</span><span class="number">-02</span><span class="number">-15</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> <span class="operator">|</span>                      <span class="number">19</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> 张静静    <span class="operator">|</span> <span class="number">2001</span><span class="number">-08</span><span class="number">-17</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> <span class="operator">|</span>                      <span class="number">19</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> 李刚      <span class="operator">|</span> <span class="number">2000</span><span class="number">-12</span><span class="number">-25</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> <span class="operator">|</span>                      <span class="number">20</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> 刘鹏      <span class="operator">|</span> <span class="number">2001</span><span class="number">-12</span><span class="number">-18</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> <span class="operator">|</span>                      <span class="number">19</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-----------+---------------------+-------------------------+</span></span><br><span class="line"><span class="number">11</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line"><span class="comment">--说明：本查询使用了两个函数 now()和year() 以及算数运算符（-）对字段 birth 进行运算，得到学生的年龄。</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="为字段和表达式指定别名"><a href="#为字段和表达式指定别名" class="headerlink" title="为字段和表达式指定别名"></a>为字段和表达式指定别名</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span></span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> stu_name,</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> birth,</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">year</span>(now())<span class="operator">-</span><span class="keyword">year</span>(birth) <span class="keyword">as</span> age</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">FROM</span> </span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> stu;</span><br><span class="line"><span class="operator">+</span><span class="comment">-----------+---------------------+------+</span></span><br><span class="line"><span class="operator">|</span> stu_name  <span class="operator">|</span> birth               <span class="operator">|</span> age  <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-----------+---------------------+------+</span></span><br><span class="line"><span class="operator">|</span> 王占峰    <span class="operator">|</span> <span class="number">1999</span><span class="number">-12</span><span class="number">-30</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> <span class="operator">|</span>   <span class="number">21</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> 刘国量    <span class="operator">|</span> <span class="number">2000</span><span class="number">-08</span><span class="number">-14</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> <span class="operator">|</span>   <span class="number">20</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> 巩莉      <span class="operator">|</span> <span class="number">2000</span><span class="number">-06</span><span class="number">-18</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> <span class="operator">|</span>   <span class="number">20</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> 宋丹风    <span class="operator">|</span> <span class="number">1999</span><span class="number">-11</span><span class="number">-20</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> <span class="operator">|</span>   <span class="number">21</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> 王艳艳    <span class="operator">|</span> <span class="number">1999</span><span class="number">-09</span><span class="number">-30</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> <span class="operator">|</span>   <span class="number">21</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> 赵牡丹    <span class="operator">|</span> <span class="number">2001</span><span class="number">-08</span><span class="number">-10</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> <span class="operator">|</span>   <span class="number">19</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> 王大强    <span class="operator">|</span> <span class="number">2000</span><span class="number">-10</span><span class="number">-19</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> <span class="operator">|</span>   <span class="number">20</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> 王宏伟    <span class="operator">|</span> <span class="number">2001</span><span class="number">-02</span><span class="number">-15</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> <span class="operator">|</span>   <span class="number">19</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> 张静静    <span class="operator">|</span> <span class="number">2001</span><span class="number">-08</span><span class="number">-17</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> <span class="operator">|</span>   <span class="number">19</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> 李刚      <span class="operator">|</span> <span class="number">2000</span><span class="number">-12</span><span class="number">-25</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> <span class="operator">|</span>   <span class="number">20</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> 刘鹏      <span class="operator">|</span> <span class="number">2001</span><span class="number">-12</span><span class="number">-18</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> <span class="operator">|</span>   <span class="number">19</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-----------+---------------------+------+</span></span><br><span class="line"><span class="number">11</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span></span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> stu_name,</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> birth,</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">year</span>(now())<span class="operator">-</span><span class="keyword">year</span>(birth) age</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">FROM</span> </span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> stu;</span><br><span class="line"><span class="operator">+</span><span class="comment">-----------+---------------------+------+</span></span><br><span class="line"><span class="operator">|</span> stu_name  <span class="operator">|</span> birth               <span class="operator">|</span> age  <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-----------+---------------------+------+</span></span><br><span class="line"><span class="operator">|</span> 王占峰    <span class="operator">|</span> <span class="number">1999</span><span class="number">-12</span><span class="number">-30</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> <span class="operator">|</span>   <span class="number">21</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> 刘国量    <span class="operator">|</span> <span class="number">2000</span><span class="number">-08</span><span class="number">-14</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> <span class="operator">|</span>   <span class="number">20</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> 巩莉      <span class="operator">|</span> <span class="number">2000</span><span class="number">-06</span><span class="number">-18</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> <span class="operator">|</span>   <span class="number">20</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> 宋丹风    <span class="operator">|</span> <span class="number">1999</span><span class="number">-11</span><span class="number">-20</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> <span class="operator">|</span>   <span class="number">21</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> 王艳艳    <span class="operator">|</span> <span class="number">1999</span><span class="number">-09</span><span class="number">-30</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> <span class="operator">|</span>   <span class="number">21</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> 赵牡丹    <span class="operator">|</span> <span class="number">2001</span><span class="number">-08</span><span class="number">-10</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> <span class="operator">|</span>   <span class="number">19</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> 王大强    <span class="operator">|</span> <span class="number">2000</span><span class="number">-10</span><span class="number">-19</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> <span class="operator">|</span>   <span class="number">20</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> 王宏伟    <span class="operator">|</span> <span class="number">2001</span><span class="number">-02</span><span class="number">-15</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> <span class="operator">|</span>   <span class="number">19</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> 张静静    <span class="operator">|</span> <span class="number">2001</span><span class="number">-08</span><span class="number">-17</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> <span class="operator">|</span>   <span class="number">19</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> 李刚      <span class="operator">|</span> <span class="number">2000</span><span class="number">-12</span><span class="number">-25</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> <span class="operator">|</span>   <span class="number">20</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> 刘鹏      <span class="operator">|</span> <span class="number">2001</span><span class="number">-12</span><span class="number">-18</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> <span class="operator">|</span>   <span class="number">19</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-----------+---------------------+------+</span></span><br><span class="line"><span class="number">11</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.01</span> sec)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="使用-distinct-参数对查询结果去重"><a href="#使用-distinct-参数对查询结果去重" class="headerlink" title="使用 distinct 参数对查询结果去重"></a>使用 distinct 参数对查询结果去重</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 查询有学生的系的系名</span></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span></span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> dept_name</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">FROM</span> </span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> dept d <span class="keyword">inner</span> <span class="keyword">join</span> stu s <span class="keyword">on</span> d.dept_id <span class="operator">=</span> s.dept_id;</span><br><span class="line"><span class="operator">+</span><span class="comment">--------------+</span></span><br><span class="line"><span class="operator">|</span> dept_name    <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------------+</span></span><br><span class="line"><span class="operator">|</span> 管理系       <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> 计算机系     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> 数学系       <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------------+</span></span><br><span class="line"><span class="number">3</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="select-查询之查询条件"><a href="#select-查询之查询条件" class="headerlink" title="select 查询之查询条件"></a>select 查询之查询条件</h1><p>convert</p>
<h2 id="Order-by"><a href="#Order-by" class="headerlink" title="Order by"></a>Order by</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span></span><br><span class="line">字段名或表达式 [<span class="keyword">DESC</span>] [,...]</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span></span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="operator">*</span></span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">FROM</span></span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> stu</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">ORDER</span> <span class="keyword">BY</span></span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">convert</span>(stu_name <span class="keyword">using</span> gbk);</span><br><span class="line"><span class="operator">+</span><span class="comment">-----------+-----------+--------+---------------------+--------+-------------+---------+</span></span><br><span class="line"><span class="operator">|</span> stu_id    <span class="operator">|</span> stu_name  <span class="operator">|</span> gender <span class="operator">|</span> birth               <span class="operator">|</span> height <span class="operator">|</span> phone       <span class="operator">|</span> dept_id <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-----------+-----------+--------+---------------------+--------+-------------+---------+</span></span><br><span class="line"><span class="operator">|</span> <span class="number">201801103</span> <span class="operator">|</span> 巩莉      <span class="operator">|</span> 女     <span class="operator">|</span> <span class="number">2000</span><span class="number">-06</span><span class="number">-18</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> <span class="operator">|</span>  <span class="number">170.0</span> <span class="operator">|</span> <span class="number">15937320456</span> <span class="operator">|</span> D02     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">201901004</span> <span class="operator">|</span> 李刚      <span class="operator">|</span> 男     <span class="operator">|</span> <span class="number">2000</span><span class="number">-12</span><span class="number">-25</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> <span class="operator">|</span>  <span class="number">178.0</span> <span class="operator">|</span> <span class="number">15937320321</span> <span class="operator">|</span> D01     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">201801102</span> <span class="operator">|</span> 刘国强    <span class="operator">|</span> 男     <span class="operator">|</span> <span class="number">2000</span><span class="number">-08</span><span class="number">-14</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> <span class="operator">|</span>  <span class="number">174.0</span> <span class="operator">|</span> <span class="number">15937320789</span> <span class="operator">|</span> D02     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">201901005</span> <span class="operator">|</span> 刘鹏      <span class="operator">|</span> 男     <span class="operator">|</span> <span class="number">2001</span><span class="number">-12</span><span class="number">-18</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> <span class="operator">|</span>  <span class="number">176.0</span> <span class="operator">|</span> <span class="keyword">NULL</span>        <span class="operator">|</span> D01     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">201801104</span> <span class="operator">|</span> 宋丹风    <span class="operator">|</span> 女     <span class="operator">|</span> <span class="number">1999</span><span class="number">-11</span><span class="number">-20</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> <span class="operator">|</span>  <span class="number">165.0</span> <span class="operator">|</span> <span class="number">15937320444</span> <span class="operator">|</span> D02     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">201901002</span> <span class="operator">|</span> 王宏伟    <span class="operator">|</span> 男     <span class="operator">|</span> <span class="number">2001</span><span class="number">-02</span><span class="number">-15</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> <span class="operator">|</span>  <span class="number">180.0</span> <span class="operator">|</span> <span class="number">15937320255</span> <span class="operator">|</span> D01     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">201801203</span> <span class="operator">|</span> 王鹏飞    <span class="operator">|</span> 男     <span class="operator">|</span> <span class="number">2000</span><span class="number">-10</span><span class="number">-19</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> <span class="operator">|</span>  <span class="number">174.0</span> <span class="operator">|</span> <span class="number">15937320555</span> <span class="operator">|</span> D03     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">201801201</span> <span class="operator">|</span> 王艳艳    <span class="operator">|</span> 女     <span class="operator">|</span> <span class="number">1999</span><span class="number">-09</span><span class="number">-30</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> <span class="operator">|</span>  <span class="number">162.0</span> <span class="operator">|</span> <span class="keyword">NULL</span>        <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">201801101</span> <span class="operator">|</span> 王占峰    <span class="operator">|</span> 男     <span class="operator">|</span> <span class="number">1999</span><span class="number">-12</span><span class="number">-30</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> <span class="operator">|</span>  <span class="number">177.0</span> <span class="operator">|</span> <span class="number">15937320987</span> <span class="operator">|</span> D02     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">201901003</span> <span class="operator">|</span> 张静静    <span class="operator">|</span> 女     <span class="operator">|</span> <span class="number">2001</span><span class="number">-08</span><span class="number">-17</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> <span class="operator">|</span>  <span class="number">167.0</span> <span class="operator">|</span> <span class="number">15937320123</span> <span class="operator">|</span> D01     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">201801202</span> <span class="operator">|</span> 赵牡丹    <span class="operator">|</span> 女     <span class="operator">|</span> <span class="number">2001</span><span class="number">-08</span><span class="number">-10</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> <span class="operator">|</span>  <span class="number">160.0</span> <span class="operator">|</span> <span class="number">15937320666</span> <span class="operator">|</span> D03     <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-----------+-----------+--------+---------------------+--------+-------------+---------+</span></span><br><span class="line"><span class="number">11</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.05</span> sec)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span></span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="operator">*</span></span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">FROM</span></span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> stu</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">WHERE</span></span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> dept_id <span class="operator">=</span> <span class="string">&#x27;D01&#x27;</span></span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">ORDER</span> <span class="keyword">BY</span></span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> height <span class="keyword">DESC</span>;</span><br><span class="line"><span class="operator">+</span><span class="comment">-----------+-----------+--------+---------------------+--------+-------------+---------+</span></span><br><span class="line"><span class="operator">|</span> stu_id    <span class="operator">|</span> stu_name  <span class="operator">|</span> gender <span class="operator">|</span> birth               <span class="operator">|</span> height <span class="operator">|</span> phone       <span class="operator">|</span> dept_id <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-----------+-----------+--------+---------------------+--------+-------------+---------+</span></span><br><span class="line"><span class="operator">|</span> <span class="number">201901002</span> <span class="operator">|</span> 王宏伟    <span class="operator">|</span> 男     <span class="operator">|</span> <span class="number">2001</span><span class="number">-02</span><span class="number">-15</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> <span class="operator">|</span>  <span class="number">180.0</span> <span class="operator">|</span> <span class="number">15937320255</span> <span class="operator">|</span> D01     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">201901004</span> <span class="operator">|</span> 李刚      <span class="operator">|</span> 男     <span class="operator">|</span> <span class="number">2000</span><span class="number">-12</span><span class="number">-25</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> <span class="operator">|</span>  <span class="number">178.0</span> <span class="operator">|</span> <span class="number">15937320321</span> <span class="operator">|</span> D01     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">201901005</span> <span class="operator">|</span> 刘鹏      <span class="operator">|</span> 男     <span class="operator">|</span> <span class="number">2001</span><span class="number">-12</span><span class="number">-18</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> <span class="operator">|</span>  <span class="number">176.0</span> <span class="operator">|</span> <span class="keyword">NULL</span>        <span class="operator">|</span> D01     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">201901003</span> <span class="operator">|</span> 张静静    <span class="operator">|</span> 女     <span class="operator">|</span> <span class="number">2001</span><span class="number">-08</span><span class="number">-17</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> <span class="operator">|</span>  <span class="number">167.0</span> <span class="operator">|</span> <span class="number">15937320123</span> <span class="operator">|</span> D01     <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-----------+-----------+--------+---------------------+--------+-------------+---------+</span></span><br><span class="line"><span class="number">4</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.02</span> sec)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="查询所有学生的信息，并且按学生的年龄排序"><a href="#查询所有学生的信息，并且按学生的年龄排序" class="headerlink" title="查询所有学生的信息，并且按学生的年龄排序"></a>查询所有学生的信息，并且按学生的年龄排序</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span></span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> stu_id,</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> stu_name,</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> birth,</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">year</span>(now())<span class="operator">-</span><span class="keyword">year</span>(birth) <span class="keyword">as</span> age</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">FROM</span> </span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> stu</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="number">4</span>;</span><br><span class="line"><span class="operator">+</span><span class="comment">-----------+-----------+---------------------+------+</span></span><br><span class="line"><span class="operator">|</span> stu_id    <span class="operator">|</span> stu_name  <span class="operator">|</span> birth               <span class="operator">|</span> age  <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-----------+-----------+---------------------+------+</span></span><br><span class="line"><span class="operator">|</span> <span class="number">201801202</span> <span class="operator">|</span> 赵牡丹    <span class="operator">|</span> <span class="number">2001</span><span class="number">-08</span><span class="number">-10</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> <span class="operator">|</span>   <span class="number">19</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">201901002</span> <span class="operator">|</span> 王宏伟    <span class="operator">|</span> <span class="number">2001</span><span class="number">-02</span><span class="number">-15</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> <span class="operator">|</span>   <span class="number">19</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">201901003</span> <span class="operator">|</span> 张静静    <span class="operator">|</span> <span class="number">2001</span><span class="number">-08</span><span class="number">-17</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> <span class="operator">|</span>   <span class="number">19</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">201901005</span> <span class="operator">|</span> 刘鹏      <span class="operator">|</span> <span class="number">2001</span><span class="number">-12</span><span class="number">-18</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> <span class="operator">|</span>   <span class="number">19</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">201801102</span> <span class="operator">|</span> 刘国强    <span class="operator">|</span> <span class="number">2000</span><span class="number">-08</span><span class="number">-14</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> <span class="operator">|</span>   <span class="number">20</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">201801103</span> <span class="operator">|</span> 巩莉      <span class="operator">|</span> <span class="number">2000</span><span class="number">-06</span><span class="number">-18</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> <span class="operator">|</span>   <span class="number">20</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">201801203</span> <span class="operator">|</span> 王鹏飞    <span class="operator">|</span> <span class="number">2000</span><span class="number">-10</span><span class="number">-19</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> <span class="operator">|</span>   <span class="number">20</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">201901004</span> <span class="operator">|</span> 李刚      <span class="operator">|</span> <span class="number">2000</span><span class="number">-12</span><span class="number">-25</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> <span class="operator">|</span>   <span class="number">20</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">201801101</span> <span class="operator">|</span> 王占峰    <span class="operator">|</span> <span class="number">1999</span><span class="number">-12</span><span class="number">-30</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> <span class="operator">|</span>   <span class="number">21</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">201801104</span> <span class="operator">|</span> 宋丹风    <span class="operator">|</span> <span class="number">1999</span><span class="number">-11</span><span class="number">-20</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> <span class="operator">|</span>   <span class="number">21</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">201801201</span> <span class="operator">|</span> 王艳艳    <span class="operator">|</span> <span class="number">1999</span><span class="number">-09</span><span class="number">-30</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> <span class="operator">|</span>   <span class="number">21</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-----------+-----------+---------------------+------+</span></span><br><span class="line"><span class="number">11</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span></span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> stu_id,</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> stu_name,</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> birth</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">FROM</span> </span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> stu</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="keyword">year</span>(now())<span class="operator">-</span><span class="keyword">year</span>(birth);</span><br><span class="line"><span class="operator">+</span><span class="comment">-----------+-----------+---------------------+</span></span><br><span class="line"><span class="operator">|</span> stu_id    <span class="operator">|</span> stu_name  <span class="operator">|</span> birth               <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-----------+-----------+---------------------+</span></span><br><span class="line"><span class="operator">|</span> <span class="number">201801202</span> <span class="operator">|</span> 赵牡丹    <span class="operator">|</span> <span class="number">2001</span><span class="number">-08</span><span class="number">-10</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">201901002</span> <span class="operator">|</span> 王宏伟    <span class="operator">|</span> <span class="number">2001</span><span class="number">-02</span><span class="number">-15</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">201901003</span> <span class="operator">|</span> 张静静    <span class="operator">|</span> <span class="number">2001</span><span class="number">-08</span><span class="number">-17</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">201901005</span> <span class="operator">|</span> 刘鹏      <span class="operator">|</span> <span class="number">2001</span><span class="number">-12</span><span class="number">-18</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">201801102</span> <span class="operator">|</span> 刘国强    <span class="operator">|</span> <span class="number">2000</span><span class="number">-08</span><span class="number">-14</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">201801103</span> <span class="operator">|</span> 巩莉      <span class="operator">|</span> <span class="number">2000</span><span class="number">-06</span><span class="number">-18</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">201801203</span> <span class="operator">|</span> 王鹏飞    <span class="operator">|</span> <span class="number">2000</span><span class="number">-10</span><span class="number">-19</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">201901004</span> <span class="operator">|</span> 李刚      <span class="operator">|</span> <span class="number">2000</span><span class="number">-12</span><span class="number">-25</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">201801101</span> <span class="operator">|</span> 王占峰    <span class="operator">|</span> <span class="number">1999</span><span class="number">-12</span><span class="number">-30</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">201801104</span> <span class="operator">|</span> 宋丹风    <span class="operator">|</span> <span class="number">1999</span><span class="number">-11</span><span class="number">-20</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">201801201</span> <span class="operator">|</span> 王艳艳    <span class="operator">|</span> <span class="number">1999</span><span class="number">-09</span><span class="number">-30</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-----------+-----------+---------------------+</span></span><br><span class="line"><span class="number">11</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>如果按多个字段排序，则先按第一个字段排序，然后针对第一个字段的重复记录再按第二个字段排序，以此类推。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span></span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="operator">*</span></span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">FROM</span> </span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> stu</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">ORDER</span> <span class="keyword">BY</span></span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> dept_id,height;</span><br><span class="line"><span class="operator">+</span><span class="comment">-----------+-----------+--------+---------------------+--------+-------------+---------+</span></span><br><span class="line"><span class="operator">|</span> stu_id    <span class="operator">|</span> stu_name  <span class="operator">|</span> gender <span class="operator">|</span> birth               <span class="operator">|</span> height <span class="operator">|</span> phone       <span class="operator">|</span> dept_id <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-----------+-----------+--------+---------------------+--------+-------------+---------+</span></span><br><span class="line"><span class="operator">|</span> <span class="number">201801201</span> <span class="operator">|</span> 王艳艳    <span class="operator">|</span> 女     <span class="operator">|</span> <span class="number">1999</span><span class="number">-09</span><span class="number">-30</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> <span class="operator">|</span>  <span class="number">162.0</span> <span class="operator">|</span> <span class="keyword">NULL</span>        <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">201901003</span> <span class="operator">|</span> 张静静    <span class="operator">|</span> 女     <span class="operator">|</span> <span class="number">2001</span><span class="number">-08</span><span class="number">-17</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> <span class="operator">|</span>  <span class="number">167.0</span> <span class="operator">|</span> <span class="number">15937320123</span> <span class="operator">|</span> D01     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">201901005</span> <span class="operator">|</span> 刘鹏      <span class="operator">|</span> 男     <span class="operator">|</span> <span class="number">2001</span><span class="number">-12</span><span class="number">-18</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> <span class="operator">|</span>  <span class="number">176.0</span> <span class="operator">|</span> <span class="keyword">NULL</span>        <span class="operator">|</span> D01     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">201901004</span> <span class="operator">|</span> 李刚      <span class="operator">|</span> 男     <span class="operator">|</span> <span class="number">2000</span><span class="number">-12</span><span class="number">-25</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> <span class="operator">|</span>  <span class="number">178.0</span> <span class="operator">|</span> <span class="number">15937320321</span> <span class="operator">|</span> D01     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">201901002</span> <span class="operator">|</span> 王宏伟    <span class="operator">|</span> 男     <span class="operator">|</span> <span class="number">2001</span><span class="number">-02</span><span class="number">-15</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> <span class="operator">|</span>  <span class="number">180.0</span> <span class="operator">|</span> <span class="number">15937320255</span> <span class="operator">|</span> D01     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">201801104</span> <span class="operator">|</span> 宋丹风    <span class="operator">|</span> 女     <span class="operator">|</span> <span class="number">1999</span><span class="number">-11</span><span class="number">-20</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> <span class="operator">|</span>  <span class="number">165.0</span> <span class="operator">|</span> <span class="number">15937320444</span> <span class="operator">|</span> D02     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">201801103</span> <span class="operator">|</span> 巩莉      <span class="operator">|</span> 女     <span class="operator">|</span> <span class="number">2000</span><span class="number">-06</span><span class="number">-18</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> <span class="operator">|</span>  <span class="number">170.0</span> <span class="operator">|</span> <span class="number">15937320456</span> <span class="operator">|</span> D02     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">201801102</span> <span class="operator">|</span> 刘国强    <span class="operator">|</span> 男     <span class="operator">|</span> <span class="number">2000</span><span class="number">-08</span><span class="number">-14</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> <span class="operator">|</span>  <span class="number">174.0</span> <span class="operator">|</span> <span class="number">15937320789</span> <span class="operator">|</span> D02     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">201801101</span> <span class="operator">|</span> 王占峰    <span class="operator">|</span> 男     <span class="operator">|</span> <span class="number">1999</span><span class="number">-12</span><span class="number">-30</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> <span class="operator">|</span>  <span class="number">177.0</span> <span class="operator">|</span> <span class="number">15937320987</span> <span class="operator">|</span> D02     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">201801202</span> <span class="operator">|</span> 赵牡丹    <span class="operator">|</span> 女     <span class="operator">|</span> <span class="number">2001</span><span class="number">-08</span><span class="number">-10</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> <span class="operator">|</span>  <span class="number">160.0</span> <span class="operator">|</span> <span class="number">15937320666</span> <span class="operator">|</span> D03     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">201801203</span> <span class="operator">|</span> 王鹏飞    <span class="operator">|</span> 男     <span class="operator">|</span> <span class="number">2000</span><span class="number">-10</span><span class="number">-19</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> <span class="operator">|</span>  <span class="number">174.0</span> <span class="operator">|</span> <span class="number">15937320555</span> <span class="operator">|</span> D03     <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-----------+-----------+--------+---------------------+--------+-------------+---------+</span></span><br><span class="line"><span class="number">11</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="limit"><a href="#limit" class="headerlink" title="limit"></a>limit</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">LIMIT [<span class="keyword">offset</span>,] <span class="keyword">rows</span></span><br><span class="line">或者</span><br><span class="line">LIMIT <span class="keyword">rows</span> <span class="keyword">OFFSET</span> <span class="keyword">offset</span>  </span><br><span class="line"></span><br><span class="line">说明：</span><br><span class="line">（<span class="number">1</span>）LIMIT 接受一个或两个整型数字参数。</span><br><span class="line">（<span class="number">2</span>）第一条记录的偏移量为 <span class="number">0</span>。</span><br><span class="line">（<span class="number">3</span>）如果给定两个参数，第一个参数指定第一个返回记录行的偏移量，第二个参数指定返回记录行的最大数目。</span><br><span class="line">（<span class="number">4</span>）如果只给定一个参数，则从第一条记录开始返回若干条记录。</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span></span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="operator">*</span></span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">FROM</span></span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> stu</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">ORDER</span> <span class="keyword">BY</span></span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> height <span class="keyword">DESC</span></span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> LIMIT <span class="number">3</span>,<span class="number">2</span>;</span><br><span class="line"><span class="operator">+</span><span class="comment">-----------+-----------+--------+---------------------+--------+-------------+---------+</span></span><br><span class="line"><span class="operator">|</span> stu_id    <span class="operator">|</span> stu_name  <span class="operator">|</span> gender <span class="operator">|</span> birth               <span class="operator">|</span> height <span class="operator">|</span> phone       <span class="operator">|</span> dept_id <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-----------+-----------+--------+---------------------+--------+-------------+---------+</span></span><br><span class="line"><span class="operator">|</span> <span class="number">201901005</span> <span class="operator">|</span> 刘鹏      <span class="operator">|</span> 男     <span class="operator">|</span> <span class="number">2001</span><span class="number">-12</span><span class="number">-18</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> <span class="operator">|</span>  <span class="number">176.0</span> <span class="operator">|</span> <span class="keyword">NULL</span>        <span class="operator">|</span> D01     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">201801102</span> <span class="operator">|</span> 刘国强    <span class="operator">|</span> 男     <span class="operator">|</span> <span class="number">2000</span><span class="number">-08</span><span class="number">-14</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> <span class="operator">|</span>  <span class="number">174.0</span> <span class="operator">|</span> <span class="number">15937320789</span> <span class="operator">|</span> D02     <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-----------+-----------+--------+---------------------+--------+-------------+---------+</span></span><br><span class="line"><span class="number">2</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line"><span class="comment">--说明：从第 4 条记录开始，返回 2 条记录。</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>





<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span></span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="operator">*</span></span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">FROM</span></span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> stu</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">ORDER</span> <span class="keyword">BY</span></span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> height <span class="keyword">DESC</span></span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> LIMIT <span class="number">3</span>;</span><br><span class="line"><span class="operator">+</span><span class="comment">-----------+-----------+--------+---------------------+--------+-------------+---------+</span></span><br><span class="line"><span class="operator">|</span> stu_id    <span class="operator">|</span> stu_name  <span class="operator">|</span> gender <span class="operator">|</span> birth               <span class="operator">|</span> height <span class="operator">|</span> phone       <span class="operator">|</span> dept_id <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-----------+-----------+--------+---------------------+--------+-------------+---------+</span></span><br><span class="line"><span class="operator">|</span> <span class="number">201901002</span> <span class="operator">|</span> 王宏伟    <span class="operator">|</span> 男     <span class="operator">|</span> <span class="number">2001</span><span class="number">-02</span><span class="number">-15</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> <span class="operator">|</span>  <span class="number">180.0</span> <span class="operator">|</span> <span class="number">15937320255</span> <span class="operator">|</span> D01     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">201901004</span> <span class="operator">|</span> 李刚      <span class="operator">|</span> 男     <span class="operator">|</span> <span class="number">2000</span><span class="number">-12</span><span class="number">-25</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> <span class="operator">|</span>  <span class="number">178.0</span> <span class="operator">|</span> <span class="number">15937320321</span> <span class="operator">|</span> D01     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">201801101</span> <span class="operator">|</span> 王占峰    <span class="operator">|</span> 男     <span class="operator">|</span> <span class="number">1999</span><span class="number">-12</span><span class="number">-30</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> <span class="operator">|</span>  <span class="number">177.0</span> <span class="operator">|</span> <span class="number">15937320987</span> <span class="operator">|</span> D02     <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-----------+-----------+--------+---------------------+--------+-------------+---------+</span></span><br><span class="line"><span class="number">3</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line"><span class="comment">--说明： LIMIT 3 等价于  LIMIT 0,3。取出前 3 条记录。</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>





<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span></span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="operator">*</span></span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">FROM</span></span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> stu</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">ORDER</span> <span class="keyword">BY</span></span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> height <span class="keyword">DESC</span></span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> LIMIT <span class="number">4</span> <span class="keyword">OFFSET</span> <span class="number">2</span>;</span><br><span class="line"><span class="operator">+</span><span class="comment">-----------+-----------+--------+---------------------+--------+-------------+---------+</span></span><br><span class="line"><span class="operator">|</span> stu_id    <span class="operator">|</span> stu_name  <span class="operator">|</span> gender <span class="operator">|</span> birth               <span class="operator">|</span> height <span class="operator">|</span> phone       <span class="operator">|</span> dept_id <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-----------+-----------+--------+---------------------+--------+-------------+---------+</span></span><br><span class="line"><span class="operator">|</span> <span class="number">201801101</span> <span class="operator">|</span> 王占峰    <span class="operator">|</span> 男     <span class="operator">|</span> <span class="number">1999</span><span class="number">-12</span><span class="number">-30</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> <span class="operator">|</span>  <span class="number">177.0</span> <span class="operator">|</span> <span class="number">15937320987</span> <span class="operator">|</span> D02     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">201901005</span> <span class="operator">|</span> 刘鹏      <span class="operator">|</span> 男     <span class="operator">|</span> <span class="number">2001</span><span class="number">-12</span><span class="number">-18</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> <span class="operator">|</span>  <span class="number">176.0</span> <span class="operator">|</span> <span class="keyword">NULL</span>        <span class="operator">|</span> D01     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">201801102</span> <span class="operator">|</span> 刘国强    <span class="operator">|</span> 男     <span class="operator">|</span> <span class="number">2000</span><span class="number">-08</span><span class="number">-14</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> <span class="operator">|</span>  <span class="number">174.0</span> <span class="operator">|</span> <span class="number">15937320789</span> <span class="operator">|</span> D02     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">201801203</span> <span class="operator">|</span> 王鹏飞    <span class="operator">|</span> 男     <span class="operator">|</span> <span class="number">2000</span><span class="number">-10</span><span class="number">-19</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> <span class="operator">|</span>  <span class="number">174.0</span> <span class="operator">|</span> <span class="number">15937320555</span> <span class="operator">|</span> D03     <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-----------+-----------+--------+---------------------+--------+-------------+---------+</span></span><br><span class="line"><span class="number">4</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"><span class="comment">-- 输出从第二行(下标)开始的4行记录</span></span><br></pre></td></tr></table></figure>

<h2 id="连接查询"><a href="#连接查询" class="headerlink" title="连接查询"></a>连接查询</h2><h3 id="一、交叉连接（CROSS-JOIN）"><a href="#一、交叉连接（CROSS-JOIN）" class="headerlink" title="一、交叉连接（CROSS JOIN）"></a>一、交叉连接（CROSS JOIN）</h3><p>交叉连接（CROSS JOIN）又称为关系的笛卡儿积。是用左表中的每一行与右表中的每一行进行连接，所得到的结果是这两个表中各行数据的所有组合。例如：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span></span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="operator">*</span></span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">FROM</span></span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> stu <span class="keyword">cross</span> <span class="keyword">join</span> dept;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">-- 也可以把 cross join 换成逗号（,）</span></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> </span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="operator">*</span> </span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">FROM</span> </span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> stu,dept;</span><br></pre></td></tr></table></figure>

<h3 id="二、内连接（INNER-JOIN）"><a href="#二、内连接（INNER-JOIN）" class="headerlink" title="二、内连接（INNER JOIN）"></a>二、内连接（INNER JOIN）</h3><p>查询结果中只包含两表的公共字段（子表的外键和父表的<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=%E4%B8%BB%E9%94%AE&spm=1001.2101.3001.7020">主键</a>）值相等的行。语法如下：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">FROM</span> 子表 <span class="keyword">INNER</span> <span class="keyword">JOIN</span> 父表 <span class="keyword">ON</span> 子表.外键 <span class="operator">=</span> 父表.主键</span><br><span class="line">或</span><br><span class="line"><span class="keyword">FROM</span> 子表 <span class="keyword">JOIN</span> 父表 <span class="keyword">ON</span> 子表.外键 <span class="operator">=</span> 父表.主键</span><br><span class="line">或</span><br><span class="line"><span class="keyword">FROM</span> 子表, 父表 </span><br><span class="line"><span class="keyword">WHERE</span> 子表.外键 <span class="operator">=</span> 父表.主键</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>说明：连接查询时如果需要使用的列在多个表中被使用，需要在列名前面加上表名加以限定，即：表名.列名。</p>
<h3 id="多表联查"><a href="#多表联查" class="headerlink" title="多表联查"></a>多表联查</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">....</span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">(表<span class="number">1</span> [<span class="keyword">inner</span>] <span class="keyword">join</span> 表<span class="number">2</span> <span class="keyword">on</span> 表<span class="number">1.</span>外键 <span class="operator">=</span> 表<span class="number">2.</span>主键)</span><br><span class="line">[<span class="keyword">inner</span>] <span class="keyword">join</span> 表<span class="number">3</span> <span class="keyword">on</span> 表<span class="number">2.</span>外键 <span class="operator">=</span> 表<span class="number">3.</span>主键</span><br><span class="line">...</span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span></span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> s.stu_id,</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> s.stu_name,</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> d.dept_id,</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> d.dept_name,</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> c.c_id,</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> c.c_name,</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> sc.score</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">FROM</span></span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> ((stu s <span class="keyword">JOIN</span> dept d <span class="keyword">ON</span> s.dept_id <span class="operator">=</span> d.dept_id)</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">JOIN</span> score sc <span class="keyword">ON</span> s.stu_id <span class="operator">=</span> sc.stu_id)</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">JOIN</span> course c <span class="keyword">ON</span> sc.c_id <span class="operator">=</span> c.c_id;</span><br><span class="line"><span class="operator">+</span><span class="comment">-----------+-----------+---------+--------------+-------+-----------------------+-------+</span></span><br><span class="line"><span class="operator">|</span> stu_id    <span class="operator">|</span> stu_name  <span class="operator">|</span> dept_id <span class="operator">|</span> dept_name    <span class="operator">|</span> c_id  <span class="operator">|</span> c_name                <span class="operator">|</span> score <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-----------+-----------+---------+--------------+-------+-----------------------+-------+</span></span><br><span class="line"><span class="operator">|</span> <span class="number">201901002</span> <span class="operator">|</span> 王宏伟    <span class="operator">|</span> D01     <span class="operator">|</span> 管理系       <span class="operator">|</span> C0101 <span class="operator">|</span> 管理学原理            <span class="operator">|</span>    <span class="number">78</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">201901002</span> <span class="operator">|</span> 王宏伟    <span class="operator">|</span> D01     <span class="operator">|</span> 管理系       <span class="operator">|</span> C0102 <span class="operator">|</span> 政治经济学            <span class="operator">|</span>    <span class="number">92</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">201901002</span> <span class="operator">|</span> 王宏伟    <span class="operator">|</span> D01     <span class="operator">|</span> 管理系       <span class="operator">|</span> C0103 <span class="operator">|</span> 数据库系统原理        <span class="operator">|</span>    <span class="number">87</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">201901002</span> <span class="operator">|</span> 王宏伟    <span class="operator">|</span> D01     <span class="operator">|</span> 管理系       <span class="operator">|</span> C0104 <span class="operator">|</span> 企业管理概论          <span class="operator">|</span>    <span class="number">74</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">201801101</span> <span class="operator">|</span> 王占峰    <span class="operator">|</span> D02     <span class="operator">|</span> 计算机系     <span class="operator">|</span> C0201 <span class="operator">|</span> 数据结构              <span class="operator">|</span>    <span class="number">80</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">201801102</span> <span class="operator">|</span> 刘国强    <span class="operator">|</span> D02     <span class="operator">|</span> 计算机系     <span class="operator">|</span> C0201 <span class="operator">|</span> 数据结构              <span class="operator">|</span>    <span class="number">98</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">201801202</span> <span class="operator">|</span> 赵牡丹    <span class="operator">|</span> D03     <span class="operator">|</span> 数学系       <span class="operator">|</span> C0301 <span class="operator">|</span> 高等数学              <span class="operator">|</span>    <span class="number">75</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">201801202</span> <span class="operator">|</span> 赵牡丹    <span class="operator">|</span> D03     <span class="operator">|</span> 数学系       <span class="operator">|</span> C0302 <span class="operator">|</span> 运筹学                <span class="operator">|</span>    <span class="number">69</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">201801202</span> <span class="operator">|</span> 赵牡丹    <span class="operator">|</span> D03     <span class="operator">|</span> 数学系       <span class="operator">|</span> C0303 <span class="operator">|</span> 概率论                <span class="operator">|</span>    <span class="number">62</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">201801203</span> <span class="operator">|</span> 王鹏飞    <span class="operator">|</span> D03     <span class="operator">|</span> 数学系       <span class="operator">|</span> C0301 <span class="operator">|</span> 高等数学              <span class="operator">|</span>    <span class="number">89</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">201801203</span> <span class="operator">|</span> 王鹏飞    <span class="operator">|</span> D03     <span class="operator">|</span> 数学系       <span class="operator">|</span> C0302 <span class="operator">|</span> 运筹学                <span class="operator">|</span>    <span class="number">82</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">201801203</span> <span class="operator">|</span> 王鹏飞    <span class="operator">|</span> D03     <span class="operator">|</span> 数学系       <span class="operator">|</span> C0303 <span class="operator">|</span> 概率论                <span class="operator">|</span>    <span class="number">64</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-----------+-----------+---------+--------------+-------+-----------------------+-------+</span></span><br><span class="line"><span class="number">12</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="聚合函数"><a href="#聚合函数" class="headerlink" title="聚合函数"></a>聚合函数</h3><p>聚合函数又称为统计函数，可以对查询结果进行统计和汇总，对一组值进行计算并返回一个单一的值。聚合函数经常与 GROUP BY 子句一同使用。常用的聚合函数包括SUM、COUNT、AVG、MAX 和 MIN，实现对表中数据的统计（求和、计数、平均值、最大值和最小值等）。</p>
<p>举例：</p>
<h4 id="count"><a href="#count" class="headerlink" title="count"></a>count</h4><h4 id="1、统计男生人数"><a href="#1、统计男生人数" class="headerlink" title="1、统计男生人数"></a>1、统计男生人数</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span></span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="built_in">count</span>(<span class="operator">*</span>) <span class="keyword">as</span> 男生人数</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">FROM</span></span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> stu</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">WHERE</span></span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> gender<span class="operator">=</span><span class="string">&#x27;男&#x27;</span>;</span><br><span class="line"><span class="operator">+</span><span class="comment">--------------+</span></span><br><span class="line"><span class="operator">|</span> 男生人数     <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------------+</span></span><br><span class="line"><span class="operator">|</span>            <span class="number">6</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------------+</span></span><br><span class="line"><span class="number">1</span> <span class="type">row</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.17</span> sec)</span><br><span class="line"></span><br><span class="line"><span class="comment">--也可以不使用 WHERE 子句，在 count()函数中使用表达式</span></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span></span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="built_in">count</span>(if(gender <span class="operator">=</span> <span class="string">&#x27;男&#x27;</span>,<span class="number">1</span>,<span class="keyword">null</span>)) <span class="keyword">as</span> 男生人数</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">FROM</span> </span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> stu;</span><br><span class="line"><span class="operator">+</span><span class="comment">--------------+</span></span><br><span class="line"><span class="operator">|</span> 男生人数     <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------------+</span></span><br><span class="line"><span class="operator">|</span>            <span class="number">6</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------------+</span></span><br><span class="line"><span class="number">1</span> <span class="type">row</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="2、统计身高超过-175-的学生人数"><a href="#2、统计身高超过-175-的学生人数" class="headerlink" title="2、统计身高超过 175 的学生人数"></a>2、统计身高超过 175 的学生人数</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span></span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="built_in">count</span>(<span class="operator">*</span>) <span class="keyword">as</span> 人数</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">FROM</span></span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> stu</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">WHERE</span></span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> height <span class="operator">&gt;=</span> <span class="number">175</span>;</span><br><span class="line"><span class="operator">+</span><span class="comment">--------+</span></span><br><span class="line"><span class="operator">|</span> 人数   <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------+</span></span><br><span class="line"><span class="operator">|</span>      <span class="number">4</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------+</span></span><br><span class="line"><span class="number">1</span> <span class="type">row</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.02</span> sec)</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h4 id="3、统计有学生的系的个数"><a href="#3、统计有学生的系的个数" class="headerlink" title="3、统计有学生的系的个数"></a>3、统计有学生的系的个数</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span></span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="built_in">count</span>(<span class="keyword">distinct</span> dept_id) <span class="keyword">as</span> 系的个数</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">FROM</span> </span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> stu;</span><br><span class="line"><span class="operator">+</span><span class="comment">--------------+</span></span><br><span class="line"><span class="operator">|</span> 系的个数     <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------------+</span></span><br><span class="line"><span class="operator">|</span>            <span class="number">3</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------------+</span></span><br><span class="line"><span class="number">1</span> <span class="type">row</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.03</span> sec)</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h4 id="sum"><a href="#sum" class="headerlink" title="sum"></a>sum</h4><p>SUM( ) 函数返回一组值的和，忽略 NULL 值。如果找不到匹配行，返回 NULL 值。常与 GROUP BY 子句连用。格式如下：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span></span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="built_in">sum</span>(salary) <span class="keyword">as</span> 工资总额</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">FROM</span> </span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> emp;</span><br><span class="line"><span class="operator">+</span><span class="comment">--------------+</span></span><br><span class="line"><span class="operator">|</span> 工资总额     <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------------+</span></span><br><span class="line"><span class="operator">|</span>     <span class="number">84500.00</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------------+</span></span><br><span class="line"><span class="number">1</span> <span class="type">row</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> </span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="built_in">sum</span>(if(gender <span class="operator">=</span> <span class="string">&#x27;女&#x27;</span>,<span class="number">1</span>,<span class="number">0</span>)) <span class="keyword">as</span> 女生人数</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">FROM</span> </span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> stu;</span><br><span class="line"><span class="operator">+</span><span class="comment">--------------+</span></span><br><span class="line"><span class="operator">|</span> 女生人数     <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------------+</span></span><br><span class="line"><span class="operator">|</span>            <span class="number">5</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------------+</span></span><br><span class="line"><span class="number">1</span> <span class="type">row</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span></span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="built_in">sum</span>(salary) <span class="keyword">as</span> 工资总额</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">FROM</span></span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> emp</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">WHERE</span></span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> salary <span class="operator">&gt;</span> <span class="number">10000</span>;</span><br><span class="line"><span class="operator">+</span><span class="comment">--------------+</span></span><br><span class="line"><span class="operator">|</span> 工资总额     <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------------+</span></span><br><span class="line"><span class="operator">|</span>         <span class="keyword">NULL</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------------+</span></span><br><span class="line"><span class="number">1</span> <span class="type">row</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.01</span> sec)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="avg"><a href="#avg" class="headerlink" title="avg()"></a>avg()</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span></span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="built_in">avg</span>(salary) <span class="keyword">as</span> 平均工资</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">FROM</span></span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> emp;</span><br><span class="line"><span class="operator">+</span><span class="comment">--------------+</span></span><br><span class="line"><span class="operator">|</span> 平均工资     <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------------+</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">6500.000000</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------------+</span></span><br><span class="line"><span class="number">1</span> <span class="type">row</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="max-min"><a href="#max-min" class="headerlink" title="max,min"></a>max,min</h4><p>max( ) 函数返回一组值中的最大值。计算时忽略 NULL 值。常与 GROUP BY 子句连用。</p>
<h3 id="group-by"><a href="#group-by" class="headerlink" title="group by"></a>group by</h3><p>使用 GROUP BY 关键字可以将查询结果按照某个字段或多个字段进行分组。分组的依据为 GROUP BY 后面的字段中取值相等的分为一组。GROUP BY 通常与<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=%E8%81%9A%E5%90%88%E5%87%BD%E6%95%B0&spm=1001.2101.3001.7020">聚合函数</a>一起使用。语法格式如下：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> 字段名<span class="operator">|</span>表达式 [<span class="keyword">HAVING</span> 条件表达式] [<span class="keyword">WITH</span> <span class="keyword">ROLLUP</span>]</span><br><span class="line"></span><br><span class="line">说明：</span><br><span class="line">（<span class="number">1</span>）使用分组查询时，<span class="keyword">select</span>后面的字段列表只能包含 <span class="keyword">GROUP</span> <span class="keyword">BY</span> 后面的字段名或表达式以及聚合函数，不能包含其他字段或表达式，否则会报错。</span><br><span class="line">（<span class="number">2</span>）字段名<span class="operator">|</span>表达式：分组依据，按字段或表达式进行分组。</span><br><span class="line">（<span class="number">3</span>）<span class="keyword">HAVING</span> 条件表达式：对分组进行选择，符合条件表达式的结果才会显示。</span><br><span class="line">（<span class="number">4</span>）<span class="keyword">WITH</span> <span class="keyword">ROLLUP</span>：在所有记录的最后加上一条记录，该记录为对所有行的统计结果。</span><br><span class="line">（<span class="number">5</span>）可以使用 GROUP_CONCAT() 函数把某个字段中的所有值连接成一个字符串。</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span></span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> gender</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">FROM</span></span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> stu</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">GROUP</span> <span class="keyword">BY</span></span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> gender;</span><br><span class="line"><span class="operator">+</span><span class="comment">--------+</span></span><br><span class="line"><span class="operator">|</span> gender <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------+</span></span><br><span class="line"><span class="operator">|</span> 女     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> 男     <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------+</span></span><br><span class="line"><span class="number">2</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="select-选择的字段列表包含了其他的字段名或表达式"><a href="#select-选择的字段列表包含了其他的字段名或表达式" class="headerlink" title="select 选择的字段列表包含了其他的字段名或表达式"></a>select 选择的字段列表包含了其他的字段名或表达式</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span></span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> stu_name,gender</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">FROM</span> </span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> stu</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">GROUP</span> <span class="keyword">BY</span></span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> gender;</span><br><span class="line">    </span><br><span class="line">ERROR <span class="number">1055</span> (<span class="number">42000</span>): Expression #<span class="number">1</span> <span class="keyword">of</span> <span class="keyword">SELECT</span> list <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">in</span> <span class="keyword">GROUP</span> <span class="keyword">BY</span> clause <span class="keyword">and</span> <span class="keyword">contains</span> nonaggregated <span class="keyword">column</span> <span class="string">&#x27;wgx.stu.stu_name&#x27;</span> which <span class="keyword">is</span> <span class="keyword">not</span> func</span><br><span class="line">tionally dependent <span class="keyword">on</span> columns <span class="keyword">in</span> <span class="keyword">GROUP</span> <span class="keyword">BY</span> clause; this <span class="keyword">is</span> incompatible <span class="keyword">with</span> sql_mode<span class="operator">=</span>only_full_group_by</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="分别统计男生和女生的平均身高"><a href="#分别统计男生和女生的平均身高" class="headerlink" title="分别统计男生和女生的平均身高"></a>分别统计男生和女生的平均身高</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span></span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> gender,<span class="built_in">avg</span>(height) <span class="keyword">as</span> 平均身高</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">FROM</span></span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> stu</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">GROUP</span> <span class="keyword">BY</span></span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> gender;</span><br><span class="line"><span class="operator">+</span><span class="comment">--------+--------------+</span></span><br><span class="line"><span class="operator">|</span> gender <span class="operator">|</span> 平均身高     <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------+--------------+</span></span><br><span class="line"><span class="operator">|</span> 女     <span class="operator">|</span>    <span class="number">164.80000</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> 男     <span class="operator">|</span>    <span class="number">176.50000</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------+--------------+</span></span><br><span class="line"><span class="number">2</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="统计每个系的学生人数"><a href="#统计每个系的学生人数" class="headerlink" title="统计每个系的学生人数"></a>统计每个系的学生人数</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span></span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> d.dept_id,</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> d.dept_name,</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="built_in">count</span>(<span class="operator">*</span>) <span class="keyword">as</span> 学生人数</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">FROM</span></span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> stu s <span class="keyword">JOIN</span> dept d <span class="keyword">ON</span> s.dept_id <span class="operator">=</span> d.dept_id</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">GROUP</span> <span class="keyword">BY</span> </span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> d.dept_id;</span><br><span class="line"><span class="operator">+</span><span class="comment">---------+--------------+--------------+</span></span><br><span class="line"><span class="operator">|</span> dept_id <span class="operator">|</span> dept_name    <span class="operator">|</span> 学生人数     <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------+--------------+--------------+</span></span><br><span class="line"><span class="operator">|</span> D01     <span class="operator">|</span> 管理系       <span class="operator">|</span>            <span class="number">4</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> D02     <span class="operator">|</span> 计算机系     <span class="operator">|</span>            <span class="number">4</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> D03     <span class="operator">|</span> 数学系       <span class="operator">|</span>            <span class="number">2</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------+--------------+--------------+</span></span><br><span class="line"><span class="number">3</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.01</span> sec)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="统计各个年级的学生人数"><a href="#统计各个年级的学生人数" class="headerlink" title="统计各个年级的学生人数"></a>统计各个年级的学生人数</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> </span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">left</span>(stu_id,<span class="number">4</span>),</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="built_in">count</span>(<span class="operator">*</span>) <span class="keyword">as</span> 学生人数</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">FROM</span></span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> stu</span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">GROUP</span> <span class="keyword">BY</span></span><br><span class="line">    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">left</span>(stu_id,<span class="number">4</span>);</span><br><span class="line"><span class="operator">+</span><span class="comment">----------------+--------------+</span></span><br><span class="line"><span class="operator">|</span> <span class="keyword">left</span>(stu_id,<span class="number">4</span>) <span class="operator">|</span> 学生人数     <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----------------+--------------+</span></span><br><span class="line"><span class="operator">|</span> <span class="number">2018</span>           <span class="operator">|</span>            <span class="number">7</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">2019</span>           <span class="operator">|</span>            <span class="number">4</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----------------+--------------+</span></span><br><span class="line"><span class="number">2</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"><span class="comment">--  LEFT(stu_Id,4)取出stu_Id字段从左侧数前四个字符</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="SELECT-语句的语法顺序"><a href="#SELECT-语句的语法顺序" class="headerlink" title="SELECT 语句的语法顺序"></a>SELECT 语句的语法顺序</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> [<span class="keyword">distinct</span>] 字段或表达式列表</span><br><span class="line"><span class="keyword">from</span> 表名 <span class="keyword">join</span>(<span class="keyword">left</span> <span class="keyword">join</span>, <span class="keyword">right</span> <span class="keyword">join</span>) <span class="keyword">on</span> 连接条件</span><br><span class="line"><span class="keyword">where</span> 筛选条件</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> 字段列表</span><br><span class="line"><span class="keyword">having</span> 字段列表</span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> 字段列表</span><br><span class="line">limit <span class="operator">&lt;</span>m,n<span class="operator">&gt;</span></span><br><span class="line"><span class="comment">-- 说服我干活哦</span></span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span> <span class="keyword">FROM</span>子句</span><br><span class="line"><span class="number">2.</span> <span class="keyword">WHERE</span>子句</span><br><span class="line"><span class="number">3.</span> <span class="keyword">GROUP</span> <span class="keyword">BY</span>子句  </span><br><span class="line"><span class="number">4.</span> <span class="keyword">HAVING</span>子句</span><br><span class="line"><span class="number">5.</span> <span class="keyword">SELECT</span>子句</span><br><span class="line"><span class="number">6.</span> <span class="keyword">ORDER</span> <span class="keyword">BY</span>子句</span><br><span class="line"><span class="number">7.</span> LIMIT子句</span><br><span class="line"></span><br><span class="line"><span class="comment">/*  ########################################################################################</span></span><br><span class="line"><span class="comment">执行顺序的说明：</span></span><br><span class="line"><span class="comment">(1) from 子句组装来自不同数据源的数据； </span></span><br><span class="line"><span class="comment">(2) where 子句基于指定的条件对记录行进行筛选； </span></span><br><span class="line"><span class="comment">(3) group by 子句将数据划分为多个分组； </span></span><br><span class="line"><span class="comment">(4) 使用聚集函数进行计算； </span></span><br><span class="line"><span class="comment">(5) 使用 having 子句筛选分组； </span></span><br><span class="line"><span class="comment">(6) 计算所有的表达式； </span></span><br><span class="line"><span class="comment">(7) select 字段；</span></span><br><span class="line"><span class="comment">(8) 使用 order by 对结果集进行排序。</span></span><br><span class="line"><span class="comment">需要去理解下</span></span><br><span class="line"><span class="comment">关于字段别名的使用：</span></span><br><span class="line"><span class="comment">(1) WHERE子句不能使用字段别名。</span></span><br><span class="line"><span class="comment">(2) 从 GROUP BY 子句开始，后面的所有子句可以使用字段别名。</span></span><br><span class="line"><span class="comment">########################################################################################  */</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>





<p>DDL(Data Definition Language)数据定义语言<br>一、操作库<br>– 创建库<br>create database db1;<br>– 创建库是否存在，不存在则创建<br>create database if not exists db1;<br>– 查看所有数据库<br>show databases;<br>– 查看某个数据库的定义信息<br>show create database db1;<br>– 修改数据库字符信息<br>alter database db1 character set utf8;<br>– 删除数据库<br>drop database db1;<br>二、操作表<br>–创建表<br>create table student(<br>    id int,<br>    name varchar(32),<br>    age int ,<br>    score double(4,1),<br>    birthday date,<br>    insert_time timestamp<br>);</p>
<p>一、基础关键字<br> BETWEEN…AND （在什么之间）和  IN( 集合)</p>
<p>– 查询年龄大于等于20 小于等于30				<br>SELECT * FROM student WHERE age &gt;&#x3D; 20 &amp;&amp;  age &lt;&#x3D;30;<br>SELECT * FROM student WHERE age &gt;&#x3D; 20 AND  age &lt;&#x3D;30;<br>SELECT * FROM student WHERE age BETWEEN 20 AND 30;</p>
<p>– 查询年龄22岁，18岁，25岁的信息<br>SELECT * FROM student WHERE age &#x3D; 22 OR age &#x3D; 18 OR age &#x3D; 25<br>SELECT * FROM student WHERE age IN (22,18,25);<br> is null(不为null值) 与 like（模糊查询）、distinct（去除重复值）</p>
<p>– 查询英语成绩不为null<br>SELECT * FROM student WHERE english  IS NOT NULL;</p>
<p> <em>:单个任意字符<br> %：多个任意字符<br>– 查询姓马的有哪些？ like<br>SELECT * FROM student WHERE NAME LIKE ‘马%’;<br>– 查询姓名第二个字是化的人			<br>SELECT * FROM student WHERE NAME LIKE “<em>化%”;				<br>– 查询姓名是3个字的人<br>SELECT * FROM student WHERE NAME LIKE ‘</em></em>_’;					<br>– 查询姓名中包含德的人<br>SELECT * FROM student WHERE NAME LIKE ‘%德%’;</p>
<p>– 关键词 DISTINCT 用于返回唯一不同的值。<br>– 语法：SELECT DISTINCT 列名称 FROM 表名称<br>SELECT DISTINCT NAME FROM  student ;<br>二、排序查询 order by<br>语法：order by 子句</p>
<pre><code>      order by 排序字段1 排序方式1 ，  排序字段2 排序方式2...
</code></pre>
<p>注意：<br>            如果有多个排序条件，则当前边的条件值一样时，才会判断第二条件。</p>
<p>– 例子<br>SELECT * FROM person ORDER BY math; –默认升序<br>SELECT * FROM person ORDER BY math desc; –降序<br>三、 聚合函数：将一列数据作为一个整体，进行纵向的计算。<br>1.count：计算个数</p>
<p>2.max：计算最大值</p>
<p>3.min：计算最小值</p>
<p>4.sum：计算和</p>
<p>5.avg：计算平均数</p>
<p>四、 分组查询 grout by<br>      语法：group by 分组字段;</p>
<pre><code>  注意：分组之后查询的字段：分组字段、聚合函数
</code></pre>
<p>– 按照性别分组。分别查询男、女同学的平均分<br>SELECT sex , AVG(math) FROM student GROUP BY sex;</p>
<p>– 按照性别分组。分别查询男、女同学的平均分,人数<br> SELECT sex , AVG(math),COUNT(id) FROM student GROUP BY sex;</p>
<p>–  按照性别分组。分别查询男、女同学的平均分,人数 要求：分数低于70分的人，不参与分组<br>SELECT sex , AVG(math),COUNT(id) FROM student WHERE math &gt; 70 GROUP BY sex;</p>
<p> –  按照性别分组。分别查询男、女同学的平均分,人数 要求：分数低于70分的人，不参与分组,分组之后。人数要大于2个人<br>SELECT sex , AVG(math),COUNT(id) FROM student WHERE math &gt; 70 GROUP BY sex HAVING COUNT(id) &gt; 2;<br>SELECT sex , AVG(math),COUNT(id) 人数 FROM student WHERE math &gt; 70 GROUP BY sex HAVING 人数 &gt; 2;<br>五、 分页查询<br>    1. 语法：limit 开始的索引,每页查询的条数;<br>    2. 公式：开始的索引 &#x3D; （当前的页码 - 1） * 每页显示的条数<br>    3. limit 是一个MySQL”方言” </p>
<p>– 每页显示3条记录 </p>
<p>SELECT * FROM student LIMIT 0,3; – 第1页</p>
<p>SELECT * FROM student LIMIT 3,3; – 第2页</p>
<p>SELECT * FROM student LIMIT 6,3; – 第3页<br>六、内连接查询：</p>
<pre><code>  1. 从哪些表中查询数据
</code></pre>
<p>   2.条件是什么</p>
<pre><code>  3. 查询哪些字段
</code></pre>
<p>1.隐式内连接：使用where条件消除无用数据<br>– 查询员工表的名称，性别。部门表的名称<br>SELECT emp.name,emp.gender,dept.name FROM emp,dept WHERE emp.<code>dept_id</code> &#x3D; dept.<code>id</code>;</p>
<p>SELECT<br>    t1.name, – 员工表的姓名<br>    t1.gender,– 员工表的性别<br>    t2.name – 部门表的名称<br>FROM<br>    emp t1,<br>    dept t2<br>WHERE<br>    t1.<code>dept_id</code> &#x3D; t2.<code>id</code>;<br> 2.显式内连接<br>– 语法：<br>select 字段列表 from 表名1 [inner] join 表名2 on 条件<br>– 例如：<br>SELECT * FROM emp INNER JOIN dept ON emp.<code>dept_id</code> &#x3D; dept.<code>id</code>;<br>SELECT * FROM emp JOIN dept ON emp.<code>dept_id</code> &#x3D; dept.<code>id</code>;<br> 七、外连接查询<br>1.左外连接 – 查询的是左表所有数据以及其交集部分。<br>– 语法：select 字段列表 from 表1 left [outer] join 表2 on 条件；<br>– 例子：<br>– 查询所有员工信息，如果员工有部门，则查询部门名称，没有部门，则不显示部门名称<br>SELECT  t1.*,t2.<code>name</code> FROM emp t1 LEFT JOIN dept t2 ON t1.<code>dept_id</code> &#x3D; t2.<code>id</code>;<br> 2.右外连接  – 查询的是右表所有数据以及其交集部分。<br>– 语法：<br>select 字段列表 from 表1 right [outer] join 表2 on 条件；<br>– 例子：<br>SELECT  * FROM dept t2 RIGHT JOIN emp t1 ON t1.<code>dept_id</code> &#x3D; t2.<code>id</code>;<br> 八、子查询：查询中嵌套查询<br>– 查询工资最高的员工信息<br>– 1 查询最高的工资是多少 9000<br>SELECT MAX(salary) FROM emp;</p>
<p>– 2 查询员工信息，并且工资等于9000的<br>SELECT * FROM emp WHERE emp.<code>salary</code> &#x3D; 9000;</p>
<p> – 一条sql就完成这个操作。这就是子查询<br>SELECT * FROM emp WHERE emp.<code>salary</code> &#x3D; (SELECT MAX(salary) FROM emp);<br>   1.子查询的结果是单行单列的<br> 子查询可以作为条件，使用运算符去判断。 运算符： &gt; &gt;&#x3D; &lt; &lt;&#x3D; &#x3D;</p>
<p>– 查询员工工资小于平均工资的人<br>SELECT * FROM emp WHERE emp.salary &lt; (SELECT AVG(salary) FROM emp);</p>
<pre><code>  2. 子查询的结果是多行单列的：
     子查询可以作为条件，使用运算符in来判断
</code></pre>
<p>– 查询’财务部’和’市场部’所有的员工信息<br>SELECT id FROM dept WHERE NAME &#x3D; ‘财务部’ OR NAME &#x3D; ‘市场部’;<br>SELECT * FROM emp WHERE dept_id &#x3D; 3 OR dept_id &#x3D; 2;</p>
<p>– 子查询<br>SELECT * FROM emp WHERE dept_id IN (SELECT id FROM dept WHERE NAME &#x3D; ‘财务部’ OR NAME &#x3D; ‘市场部’);</p>
<pre><code>  3. 子查询的结果是多行多列的：
     子查询可以作为一张虚拟表参与查询
</code></pre>
<p>– 查询员工入职日期是2011-11-11日之后的员工信息和部门信息<br>– 子查询<br>SELECT * FROM dept t1 ,(SELECT * FROM emp WHERE emp.<code>join_date</code> &gt; ‘2011-11-11’) t2 WHERE t1.id &#x3D; t2.dept_id;</p>
<p>– 普通内连接<br>SELECT * FROM emp t1,dept t2 WHERE t1.<code>dept_id</code> &#x3D; t2.<code>id</code> AND t1.<code>join_date</code> &gt;  ‘2011-11-11’<br> DCL(Data Control Language)数据控制语言<br>管理用户<br>添加用户<br>语法：CREATE USER ‘用户名‘@’主机名’ IDENTIFIED BY ‘密码’;<br>删除用户<br>语法：DROP USER ‘用户名‘@’主机名’;<br>权限管理<br>查询权限<br>– 查询权限<br>SHOW GRANTS FOR ‘用户名‘@’主机名’;<br>SHOW GRANTS FOR ‘lisi‘@’%’;<br>授予权限<br>– 授予权限<br>grant 权限列表 on 数据库名.表名 to ‘用户名‘@’主机名’;</p>
<p>– 给张三用户授予所有权限，在任意数据库任意表上<br>GRANT ALL ON <em>.</em> TO ‘zhangsan‘@’localhost’;<br>撤销权限<br>– 撤销权限：<br>revoke 权限列表 on 数据库名.表名 from ‘用户名‘@’主机名’;<br>REVOKE UPDATE ON db3.<code>account</code> FROM ‘lisi‘@’%’;</p>
<p><strong>作者：刘金玉</strong>数据库中对数据进行查询必须使用Select关键词。本期教程跟老刘一起对数据库查询的几种情况进行学习。</p>
<p><strong>第一种:单表查询</strong>语法结构: select 字段名称 from 表名称或者如果我们要查询表的所以字段，就直接使用select * from 表名 这个语法即可，这里的星号*表示所有字段名称。案例：查询用户表user的所有信息Select * from user</p>
<p><strong>第二种:带有条件筛选的单表查询 where</strong>这个语法只是在select查询语句的最好加上一条where语句进行数据的进一步过滤。语法结构：where 字段1 表达式符号 相应条件值举例：查询姓名为刘金玉的用户信息Select * from user where trueName&#x3D;’刘金玉’这里要注意的是“刘金玉”为一个字符串，因此要加上单引号，在数据库查询语句中，我们之前强调过，如果字段类型为字符串类型(例如char、varchar、nchar、nvarchar、text等)就要在查询和录入的时候加上相应的单引号‘’</p>
<p><strong>第三种:多表查询 join</strong>我们很多时候往往要多个表的数据举行查询，因为根据关系型数据库设计的特点，我们需要的各个字段的数据往往分布于各个不同的数据表内。虽然在数据库中我们也可以采用where语句进行关键表的字段，但是这样做有很多弊端：一是条件语句不清晰，二是查询效率降低。因此，我们引出了join这个关键词。<strong>Join有三种类型：</strong>left join 左连接 （默认的join就是left join）right join 右连接inner join 内连接语法结构：Select * from 表1 left&#x2F;right&#x2F;inner join 表2 on 表1.字段&#x3D;表2.字段举例：关联用户表和新闻表，关联字段为useridSelect * from user left join news on user.userid&#x3D; news. userid根据这样说表关联，就可以显示文章的作者信息啦！当然，我们也可以采用给表取别名的方式关联。Select * from user a left join news b on a.userid&#x3D; b. userid在使用join关键词进行关联的时候，一定要注意的是主表是哪个，这个跟现实结果记录数有关系。最好结合老刘的《零基础数据库教程》视频学习，注意观察一下不同的使用，得到的不同表关联结果。以下简单说明一下：A left join B 就是A为主表A right join B 就是B为主表A inner join B 就是取两张表的公共部分副表在这里只是根据关键词对主表进行匹配，可能会被多次匹配，这要看数据表设计时候的表关系。</p>
<p><strong>第四种:过滤相同列数据 distinct</strong>如果我们得到的查询结果中有相同的数据行，我们可以通过distinct关键词进行过滤。语法结构：select distinct 字段 from 表没错，只需要在查询select关键词后加上distinct关键词即可。举例：查询用户表一共有哪些用户昵称。Select distinct nickname from user</p>
<p><strong>第五种:数据排序order by</strong>我们很多时候都是要将查询后的数据进行排序的，按照我们查询的指定字段为主关键词和次要关键词进行排序，这个时候，我们需要使用order by这个重要关键词。这个关键词往往用在查询语句的最后。Order by 往往结合asc和desc这两个关键词，其中asc表示升序，desc表示降序。语法结构：Select 字段 from 表 『where语句』 order by 字段1 asc&#x2F;desc, 字段2 asc&#x2F;desc…使用案例：查询用户表所有信息，并按照用户编号进行升序排序。Select * from user order by userid asc其实在这个语句中，我们也可以省略asc关键词，因为order by 默认是以升序作为排序规则的。所以这个语句，我们也可以写成：Select * from user order by userid </p>
<p><strong>第六种:数据记录显示limit</strong>我们很多使用数据库的人员中，很多人都是做软件来发的，因此limit这个关键词就非常实用了，因为我们可以结合这个关键词，为我们的软件查询出来的数据记录结果做一个分页功能。limit这个关键词往往用在查询语句的最后。语法结构：Select 字段 from 表 [where语句] [order by语句] [limit语句]举例：获取用户表的前十条记录Select * from user limit 10获取用户表的第11～20条记录Select * from user limit 10，20</p>
<p><strong>第七种:聚合函数 sum count等</strong>sum函数用来求和、count函数用来统计数据记录数。但要注意，聚合函数会自动忽略类型值为null的记录。下面分别对两个函数进行讲解:1.求和函数sum。使用注意，该函数用于统计数值类字段。使用时配合select语句。函数参数传入字段名，格式sum（字段名称）。举例:统计某学生各科总成绩。select stuname，sum（score） from student_score这里的stuname是学生姓名，score是指各科目对应的成绩字段，student_score是学生各科成绩表</p>
<p><strong>第八种:数据分组group by</strong></p>
<p>group by的意思就是根据哪些字段进行分组，这里注意，后面接的第一个字段是主要关键词，其它的依次都是次要关键词。</p>
<p>分组的数据一般都是where语句筛选后的最终数据，再进行依次筛选，这样的好处是可以减少分组的数据，以进一步提高数据库性能。</p>
<p>语法结构：</p>
<p>group by 字段1，字段2，字段3</p>
<p>语句所在sql中的位置：</p>
<p>select 字段 from 表 [where语句]<strong>[group by语句]</strong></p>
<p>一般来说，group by后面接几个字段，在select中就会列出几个字段。分组最终的目的是为了统计数据，比如对每一个学生的各科成绩求和。</p>
<p>案例：统计每个城市有多少人，我们可以从人口信息表中查询出要统计的数据结果。</p>
<p>select city,count(*) from persons group by city</p>
<p>这里的persons是人口信息表，city是城市名称，count（*）表示统计记录数</p>
<p><strong>第九种:分组后筛选数据 having</strong>我们有时候常常还会将分组后的数据进行进一步过滤，那么，此时就要使用到having了。</p>
<p>语句所在sql中的位置：</p>
<p>select 字段 from 表 [where语句]<strong>[group by语句][having语句]</strong></p>
<p>至于having之后的字段表达式的用法类似于where语句，唯一不同的就是having之后的筛选条件的字段是group by之后的字段。</p>
<p>案例：筛选出总成绩大于300分的学生</p>
<p>思路：先用group by分组求出每个学生的总成绩，然后将分组后的总成绩中筛选出成绩大于300的结果记录。</p>
<p>select stuname,sum(score) from student_score group by stuname having sum(score)&gt;300</p>
<p>因为，这里筛选的是总成绩这个字段，而这个字段的名称就是sum(score)，因此在having中使用sum(score)作为字段名称。</p>
<p>其中：<br>DISTINCT|UNIQUE|ALL：指定查询结果集中的重复记录 处理方式，默认值为ALL。<br>select_list：指定从数据库中返回的目标列或表达式。<br>query_table_expression：指定数据来源的表、视图或实体化视图等。·join_clause：进行连接查询。<br>where_clause：限制从数据源中返回的记录需要满足的条件。<br>hierarchical_query_clause：层次查询。<br>group_by_clause：分组查询。<br>order_by_clause：查询结果排序。<br>row_limiting_clause：返回查询结果中指定的若干记录。</p>
<p>SELECT语句执行的基本步骤为： </p>
<p>1、当执行一条SELECT语句时，系统会根据WHERE子句 的条件表达式condition，从FROM子句指定的数据源（基本 表、视图、实体化视图、连接查询等）中找出满足条件的记 录，再按SELECT子句中指定的目标列或表达式形成结果集。<br>2、如果数据源是多表连接，则先进行多表连接操作，形 成一个大的结果集，作为外部查询的数据源。<br>3、如果包含层次查询，则返回的记录在满足WHERE过滤 条件的同时，还要符合层次查询条件。<br>4、如果包含分组查询，则将返回的结果集按特定的分组 列进行分组。如果需要对分组进行过滤，最后返回的结果集还 要满足分组的过滤条件。<br>5、如果需要对查询结果进行排序，则返回的结果集需要 进行二次处理，返回有序数据。<br>6、如果只返回排序后的部分记录，则从排序后的结果集 中返回指定的记录</p>
<h1 id="索引-1"><a href="#索引-1" class="headerlink" title="索引"></a>索引</h1><h3 id="什么是索引？"><a href="#什么是索引？" class="headerlink" title="什么是索引？"></a>什么是索引？</h3><p>索引是一种数据结构，是数据库管理系统中一个排序的数据结构，以协助快速查询数据库表中数据。索引的实现通常使用B+树或hash表。</p>
<p>更通俗的说，索引就相当于目录。为了方便查找书中的内容，通过对内容建立索引形成目录。</p>
<h3 id="索引有哪些优缺点？"><a href="#索引有哪些优缺点？" class="headerlink" title="索引有哪些优缺点？"></a>索引有哪些优缺点？</h3><p>索引的优点</p>
<ul>
<li>可以大大加快数据的检索速度，这也是创建索引的最主要的原因。</li>
<li>通过使用索引，可以在查询的过程中，使用优化器，提高系统的性能。</li>
</ul>
<p>索引的缺点</p>
<ul>
<li>时间方面：创建索引和维护索引要耗费时间，具体地，当对表中的数据进行增加、删除和修改的时候，索引也要动态的维护，会降低增&#x2F;删&#x2F;改的执行效率；</li>
<li>空间方面：索引需要占物理空间。</li>
</ul>
<h3 id="索引有哪几种类型？"><a href="#索引有哪几种类型？" class="headerlink" title="@$索引有哪几种类型？"></a>@$索引有哪几种类型？</h3><p><strong>主键索引</strong>：数据列不允许重复，不允许为NULL，一个表只能有一个主键。</p>
<p><strong>唯一索引</strong>：数据列不允许重复，允许为NULL值，一个表允许多个列创建唯一索引。</p>
<ul>
<li>可以通过 <code>ALTER TABLE table_name ADD UNIQUE (column);</code> 创建唯一索引</li>
<li>可以通过 <code>ALTER TABLE table_name ADD UNIQUE (column1,column2);</code> 创建唯一组合索引</li>
</ul>
<p><strong>普通索引</strong>：基本的索引类型，没有唯一性的限制，允许为NULL值，一个表允许多个列创建普通索引。</p>
<ul>
<li>可以通过<code>ALTER TABLE table_name ADD INDEX index_name (column);</code>创建普通索引</li>
<li>可以通过<code>ALTER TABLE table_name ADD INDEX index_name(column1, column2, column3);</code>创建组合索引</li>
</ul>
<p><strong>全文索引</strong>：是目前搜索引擎使用的一种关键技术，MyISAM存储引擎才有全文索引。</p>
<ul>
<li>可以通过<code>ALTER TABLE table_name ADD FULLTEXT (column);</code>创建全文索引</li>
</ul>
<h3 id="索引的数据结构（B-树，Hash）"><a href="#索引的数据结构（B-树，Hash）" class="headerlink" title="@$索引的数据结构（B+树，Hash）"></a>@$索引的数据结构（B+树，Hash）</h3><p>在MySQL中使用较多的索引有<strong>Hash索引</strong>，<strong>B+树索引</strong>等，索引的数据结构和具体存储引擎的实现有关，而我们经常使用的InnoDB存储引擎，默认索引实现为：B+树索引。对于哈希索引来说，底层的数据结构就是哈希表，因此在绝大多数需求为单条记录等值查询的时候，可以选择哈希索引，查询性能最快；其余大部分场景，建议选择B+树索引。</p>
<p>1）B+树索引</p>
<p>MySQL通过存储引擎存取数据，基本上90%的人用的就是InnoDB了，按照实现方式分，InnoDB的索引类型目前只有两种：BTREE（B树）索引和HASH索引。B树索引是MySQL数据库中使用最频繁的索引类型，基本所有存储引擎都支持BTree索引。通常我们说的索引不出意外指的就是（B树）索引（实际是用B+树实现的，因为在查看表索引时，mysql一律打印BTREE，所以简称为B树索引）</p>
<p>B+树数据结构</p>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/O8AYEZicmmkmwZEW0CHPKiaicfj0QMyG18ib18jOFrOp9YBiaqOt38p7iadpzl5eRcD7UFWnD1VtooZZ2SG7aYCt5GfA/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1" alt="图片"></p>
<p>众所周知，一颗传统的M阶B+树需要满足以下几个要求：</p>
<ul>
<li><strong>从根节点到叶节点的所有路径都具有相同的长度</strong></li>
<li><strong>所有数据信息都存储在叶子节点，非叶子节点仅作为叶节点的索引存在</strong></li>
<li><strong>叶子节点通过指针连在一起</strong></li>
<li>根节点至少拥有两个子树</li>
<li>每个树节点最多拥有M个子树</li>
<li>每个树节点(除了根节点)拥有至少M&#x2F;2个子树</li>
</ul>
<p>B+树是为了磁盘及其他存储辅助设备而设计的一种平衡查找树(不是二叉树)，在B+树中，所有记录的节点按大小顺序存放在同一层的叶节点中，各叶子节点用指针进行连接，而B+树索引本质上就是B+树在数据库中的实现，与纯粹的B+树数据结构还是有点区别。</p>
<p>B+树与B+树索引的区别如下：</p>
<table>
<thead>
<tr>
<th></th>
<th>B+树</th>
<th>B+树索引</th>
</tr>
</thead>
<tbody><tr>
<td>存储位置</td>
<td>内存</td>
<td>磁盘</td>
</tr>
<tr>
<td>扇出率</td>
<td>低</td>
<td>高</td>
</tr>
<tr>
<td>并发控制</td>
<td>可以不考虑</td>
<td>需考虑</td>
</tr>
<tr>
<td>分裂方向</td>
<td>不需要考虑</td>
<td>向左、向右</td>
</tr>
</tbody></table>
<p>B+树的一些特性：</p>
<p>1、B+树中的B不是代表的二叉（Binary） ，而是代表平衡（Balance），因为B+树是从最早的平衡二叉树演化而来，但是B+树不是一个二叉树。</p>
<p>2、B+树是为磁盘或其他直接存取辅助设备设计的一种平衡查找树，在B+树中，所有的记录节点都是按照键值大小顺序存在同一层的叶子节点，由叶子节点指针进行相连。</p>
<p>3、B+树在数据库中的特点就是高扇出，因此在数据库中B+树的高度一般都在2<del>4层，这也就是说查找一个键值记录时，最多只需要2到4次IO，当前的机械硬盘每秒至少可以有100次IO，2</del>4次IO意味着查询时间只需要0.02~0.04秒。</p>
<p>4、B+树索引并不能找到一个给定键值的具体行，B+树索引能找到的只是被查找的键值所在行的页，然后数据库把页读到内存，再内存中进行查找，最后找到要查找的数据。</p>
<p>5、数据库中B+树索引可以分为，聚簇索引和非聚簇索引，但是不管是聚簇索引还是非聚簇索引，其内部都是B+树实现的，即高度是平衡的，叶子节点存放着所有的数据，聚簇索引和非聚簇索引不同的是，叶子节点是否存储的是一整行信息。每张表只能有一个聚簇索引。</p>
<p>6、B+树的每个数据页（叶子节点）是通过一个双向链表进行链接，数据页上的数据的顺序是按照主键顺序存储的。</p>
<p>2）哈希索引</p>
<p>简要说下，类似于数据结构中简单实现的HASH表（散列表）一样，当我们在MySQL中用哈希索引时，主要就是通过Hash算法（常见的Hash算法有直接定址法、平方取中法、折叠法、除数取余法、随机数法），将数据库字段数据转换成定长的Hash值，与这条数据的行指针一并存入Hash表的对应位置；如果发生Hash碰撞（两个不同关键字的Hash值相同），则在对应Hash键下以链表形式存储。当然这只是简略模拟图。</p>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/O8AYEZicmmkmwZEW0CHPKiaicfj0QMyG18ib2nAmUq8icA9rKtDSVoDyYiaEhXeGfmgNjiciaahstz4gxfAZXVCPaC2zCg/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1" alt="图片"></p>
<h3 id="数据库为什么使用B-树而不是B树"><a href="#数据库为什么使用B-树而不是B树" class="headerlink" title="数据库为什么使用B+树而不是B树"></a>数据库为什么使用B+树而不是B树</h3><ul>
<li><strong>B+树的叶子节点存储了所有的数据，非叶子节点中存储的是比较关键字。而B树所有的节点都会存储数据</strong>。B+树的叶子节点之间存在一个指针连接，B树不存在指针连接。B+树这种设计结构能带来什么好处呢？B+树所有的数据都存储在叶子节点，那么顺着叶子节点从左往右即可完成对数据的遍历，极大了简化了排序操作。这也是mysql设计索引是采用B+树的原因，不仅仅能方便查找，而且有助于排序，在mysql的索引中叶子节点之间数双向链表可正反遍历，更加灵活；</li>
<li><strong>B树只适合随机检索，而B+树同时支持随机检索和顺序检索</strong>；</li>
<li><strong>B+树空间利用率更高，可减少I&#x2F;O次数，磁盘读写代价更低</strong>。一般来说，索引本身也很大，不可能全部存储在内存中，因此索引往往以索引文件的形式存储的磁盘上。这样的话，索引查找过程中就要产生磁盘I&#x2F;O消耗。B+树的内部结点并没有指向关键字具体信息的指针，只是作为索引使用，其内部结点比B树小，盘块能容纳的结点中关键字数量更多，一次性读入内存中可以查找的关键字也就越多，相对的，IO读写次数也就降低了。而IO读写次数是影响索引检索效率的最大因素；</li>
<li><strong>B+树的查询效率更加稳定</strong>。B树搜索有可能会在非叶子结点结束，越靠近根节点的记录查找时间越短，只要找到关键字即可确定记录的存在，其性能等价于在关键字全集内做一次二分查找。而在B+树中，顺序检索比较明显，随机检索时，任何关键字的查找都必须走一条从根节点到叶节点的路，所有关键字的查找路径长度相同，导致每一个关键字的查询效率相当。</li>
<li><strong>B-树在提高了磁盘IO性能的同时并没有解决元素遍历的效率低下的问题。B+树的叶子节点使用指针顺序连接在一起，只要遍历叶子节点就可以实现整棵树的遍历</strong>。而且在数据库中基于范围的查询是非常频繁的，而B树不支持这样的操作。</li>
<li><strong>增删文件（节点）时，效率更高</strong>。因为B+树的叶子节点包含所有关键字，并以有序的链表结构存储，这样可很好提高增删效率。</li>
</ul>
<h3 id="索引算法有哪些？"><a href="#索引算法有哪些？" class="headerlink" title="索引算法有哪些？"></a>索引算法有哪些？</h3><p>索引算法有 BTree算法和Hash算法</p>
<p><strong>BTree算法</strong></p>
<p>BTree是最常用的mysql数据库索引算法，也是mysql默认的算法。因为它不仅可以被用在&#x3D;,&gt;,&gt;&#x3D;,&lt;,&lt;&#x3D;和between这些比较操作符上，而且还可以用于like操作符，只要它的查询条件是一个不以通配符开头的常量， 例如：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">-- 只要它的查询条件是一个不以通配符开头的常量</span><br><span class="line">select * from user where name like &#x27;jack%&#x27;;</span><br><span class="line">-- 如果一通配符开头，或者没有使用常量，则不会使用索引，例如：</span><br><span class="line">select * from user where name like &#x27;%jack&#x27;;</span><br></pre></td></tr></table></figure>

<p><strong>Hash算法</strong></p>
<p>Hash算法只能用于对等比较，例如&#x3D;,&lt;&#x3D;&gt;（相当于&#x3D;）操作符。由于是一次定位数据，不像BTree索引需要从根节点到枝节点，最后才能访问到叶子节点这样多次IO访问，所以检索效率远高于BTree索引。</p>
<h3 id="创建索引的原则？索引设计的原则？"><a href="#创建索引的原则？索引设计的原则？" class="headerlink" title="@$创建索引的原则？索引设计的原则？"></a>@$创建索引的原则？索引设计的原则？</h3><p>索引虽好，但也不是无限制的使用，最好符合以下几个原则</p>
<ol>
<li>为常作为查询条件的字段建立索引，where子句中的列，或者连接子句中指定的列</li>
<li>为经常需要排序、分组操作的字段建立索引</li>
<li>更新频繁字段不适合创建索引</li>
<li>不能有效区分数据的列不适合做索引列(如性别，男女未知，最多也就三种，区分度实在太低)</li>
<li>对于定义为text、image和bit的数据类型的列不要建立索引</li>
<li>最左前缀原则，就是最左边的优先。指的是联合索引中，优先走最左边列的索引。对于多个字段的联合索引，如 index(a,b,c) 联合索引，则相当于创建了 a 单列索引，(a,b)联合索引，和(a,b,c)联合索引（但并不是建立了多个索引树）。mysql会一直向右匹配直到遇到范围查询(&gt;、&lt;、between、like)就停止匹配，比如a &#x3D; 1 and b &#x3D; 2 and c &gt; 3 and d &#x3D; 4 如果建立(a,b,c,d)顺序的索引，d是用不到索引的，如果建立(a,b,d,c)的索引则都可以用到，a,b,d的顺序可以任意调整。使用短索引，如果对长字符串列进行索引，应该指定一个前缀长度，这样能够节省大量索引空间</li>
<li>非空字段：应该指定列为NOT NULL，除非你想存储NULL。在mysql中，含有空值的列很难进行查询优化，因为它们使得索引、索引的统计信息以及比较运算更加复杂。你应该用0、一个特殊的值或者一个空串代替空值</li>
<li>不要过度索引。索引需要额外的磁盘空间，并降低写操作的性能。在修改表内容的时候，索引会进行更新甚至重构，索引列越多，这个时间就会越长</li>
</ol>
<h3 id="什么情况使用了索引，查询还是慢"><a href="#什么情况使用了索引，查询还是慢" class="headerlink" title="什么情况使用了索引，查询还是慢"></a>什么情况使用了索引，查询还是慢</h3><ul>
<li>索引全表扫描</li>
<li>索引过滤性不好</li>
<li>频繁回表的开销</li>
</ul>
<h3 id="MySQL使用自增主键的好处"><a href="#MySQL使用自增主键的好处" class="headerlink" title="MySQL使用自增主键的好处"></a>MySQL使用自增主键的好处</h3><ol>
<li>自增主键按顺序存放，增删数据速度快，对于检索非常有利；</li>
<li>数字型，占用空间小，易排序；</li>
<li>使用整形才可以使用AUTO_INCREAMENT，不用担心主键重复问题。</li>
</ol>
<h3 id="什么是聚簇索引？何时使用聚簇索引与非聚簇索引"><a href="#什么是聚簇索引？何时使用聚簇索引与非聚簇索引" class="headerlink" title="@$什么是聚簇索引？何时使用聚簇索引与非聚簇索引"></a>@$什么是聚簇索引？何时使用聚簇索引与非聚簇索引</h3><p><img src="https://mmbiz.qpic.cn/mmbiz_png/O8AYEZicmmkmwZEW0CHPKiaicfj0QMyG18ibic1ToFqwthIpTJbTa21gMEcGTqk5JQclQumIEjJV35EJLyfM9365Rbg/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1" alt="图片"></p>
<ul>
<li>聚簇索引：将数据与索引放到了一块，索引结构的叶子节点存储了行数据，找到索引也就找到了数据</li>
<li>非聚簇索引：将数据与索引分开存储，索引结构的叶子节点存储的是行数据的地址</li>
</ul>
<p>聚簇索引的优点</p>
<ul>
<li>数据访问更快。聚族索引将索引和数据保存在同一个B+树中，因此从聚族索引中获取数据通常比非聚族索引中查找更快。</li>
<li>当你需要取出一定范围内的数据时，用聚簇索引也比用非聚簇索引好。</li>
<li>使用覆盖索引扫描的查询可以直接使用节点中的主键值。</li>
</ul>
<p>聚簇索引的缺点</p>
<ul>
<li>插入速度严重依赖于插入顺序，按照主键的顺序插入是最快的方式，否则将会出现页分裂，严重影响性能。因此，对于InnoDB表，我们一般都会定义一个自增的ID列作为主键。</li>
<li>更新主键的代价很高，因为将会导致被更新的行移动。因此，对于InnoDB表，我们一般定义主键为不可更新。</li>
<li>通过辅助索引访问需要两次索引查找，第一次找到主键值，第二次根据主键值找到行数据。</li>
</ul>
<p><strong>几个概念</strong></p>
<ul>
<li>对于普通索引，如 name 字段，则需要根据 name 字段的索引树（非聚簇索引）找到叶子节点对应的主键，然后再通过主键去主键索引树查询一遍，才可以得到要找的记录，这就叫<strong>回表查询</strong>。先定位主键值，再定位行记录，它的性能较扫描一遍索引树的效率更低</li>
<li>InnoDB的行锁是建立在索引的基础之上的，行锁锁的是索引，不是数据，所以提高并发写的能力要在查询字段添加索引</li>
<li>主索引和辅助索引：主索引就是主键索引，辅助索引就是根据业务需要，自己设置的普通的非主键的索引。这个在Myisam里面区别不大，但是在Innodb的时候差别很大</li>
<li>聚簇索引：Innodb的主索引采用的是聚簇索引，一个表只能有1个聚簇索引，因为表数据存储的物理位置是唯一的。聚簇索引的value存的就是真实的数据，不是数据的地址。主索引树里面包含了真实的数据。key是主键值，value值就是data，key值按照B+树的规则分散排布的叶子节点。</li>
<li>非聚簇索引：Myisam的主索引和辅助索引都采用的是非聚簇索引，索引和表数据是分离的，索引的value值存储的是行数据的地址。</li>
<li>Innodb的索引：主索引采用聚簇索引，叶子节点的value值，直接存储的真实的数据。辅助索引是非聚簇索引，value值指向主索引的位置。所以在Innodb中，根据辅助索引查询值需要遍历2次B+树，同时主键的长度越短越好，越短辅助索引的value值就越小。Innodb中根据主键进行范围查询，会特别快。</li>
<li>Myisam的索引：主索引和辅助索引都是非聚簇索引</li>
<li>B+树：不管是什么索引，在mysql中的数据结构都是B+树的结构，可以充分利用数据块，来减少IO查询的次数，提升查询的效率。一个数据块data里面，存储了很多个相邻key的value值，所有的非叶子节点都不存储数据，都是指针。</li>
<li>mysql采用B+树的优点：IO读取次数少（每次都是页读取），范围查找更快捷（相邻页之间有指针）</li>
</ul>
<h3 id="联合索引是什么？组合索引是什么？"><a href="#联合索引是什么？组合索引是什么？" class="headerlink" title="联合索引是什么？组合索引是什么？"></a>联合索引是什么？组合索引是什么？</h3><p>MySQL可以使用多个字段组合建立一个索引，叫做联合索引。在联合索引中，如果想要命中索引，需要按照建立索引时的字段顺序挨个使用，否则无法命中索引。</p>
<h3 id="联合索引数据结构和实现原理，使用联合索引是怎么进行查询的"><a href="#联合索引数据结构和实现原理，使用联合索引是怎么进行查询的" class="headerlink" title="@$联合索引数据结构和实现原理，使用联合索引是怎么进行查询的"></a>@$联合索引数据结构和实现原理，使用联合索引是怎么进行查询的</h3><p>假设，我们对(a,b)字段建立索引，那么入下图所示</p>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/O8AYEZicmmkmwZEW0CHPKiaicfj0QMyG18ibyagvhrcABTcVOHoYbMDbMVRuxAjgJibq1SVDVfOA0gX1w7q7KBWmQ1Q/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1" alt="图片"></p>
<p>如上图所示他们是按照a来进行排序，在a相等的情况下，才按b来排序。</p>
<p>因此，我们可以看到a是有序的1，1，2，2，3，3。而b是一种全局无序，局部相对有序状态！什么意思呢？</p>
<p>从全局来看，b的值为1，2，1，4，1，2，是无序的，因此直接执行<code>b = 2</code>这种查询条件没有办法利用索引。</p>
<p>从局部来看，当a的值确定的时候，b是有序的。例如a &#x3D; 1时，b值为1，2是有序的状态。当a&#x3D;2时候，b的值为1,4也是有序状态。因此，你执行<code>a = 1 and b = 2</code>是a,b字段能用到索引的。而你执行<code>a &gt; 1 and b = 2</code>时，a字段能用到索引，b字段用不到索引。因为a的值此时是一个范围，不是固定的，在这个范围内b值不是有序的，因此b字段用不上索引。</p>
<p>综上所示，最左匹配原则，在遇到范围查询的时候，就会停止匹配。</p>
<h3 id="什么是最左前缀原则？什么是最左匹配原则？为什么需要注意联合索引中的顺序？"><a href="#什么是最左前缀原则？什么是最左匹配原则？为什么需要注意联合索引中的顺序？" class="headerlink" title="@$什么是最左前缀原则？什么是最左匹配原则？为什么需要注意联合索引中的顺序？"></a>@$什么是最左前缀原则？什么是最左匹配原则？为什么需要注意联合索引中的顺序？</h3><ul>
<li>最左前缀原则，就是最左边的优先。指的是联合索引中，优先走最左边列的索引。对于多个字段的联合索引，如 index(a,b,c) 联合索引，则相当于创建了 a 单列索引，(a,b)联合索引，和(a,b,c)联合索引（但并不是建立了多个索引树）。mysql会一直向右匹配直到遇到范围查询(&gt;、&lt;、between、like)就停止匹配，比如a &#x3D; 1 and b &#x3D; 2 and c &gt; 3 and d &#x3D; 4 如果建立(a,b,c,d)顺序的索引，d是用不到索引的，如果建立(a,b,d,c)的索引则都可以用到，a,b,d的顺序可以任意调整。</li>
<li>&#x3D;和in可以乱序，比如a &#x3D; 1 and b &#x3D; 2 and c &#x3D; 3 建立(a,b,c)索引可以任意顺序，mysql的查询优化器会帮你优化成索引可以识别的形式。</li>
<li>如果建立的索引顺序是 (a,b) 那么直接采用 where b &#x3D; 5 这种查询条件是无法利用到索引的，这一条最能体现最左匹配的特性。</li>
</ul>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><h2 id="什么是索引"><a href="#什么是索引" class="headerlink" title="什么是索引"></a>什么是索引</h2><p>mysql的一种数据结构,innodb用B+树实现,通俗的说为了提高查询效率的一种目录</p>
<h2 id="索引优缺点"><a href="#索引优缺点" class="headerlink" title="索引优缺点"></a>索引优缺点</h2><p>B+树索引存在磁盘上</p>
<p>优点:极大提高速度</p>
<h1 id="MySQL数据类型精讲"><a href="#MySQL数据类型精讲" class="headerlink" title="MySQL数据类型精讲"></a>MySQL数据类型精讲</h1><p>1.MySQL中的数据类型</p>
<p>常见数据类型的属性，如下：</p>
<p>2.整数类型<br>2.1 类型介绍<br>整数类型一共有 5 种，包括 TINYINT、SMALLINT、MEDIUMINT、INT（INTEGER）和 BIGINT</p>
<p>2.2可选属性<br>整数类型的可选属性有三个：</p>
<p>2.2.1 M<br>M : 表示显示宽度，M的取值范围是(0, 255)。例如，int(5)：当数据宽度小于5位的时候在数字前面需要用字符填满宽度。该项功能需要配合“ ZEROFILL ”使用，表示用“0”填满宽度，否则指定显示宽度无效。</p>
<p>如果设置了显示宽度，那么插入的数据宽度超过显示宽度限制，会不会截断或插入失败？</p>
<p>答案：不会对插入的数据有任何影响，还是按照类型的实际宽度进行保存，即 显示宽度与类型可以存储的 值范围无关 。从MySQL 8.0.17开始，整数数据类型不推荐使用显示宽度属性。整型数据类型可以在定义表结构时指定所需要的显示宽度，如果不指定，则系统为每一种类型指定默认的宽度值。</p>
<p>举例：</p>
<p>CREATE TABLE test_int1 ( x TINYINT, y SMALLINT, z MEDIUMINT, m INT, n BIGINT );</p>
<p>查看表结构 （MySQL5.7中显式如下，MySQL8中不再显式范围）</p>
<p>TINYINT有符号数和无符号数的取值范围分别为-128127和0255，由于负号占了一个数字位，因此TINYINT默认的显示宽度为4。同理，其他整数类型的默认显示宽度与其有符号数的最小值的宽度相同。</p>
<p>举例：</p>
<p>CREATE TABLE test_int2(<br>    f1 INT,<br>    f2 INT(5),<br>    f3 INT(5) ZEROFILL )<br>DESC test_int2;<br>INSERT INTO test_int2(f1,f2,f3)<br>VALUES(1,123,123);<br>INSERT INTO test_int2(f1,f2)<br>VALUES(123456,123456);<br>INSERT INTO test_int2(f1,f2,f3)<br>VALUES(123456,123456,123456)<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11</p>
<p>2.2.2 UNSIGNED<br>UNSIGNED : 无符号类型（非负），所有的整数类型都有一个可选的属性UNSIGNED（无符号属性），无符号整数类型的最小取值为0。所以，如果需要在MySQL数据库中保存非负整数值时，可以将整数类型设置为无符号类型。</p>
<p>int类型默认显示宽度为int(11)，无符号int类型默认显示宽度为int(10)。</p>
<p>2.2.3 ZEROFILL<br>ZEROFILL : 0填充,（如果某列是ZEROFILL，那么MySQL会自动为当前列添加UNSIGNED属性），如果指定了ZEROFILL只是表示不够M位时，用0在左边填充，如果超过M位，只要不超过数据存储范围即可。原来，在 int(M) 中，M 的值跟 int(M) 所占多少存储空间并无任何关系。 int(3)、int(4)、int(8) 在磁盘上都是占用 4 bytes 的存储空间。也就是说，int(M) ，必须和 UNSIGNED ZEROFILL <strong>一起使用才有意义。</strong>如果整数值超过M位，就按照实际位数存储。只是无须再用字符 0 进行填充。</p>
<p>2.3使用场景<br>TINYINT ：一般用于枚举数据，比如系统设定取值范围很小且固定的场景。<br>SMALLINT ：可以用于较小范围的统计数据，比如统计工厂的固定资产库存数量等。<br>MEDIUMINT ：用于较大整数的计算，比如车站每日的客流量等<br>INT、INTEGER ：取值范围足够大，一般情况下不用考虑超限问题，用得最多。比如商品编号。<br>BIGINT ：只有当你处理特别巨大的整数时才会用到。比如双十一的交易量、大型门户网站点击量、证券公司衍生产品持仓等<br>2.4如何选择<br>在评估用哪种整数类型的时候，你需要考虑 存储空间 和 可靠性 的平衡问题：一方 面，用占用字节数少的整数类型可以节省存储空间；另一方面，要是为了节省存储空间， 使用的整数类型取值范围太小，一旦遇到超出取值范围的情况，就可能引起 系统错误 ，影响可靠性。举个例子，商品编号采用的数据类型是 INT。原因就在于，客户门店中流通的商品种类较多，而且，每天都有旧商品下架，新商品上架，这样不断迭代，日积月累。如果使用 SMALLINT 类型，虽然占用字节数比 INT 类型的整数少，但是却不能保证数据不会超出范围65535。相反，使用 INT，就能确保有足够大的取值范围，不用担心数据超出范围影响可靠性的问题。你要注意的是，在实际工作中，系统故障产生的成本远远超过增加几个字段存储空间所产生的成本。因此，我建议你首先确保数据不会超过取值范围，在这个前提之下，再去考虑如何节省存储空间。</p>
<p>3.浮点类型<br>3.1类型介绍<br>浮点数和定点数类型的特点是可以 处理小数 ，你可以把整数看成小数的一个特例。因此，浮点数和定点数的使用场景，比整数大多了。 MySQL支持的浮点数类型，分别是 FLOAT、DOUBLE、REAL。</p>
<p>FLOAT 表示单精度浮点数；</p>
<p>DOUBLE 表示双精度浮点数；</p>
<p>REAL默认就是 DOUBLE。如果你把 SQL 模式设定为启用“ REAL_AS_FLOAT ”，那 么，MySQL 就认为REAL 是 FLOAT。如果要启用“REAL_AS_FLOAT”，可以通过以下 SQL 语句实现：</p>
<p>SET sql_mode &#x3D; “REAL_AS_FLOAT”;</p>
<p>问题1： FLOAT 和 DOUBLE 这两种数据类型的区别是啥呢？</p>
<p>FLOAT 占用字节数少，取值范围小；DOUBLE 占用字节数多，取值范围也大。</p>
<p><strong>问题2：</strong>为什么浮点数类型的无符号数取值范围，只相当于有符号数取值范围的一半，也就是只相当于有符号数取值范围大于等于零的部分呢？</p>
<p>MySQL 存储浮点数的格式为： 符号(S) 、 尾数(M) 和 阶码(E) 。因此，无论有没有符号，MySQL 的浮点数都会存储表示符号的部分。因此， 所谓的无符号数取值范围，其实就是有符号数取值范围大于等于零的部分。</p>
<p>3.2 数据精度说明<br>对于浮点类型，在MySQL中单精度值使用 4 个字节，双精度值使用 8 个字节。</p>
<p>MySQL允许使用 非标准语法 （其他数据库未必支持，因此如果涉及到数据迁移，则最好不要这么</p>
<p>用）： FLOAT(M,D) 或 DOUBLE(M,D) 。这里，M称为 精度 ，D称为 标度 。(M,D)中 M&#x3D;整数位+小数位，D&#x3D;小数位。 D&lt;&#x3D;M&lt;&#x3D;255，0&lt;&#x3D;D&lt;&#x3D;30。</p>
<p>例如，定义为FLOAT(5,2)的一个列可以显示为-999.99-999.99。如果超过这个范围会报错。</p>
<p>FLOAT和DOUBLE类型在不指定(M,D)时，默认会按照实际的精度（由实际的硬件和操作系统决定）来显示。</p>
<p>说明：浮点类型，也可以加 UNSIGNED ，但是不会改变数据范围，例如：FLOAT(3,2) UNSIGNED仍然只能表示0-9.99的范围。</p>
<p>不管是否显式设置了精度(M,D)，这里MySQL的处理方案如下：</p>
<p>如果存储时，整数部分超出了范围，MySQL就会报错，不允许存这样的值<br>如果存储时，小数点部分若超出范围，就分以下情况：<br>若四舍五入后，整数部分没有超出范围，则只警告，但能成功操作并四舍五入删除多余的小数位后保存。例如在FLOAT(5,2)列内插入999.009，近似结果是999.01。<br>若四舍五入后，整数部分超出范围，则MySQL报错，并拒绝处理。如FLOAT(5,2)列内插入999.995和-999.995都会报错。<br>从MySQL 8.0.17开始，FLOAT(M,D) 和DOUBLE(M,D)用法在官方文档中已经明确不推荐使用，将来可能被移除。另外，关于浮点型FLOAT和DOUBLE的UNSIGNED也不推荐使用了，将来也可能被移除</p>
<p>举例</p>
<p>CREATE TABLE test_double1(<br>    f1 FLOAT,<br>    f2 FLOAT(5,2),<br>    f3 DOUBLE,<br>    f4 DOUBLE(5,2)<br>);<br>DESC test_double1;<br>INSERT INTO test_double1 VALUES(123.456,123.456,123.4567,123.45);<br>#Out of range value for column ‘f2’ at row 1<br>INSERT INTO test_double1 VALUES(123.456,1234.456,123.4567,123.45);<br>SELECT * FROM test_double1;<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>3.3精度误差说明<br>浮点数类型有个缺陷，就是不精准。下面我来重点解释一下为什么 MySQL 的浮点数不够精准。比如，我们设计一个表，有f1这个字段，插入值分别为0.47,0.44,0.19，我们期待的运行结果是：0.47 + 0.44 + 0.19 &#x3D; 1.1。而使用sum之后查询：</p>
<p>CREATE TABLE test_double2(<br>f1 DOUBLE<br>);<br>INSERT INTO test_double2 VALUES(0.47),(0.44),(0.19);<br>1<br>2<br>3<br>4</p>
<p>查询结果是 1.0999999999999999。看到了吗？虽然误差很小，但确实有误差。 你也可以尝试把数据类型改成 FLOAT，然后运行求和查询，得到的是， 1.0999999940395355。显然，误差更大了。</p>
<p>那么，为什么会存在这样的误差呢？问题还是出在 MySQL 对浮点类型数据的存储方式上。</p>
<p>MySQL 用 4 个字节存储 FLOAT 类型数据，用 8 个字节来存储 DOUBLE 类型数据。无论哪个，都是采用二进制的方式来进行存储的。比如 9.625，用二进制来表达，就是 1001.101，或者表达成 1.001101×2^3。如果尾数不是 0 或 5（比如 9.624），你就无法用一个二进制数来精确表达。进而，就只好在取值允许的范围内进行四舍五入。</p>
<p>在编程中，如果用到浮点数，要特别注意误差问题，因为浮点数是不准确的，所以我们要避免使用“&#x3D;”来<strong>判断两个数是否相等。</strong>同时，在一些对精确度要求较高的项目中，千万不要使用浮点数，不然会导致结果错误，甚至是造成不可挽回的损失。那么，MySQL 有没有精准的数据类型呢？当然有，这就是定点数类型： DECIMAL 。</p>
<p>4.定点数类型<br>4.1 类型介绍<br>MySQL中的定点数类型只有 DECIMAL 一种类型。</p>
<p>使用 DECIMAL(M,D) 的方式表示高精度小数。其中，M被称为精度，D被称为标度。0&lt;&#x3D;M&lt;&#x3D;65， 0&lt;&#x3D;D&lt;&#x3D;30，D&lt;M。例如，定义DECIMAL（5,2）的类型，表示该列取值范围是-999.99~999.99。</p>
<p>DECIMAL(M,D) 的最大取值范围与 DOUBLE 类型一样，但是有效的数据范围是由M和D决定的。DECIMAL 的存储空间并不是固定的，由精度值M决定，总共占用的存储空间为M+2个字节。也就是说，在一些对精度要求不高的场景下，比起占用同样字节长度的定点数，浮点数表达的数值范围可以更大一些。</p>
<p>定点数在MySQL内部是以 字符串 的形式进行存储，这就决定了它一定是精准的。</p>
<p>当DECIMAL类型不指定精度和标度时，其默认为DECIMAL(10,0)。当数据的精度超出了定点数类型的精度范围时，则MySQL同样会进行四舍五入处理。</p>
<p>浮点数 vs 定点数</p>
<p>浮点数相对于定点数的优点是在长度一定的情况下，浮点类型取值范围大，但是不精准，适用于需要取值范围大，又可以容忍微小误差的科学计算场景（比如计算化学、分子建模、流体动力学等）<br>定点数类型取值范围相对小，但是精准，没有误差，适合于对精度要求极高的场景 （比如涉及金额计算的场景）<br>举例</p>
<p>CREATE TABLE test_decimal1(<br>    f1 DECIMAL,<br>    f2 DECIMAL(5,2)<br>);<br>DESC test_decimal1;<br>INSERT INTO test_decimal1(f1,f2) VALUES(123.123,123.456);<br>#Out of range value for column ‘f2’ at row 1<br>INSERT INTO test_decimal1(f2) VALUES(1234.34)<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8</p>
<p>举例</p>
<p>我们运行下面的语句，把test_double2表中字段“f1”的数据类型修改为 DECIMAL(5,2)：</p>
<p>ALTER TABLE test_double2<br>MODIFY f1 DECIMAL(5,2);<br>1<br>2<br>然后，我们再一次运行求和语句：</p>
<p>4.2开发中经验<br>“由于 DECIMAL 数据类型的精准性，在我们的项目中，除了极少数（比如商品编号）用到整数类型外，其他的数值都用的是 DECIMAL，原因就是这个项目所处的零售行业，要求精准，一分钱也不能差。 ” ——来自某项目经理</p>
<p>5.位类型：BIT<br>BIT类型中存储的是二进制值，类似010110。</p>
<p>BIT类型，如果没有指定(M)，默认是1位。这个1位，表示只能存1位的二进制值。这里(M)是表示二进制的位数，位数最小值为1，最大值为64。</p>
<p>CREATE TABLE test_bit1(<br>    f1 BIT,<br>    f2 BIT(5),<br>    f3 BIT(64)<br>);<br>INSERT INTO test_bit1(f1) VALUES(1);<br>#Data too long for column ‘f1’ at row 1<br>INSERT INTO test_bit1(f1) VALUES(2);<br>INSERT INTO test_bit1(f2) VALUES(23);<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>注意：在向BIT类型的字段中插入数据时，一定要确保插入的数据在BIT类型支持的范围内。</p>
<p>使用SELECT命令查询位字段时，可以用 BIN() 或 HEX() 函数进行读取。</p>
<p>可以看到，使用b+0查询数据时，可以直接查询出存储的十进制数据的值。</p>
<p>6.日期与时间类型<br>日期与时间是重要的信息，在我们的系统中，几乎所有的数据表都用得到。原因是客户需要知道数据的时间标签，从而进行数据查询、统计和处理。MySQL有多种表示日期和时间的数据类型，不同的版本可能有所差异，MySQL8.0版本支持的日期和时间类型主要有：YEAR类型、TIME类型、DATE类型、DATETIME类型和TIMESTAMP类型。</p>
<p>YEAR 类型通常用来表示年<br>DATE 类型通常用来表示年、月、日<br>TIME 类型通常用来表示时、分、秒<br>DATETIME 类型通常用来表示年、月、日、时、分、秒<br>TIMESTAMP 类型通常用来表示带时区的年、月、日、时、分、秒</p>
<p>可以看到，不同数据类型表示的时间内容不同、取值范围不同，而且占用的字节数也不一样，你要根据实际需要灵活选取。为什么时间类型 TIME 的取值范围不是 -23:59:59～23:59:59 呢？原因是 MySQL 设计的 TIME 类型，不光表示一天之内的时间，而且可以用来表示一个时间间隔，这个时间间隔可以超过 24 小时。</p>
<p>6.1 YEAR类型<br>YEAR类型用来表示年份，在所有的日期时间类型中所占用的存储空间最小，只需要 1个字节 的存储空间。在MySQL中，YEAR有以下几种存储格式：</p>
<p>以4位字符串或数字格式表示YEAR类型，其格式为YYYY，最小值为1901，最大值为2155。<br>以2位字符串格式表示YEAR类型，最小值为00，最大值为99。<br>当取值为01到69时，表示2001到2069；<br>当取值为70到99时，表示1970到1999；<br>当取值整数的0或00添加的话，那么是0000年；<br>当取值是日期&#x2F;字符串的’0’添加的话，是2000年<br>从MySQL5.5.27开始，2位格式的YEAR已经不推荐使用。YEAR默认格式就是“YYYY”，没必要写成YEAR(4)，</p>
<p>从MySQL 8.0.19开始，不推荐使用指定显示宽度的YEAR(4)数据类型。</p>
<p>CREATE TABLE test_year(<br>    f1 YEAR,<br>    f2 YEAR(4)<br>);<br>1<br>2<br>3<br>4</p>
<p>6.2 DATE类型<br>DATE类型表示日期，没有时间部分，格式为 YYYY-MM-DD ，其中，YYYY表示年份，MM表示月份，DD表示日期。需要 3个字节 的存储空间。在向DATE类型的字段插入数据时，同样需要满足一定的格式条件。</p>
<p>以 YYYY-MM-DD 格式或者 YYYYMMDD 格式表示的字符串日期，其最小取值为1000-01-01，最大取值为9999-12-03。YYYYMMDD格式会被转化为YYYY-MM-DD格式。<br>以 YY-MM-DD 格式或者 YYMMDD 格式表示的字符串日期，此格式中，年份为两位数值或字符串满足YEAR类型的格式条件为：当年份取值为00到69时，会被转化为2000到2069；当年份取值为70到99时，会被转化为1970到1999。<br>使用 CURRENT_DATE() 或者 NOW() 函数，会插入当前系统的日期。<br>举例：</p>
<p>创建数据表，表中只包含一个DATE类型的字段f1。</p>
<p>CREATE TABLE test_date1(<br>    f1 DATE<br>);<br>Query OK, 0 rows affected (0.13 sec)<br>#插入数据：<br>INSERT INTO test_date1<br>VALUES (‘2020-10-01’), (‘20201001’),(20201001); </p>
<p>INSERT INTO test_date1<br>VALUES (‘00-01-01’), (‘000101’), (‘69-10-01’), (‘691001’), (‘70-01-01’), (‘700101’), (‘99-01-01’), (‘990101’);</p>
<p>INSERT INTO test_date1<br>VALUES (000301), (690301), (700301), (990301);</p>
<p>INSERT INTO test_date1<br>VALUES (CURRENT_DATE()), (NOW()); </p>
<p>SELECT * FROM test_date1;</p>
<p>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>15<br>16<br>17<br>18<br>6.3 TIME类型<br>TIME类型用来表示时间，不包含日期部分。在MySQL中，需要 3个字节 的存储空间来存储TIME类型的数据，可以使用“HH:MM:SS”格式来表示TIME类型，其中，HH表示小时，MM表示分钟，SS表示秒。</p>
<p>在MySQL中，向TIME类型的字段插入数据时，也可以使用几种不同的格式。 （1）可以使用带有冒号的字符串，比如’ D HH:MM:SS’ 、’ HH:MM:SS ‘、’ HH:MM ‘、’ D HH:MM ‘、’ D HH ‘或’ SS ‘格式，都能被正确地插入TIME类型的字段中。其中D表示天，其最小值为0，最大值为34。如果使用带有D格式的字符串插入TIME类型的字段时，D会被转化为小时，计算格式为D*24+HH。当使用带有冒号并且不带D的字符串表示时间时，表示当天的时间，比如12:10表示12:10:00，而不是00:12:10。 （2）可以使用不带有冒号的字符串或者数字，格式为’ HHMMSS ‘或者 HHMMSS 。如果插入一个不合法的字符串或者数字，MySQL在存储数据时，会将其自动转化为00:00:00进行存储。比如1210，MySQL会将最右边的两位解析成秒，表示00:12:10，而不是12:10:00。 （3）使用 CURRENT_TIME() 或者 NOW() ，会插入当前系统的时间。</p>
<p>举例：</p>
<p>创建数据表，表中包含一个TIME类型的字段f1。</p>
<p>CREATE TABLE test_time1(<br>    f1 TIME<br>);<br>Query OK, 0 rows affected (0.02 sec)<br>INSERT INTO test_time1<br>VALUES(‘2 12:30:29’), (‘12:35:29’), (‘12:40’), (‘2 12:40’),(‘1 05’), (‘45’);<br>INSERT INTO test_time1<br>VALUES (‘123520’), (124011),(1210);<br>INSERT INTO test_time1 VALUES (NOW()), (CURRENT_TIME());<br>SELECT * FROM test_time1;<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>6.4 DATETIME<br>DATETIME类型在所有的日期时间类型中占用的存储空间最大，总共需要 8 个字节的存储空间。在格式上为DATE类型和TIME类型的组合，可以表示为 YYYY-MM-DD HH:MM:SS ，其中YYYY表示年份，MM表示月份，DD表示日期，HH表示小时，MM表示分钟，SS表示秒。在向DATETIME类型的字段插入数据时，同样需要满足一定的格式条件。</p>
<p>以 YYYY-MM-DD HH:MM:SS 格式或者 YYYYMMDDHHMMSS 格式的字符串插入DATETIME类型的字段时，最小值为1000-01-01 00:00:00，最大值为9999-12-03 23:59:59<br>以YYYYMMDDHHMMSS格式的数字插入DATETIME类型的字段时，会被转化为YYYY-MM-DD HH:MM:SS格式。<br>以 YY-MM-DD HH:MM:SS 格式或者 YYMMDDHHMMSS 格式的字符串插入DATETIME类型的字段时，两位数的年份规则符合YEAR类型的规则，00到69表示2000到2069；70到99表示1970到1999。<br>使用函数 CURRENT_TIMESTAMP() 和 NOW() ，可以向DATETIME类型的字段插入系统的当前日期和时间。<br>举例：</p>
<p>#创建数据表，表中包含一个DATETIME类型的字段dt。<br>CREATE TABLE test_datetime1(<br>    dt DATETIME<br>);<br>Query OK, 0 rows affected (0.02 sec)<br>#插入数据：<br>INSERT INTO test_datetime1<br>VALUES (‘2021-01-01 06:50:30’), (‘20210101065030’);<br>INSERT INTO test_datetime1<br>VALUES (‘99-01-01 00:00:00’), (‘990101000000’), (‘20-01-01 00:00:00’), (‘200101000000’);<br>INSERT INTO test_datetime1<br>VALUES (20200101000000), (200101000000), (19990101000000), (990101000000);<br>INSERT INTO test_datetime1 VALUES (CURRENT_TIMESTAMP()), (NOW());<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>6.5 TIMESTAMP类型<br>TIMESTAMP类型也可以表示日期时间，其显示格式与DATETIME类型相同，都是 YYYY-MM-DD HH:MM:SS ，需要4个字节的存储空间。但是TIMESTAMP存储的时间范围比DATETIME要小很多，只能存储“1970-01-01 00:00:01 UTC”到“2038-01-19 03:14:07 UTC”之间的时间。其中，UTC表示世界统一时间，也叫作世界标准时间。</p>
<p>存储数据的时候需要对当前时间所在的时区进行转换，查询数据的时候再将时间转换回当前的时区。因此，使用TIMESTAMP存储的同一个时间值，在不同的时区查询时会显示不同的时间。<br>向TIMESTAMP类型的字段插入数据时，当插入的数据格式满足YY-MM-DD HH:MM:SS和YYMMDDHHMMSS时，两位数值的年份同样符合YEAR类型的规则条件，只不过表示的时间范围要小很多。如果向TIMESTAMP类型的字段插入的时间超出了TIMESTAMP类型的范围，则MySQL会抛出错误信息。</p>
<p>举例：</p>
<p>#创建数据表，表中包含一个TIMESTAMP类型的字段ts。<br>CREATE TABLE test_timestamp1(<br>    ts TIMESTAMP<br>);<br>#插入数据：<br>INSERT INTO test_timestamp1<br>VALUES (‘1999-01-01 03:04:50’), (‘19990101030405’), (‘99-01-01 03:04:05’), (‘990101030405’);<br>INSERT INTO test_timestamp1<br>VALUES (‘2020@01@01@00@00@00’), (‘20@01@01@00@00@00’);<br>INSERT INTO test_timestamp1<br>VALUES (CURRENT_TIMESTAMP()), (NOW());<br>#Incorrect datetime value<br>INSERT INTO test_timestamp1 VALUES (‘2038-01-20 03:14:07’);<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>TIMESTAMP和DATETIME的区别：</p>
<p>TIMESTAMP存储空间比较小，表示的日期时间范围也比较小<br>底层存储方式不同，TIMESTAMP底层存储的是毫秒值，距离1970-1-1 0:0:0 0毫秒的毫秒值。<br>两个日期比较大小或日期计算时，TIMESTAMP更方便、更快。<br>TIMESTAMP和时区有关。TIMESTAMP会根据用户的时区不同，显示不同的结果。而DATETIME则只能反映出插入时当地的时区，其他时区的人查看数据必然会有误差的。</p>
<p>6.6 开发中经验<br>用得最多的日期时间类型，就是 DATETIME 。虽然 MySQL 也支持 YEAR（年）、 TIME（时间）、DATE（日期），以及 TIMESTAMP 类型，但是在实际项目中，尽量用 DATETIME 类型。因为这个数据类型包括了完整的日期和时间信息，取值范围也最大，使用起来比较方便。毕竟，如果日期时间信息分散在好几个字段，很不容易记，而且查询的时候，SQL 语句也会更加复杂。此外，一般存注册时间、商品发布时间等，不建议使用DATETIME存储，而是使用 时间戳 ，因为DATETIME虽然直观，但不便于计算。</p>
<p>7.文本字符串类型<br>在实际的项目中，我们还经常遇到一种数据，就是字符串数据。</p>
<p>MySQL中，文本字符串总体上分为 CHAR 、 VARCHAR 、 TINYTEXT 、 TEXT 、MEDIUMTEXT 、 LONGTEXT 、 ENUM 、 SET 等类型</p>
<p>7.1CHAR与VARCHAR类型<br>CHAR和VARCHAR类型都可以存储比较短的字符串。</p>
<p>CHAR类型：</p>
<p>CHAR(M) 类型一般需要预先定义字符串长度。如果不指定(M)，则表示长度默认是1个字符。<br>如果保存时，数据的实际长度比CHAR类型声明的长度小，则会在 右侧填充 空格以达到指定的长度。当MySQL检索CHAR类型的数据时，CHAR类型的字段会去除尾部的空格。<br>定义CHAR类型字段时，声明的字段长度即为CHAR类型字段所占的存储空间的字节数。<br>CREATE TABLE test_char1(<br>    c1 CHAR,<br>    c2 CHAR(5)<br>);<br>DESC test_char1;</p>
<p>INSERT INTO test_char1<br>VALUES(‘a’,’Tom’);</p>
<p>SELECT c1,CONCAT(c2,’***’)<br>FROM test_char1; </p>
<p>INSERT INTO test_char1(c2)<br>VALUES(‘a ‘); </p>
<p>SELECT CHAR_LENGTH(c2)<br>FROM test_char1;<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>15<br>16<br>17<br>VARCHAR类型：</p>
<p>VARCHAR(M) 定义时， 必须指定 长度M，否则报错。<br>MySQL4.0版本以下，varchar(20)：指的是20字节，如果存放UTF8汉字时，只能存6个（每个汉字3字节） ；MySQL5.0版本以上，varchar(20)：指的是20字符。<br>检索VARCHAR类型的字段数据时，会保留数据尾部的空格。VARCHAR类型的字段所占用的存储空间为字符串实际长度加1个字节。<br>CREATE TABLE test_varchar1(<br>    NAME VARCHAR #错误<br>);<br>#Column length too big for column ‘NAME’ (max &#x3D; 21845);<br>CREATE TABLE test_varchar2(<br>    NAME VARCHAR(65535) #错误<br>)<br>CREATE TABLE test_varchar3(<br>    NAME VARCHAR(5)<br>);<br>INSERT INTO test_varchar3<br>VALUES(‘尚硅谷’),(‘尚硅谷教育’);<br>#Data too long for column ‘NAME’ at row 1<br>INSERT INTO test_varchar3 VALUES(‘尚硅谷IT教育’)<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>哪些情况使用 CHAR 或 VARCHAR 更好</p>
<p>情况1：存储很短的信息。比如门牌号码101，201……这样很短的信息应该用char，因为varchar还要占个byte用于存储信息长度，本来打算节约存储的，结果得不偿失。</p>
<p>情况2：固定长度的。比如使用uuid作为主键，那用char应该更合适。因为他固定长度，varchar动态根据长度的特性就消失了，而且还要占个长度信息。</p>
<p>情况3：十分频繁改变的column。因为varchar每次存储都要有额外的计算，得到长度等工作，如果一个非常频繁改变的，那就要有很多的精力用于计算，而这些对于char来说是不需要的。</p>
<p>情况4：具体存储引擎中的情况：</p>
<p>MyISAM 数据存储引擎和数据列：MyISAM数据表，最好使用固定长度(CHAR)的数据列代替可变长度(VARCHAR)的数据列。这样使得整个表静态化，从而使 数据检索更快 ，用空间换时间。<br>MEMORY 存储引擎和数据列：MEMORY数据表目前都使用固定长度的数据行存储，因此无论使用CHAR或VARCHAR列都没有关系，两者都是作为CHAR类型处理的。<br>InnoDB 存储引擎，建议使用VARCHAR类型。因为对于InnoDB数据表，内部的行存储格式并没有区分固定长度和可变长度列（所有数据行都使用指向数据列值的头指针），而且主要影响性能的因素 是数据行使用的存储总量，由于char平均占用的空间多于varchar，所以除了简短并且固定长度的，其他考虑varchar。这样节省空间，对磁盘I&#x2F;O和数据存储总量比较好。<br>7.2 TEXT类型<br>在MySQL中，TEXT用来保存文本类型的字符串，总共包含4种类型，分别为TINYTEXT、TEXT、 MEDIUMTEXT 和 LONGTEXT 类型。</p>
<p>在向TEXT类型的字段保存和查询数据时，系统自动按照实际长度存储，不需要预先定义长度。这一点和VARCHAR类型相同。</p>
<p>每种TEXT类型保存的数据长度和所占用的存储空间不同，如下：</p>
<p>由于实际存储的长度不确定， MySQL 不允许 TEXT 类型的字段做主键。遇到这种情况，你只能采用CHAR(M)，或者 VARCHAR(M)。</p>
<p>举例：</p>
<p>#创建数据表：<br>CREATE TABLE test_text( tx TEXT );<br>INSERT INTO test_text VALUES(‘atguigu ‘);<br>SELECT CHAR_LENGTH(tx) FROM test_text; #10<br>1<br>2<br>3<br>4<br>说明在保存和查询数据时，并没有删除TEXT类型的数据尾部的空格。</p>
<p>开发中经验：</p>
<p>TEXT文本类型，可以存比较大的文本段，搜索速度稍慢，因此如果不是特别大的内容，建议使用CHAR， VARCHAR来代替。还有TEXT类型不用加默认值，加了也没用。而且text和blob类型的数据删除后容易导致“空洞”，使得文件碎片比较多，所以频繁使用的表不建议包含TEXT类型字段，建议单独分出去，单独用一个表。</p>
<p>8.ENUM类型<br>ENUM类型也叫作枚举类型，ENUM类型的取值范围需要在定义字段时进行指定。设置字段值时，ENUM类型只允许从成员中选取单个值，不能一次选取多个值。其所需要的存储空间由定义ENUM类型时指定的成员个数决定</p>
<p>当ENUM类型包含1～255个成员时，需要1个字节的存储空间；<br>当ENUM类型包含256～65535个成员时，需要2个字节的存储空间。<br>ENUM类型的成员个数的上限为65535个。<br>举例：</p>
<p>#创建表如下：<br>CREATE TABLE test_enum(<br>    season ENUM(‘春’,’夏’,’秋’,’冬’,’unknow’)<br>)<br>#添加数据：<br>INSERT INTO test_enum VALUES(‘春’),(‘秋’); </p>
<h2 id="忽略大小写"><a href="#忽略大小写" class="headerlink" title="忽略大小写"></a>忽略大小写</h2><p>INSERT INTO test_enum VALUES(‘UNKNOW’); </p>
<h2 id="允许按照角标的方式获取指定索引位置的枚举值"><a href="#允许按照角标的方式获取指定索引位置的枚举值" class="headerlink" title="允许按照角标的方式获取指定索引位置的枚举值"></a>允许按照角标的方式获取指定索引位置的枚举值</h2><p>INSERT INTO test_enum VALUES(‘1’),(3); </p>
<h2 id="Data-truncated-for-column-‘season’-at-row-1"><a href="#Data-truncated-for-column-‘season’-at-row-1" class="headerlink" title="Data truncated for column ‘season’ at row 1"></a>Data truncated for column ‘season’ at row 1</h2><p>INSERT INTO test_enum VALUES(‘ab’); </p>
<h2 id="当ENUM类型的字段没有声明为NOT-NULL时，插入NULL也是有效的"><a href="#当ENUM类型的字段没有声明为NOT-NULL时，插入NULL也是有效的" class="headerlink" title="当ENUM类型的字段没有声明为NOT NULL时，插入NULL也是有效的"></a>当ENUM类型的字段没有声明为NOT NULL时，插入NULL也是有效的</h2><p>INSERT INTO test_enum VALUES(NULL);<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>9.SET类型<br>SET表示一个字符串对象，可以包含0个或多个成员，但成员个数的上限为 64 。设置字段值时，可以取取值范围内的 0 个或多个值。当SET类型包含的成员个数不同时，其所占用的存储空间也是不同的，具体如下：</p>
<p>SET类型在存储数据时成员个数越多，其占用的存储空间越大。注意：SET类型在选取成员时，可以一次选择多个成员，这一点与ENUM类型不同。</p>
<p>#举例<br>CREATE TABLE test_set( s SET (‘A’, ‘B’, ‘C’) );<br>#向表中插入数据：<br>INSERT INTO test_set (s) VALUES (‘A’), (‘A,B’);<br>#插入重复的SET类型成员时，MySQL会自动删除重复的成员<br>INSERT INTO test_set (s) VALUES (‘A,B,C,A’);<br>#向SET类型的字段插入SET成员中不存在的值时，MySQL会抛出错误。<br>INSERT INTO test_set (s) VALUES (‘A,B,C,D’);<br>SELECT * FROM test_set;<br>#举例2<br>CREATE TABLE temp_mul(<br>    gender ENUM(‘男’,’女’),<br>    hobby SET(‘吃饭’,’睡觉’,’打豆豆’,’写代码’)<br>);<br>INSERT INTO temp_mul VALUES(‘男’,’睡觉,打豆豆’); #成功 </p>
<h2 id="Data-truncated-for-column-‘gender’-at-row-1"><a href="#Data-truncated-for-column-‘gender’-at-row-1" class="headerlink" title="Data truncated for column ‘gender’ at row 1"></a>Data truncated for column ‘gender’ at row 1</h2><p>INSERT INTO temp_mul VALUES(‘男,女’,’睡觉,写代码’); #失败 </p>
<h2 id="Data-truncated-for-column-‘gender’-at-row-1-1"><a href="#Data-truncated-for-column-‘gender’-at-row-1-1" class="headerlink" title="Data truncated for column ‘gender’ at row 1"></a>Data truncated for column ‘gender’ at row 1</h2><p>INSERT INTO temp_mul VALUES(‘妖’,’睡觉,写代码’);#失败<br>INSERT INTO temp_mul VALUES(‘男’,’睡觉,写代码,吃饭’); #成功<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>15<br>16<br>17<br>18<br>19<br>20<br>10.二进制字符串类型<br>MySQL中的二进制字符串类型主要存储一些二进制数据，比如可以存储图片、音频和视频等二进制数据。MySQL中支持的二进制字符串类型主要包括BINARY、VARBINARY、TINYBLOB、BLOB、MEDIUMBLOB 和 LONGBLOB类型。</p>
<p>BINARY与VARBINARY类型</p>
<p>BINARY和VARBINARY类似于CHAR和VARCHAR，只是它们存储的是二进制字符串。</p>
<p>BINARY (M)为固定长度的二进制字符串，M表示最多能存储的字节数，取值范围是0~255个字符。如果未指定(M)，表示只能存储 1个字节 。例如BINARY (8)，表示最多能存储8个字节，如果字段值不足(M)个字节，将在右边填充’\0’以补齐指定长度。</p>
<p>VARBINARY (M)为可变长度的二进制字符串，M表示最多能存储的字节数，总字节数不能超过行的字节长度限制65535，另外还要考虑额外字节开销，VARBINARY类型的数据除了存储数据本身外，还需要1或2个字节来存储数据的字节数。VARBINARY类型 必须指定(M) ，否则报错。</p>
<p>举例：</p>
<p>#创建表<br>CREATE TABLE test_binary1(<br>    f1 BINARY,<br>    f2 BINARY(3), # f3 VARBINARY,<br>    f4 VARBINARY(10)<br>)<br>INSERT INTO test_binary1(f1,f2)<br>VALUES(‘a’,’a’);<br>INSERT INTO test_binary1(f1,f2)<br>VALUES(‘尚’,’尚’);#失败<br>INSERT INTO test_binary1(f2,f4)<br>VALUES(‘ab’,’ab’)<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12</p>
<p>BLOB类型</p>
<p>BLOB是一个 二进制大对象 ，可以容纳可变数量的数据。</p>
<p>MySQL中的BLOB类型包括TINYBLOB、BLOB、MEDIUMBLOB和LONGBLOB 4种类型，它们可容纳值的最大长度不同。可以存储一个二进制的大对象，比如 图片 、 音频 和 视频 等。需要注意的是，在实际工作中，往往不会在MySQL数据库中使用BLOB类型存储大对象数据，通常会将图片、音频和视频文件存储到 服务器的磁盘上 ，并将图片、音频和视频的访问路径存储到MySQL中。</p>
<p>举例：</p>
<p>CREATE TABLE test_blob1(<br>    id INT,<br>    img MEDIUMBLOB<br>)<br>1<br>2<br>3<br>4<br>TEXT和BLOB的使用注意事项</p>
<p>在使用text和blob字段类型时要注意以下几点，以便更好的发挥数据库的性能。</p>
<p>① BLOB和TEXT值也会引起自己的一些问题，特别是执行了大量的删除或更新操作的时候。删除这种值会在数据表中留下很大的” 空洞 “，以后填入这些”空洞”的记录可能长度不同。为了提高性能，建议定期使用 OPTIMIZE TABLE 功能对这类表进行 碎片整理 。</p>
<p>② 如果需要对大文本字段进行模糊查询，MySQL 提供了 前缀索引 。但是仍然要在不必要的时候避免检索大型的BLOB或TEXT值。例如，SELECT * 查询就不是很好的想法，除非你能够确定作为约束条件的WHERE子句只会找到所需要的数据行。否则，你可能毫无目的地在网络上传输大量的值。</p>
<p>③ 把BLOB或TEXT列 分离到单独的表 中。在某些环境中，如果把这些数据列移动到第二张数据表中，可以让你把原数据表中的数据列转换为固定长度的数据行格式，那么它就是有意义的。这会 减少主表中的 碎片 ，使你得到固定长度数据行的性能优势。它还使你在主数据表上运行 SELECT * 查询的时候不会通过网络传输大量的BLOB或TEXT值。</p>
<p>11.JSON类型<br>JSON（JavaScript Object Notation）是一种轻量级的 数据交换格式 。简洁和清晰的层次结构使得 JSON 成为理想的数据交换语言。它易于人阅读和编写，同时也易于机器解析和生成，并有效地提升网络传输效率。JSON 可以将 JavaScript 对象中表示的一组数据转换为字符串，然后就可以在网络或者程序之间轻 松地传递这个字符串，并在需要的时候将它还原为各编程语言所支持的数据格式。</p>
<p>在MySQL 5.7中，就已经支持JSON数据类型。在MySQL 8.x版本中，JSON类型提供了可以进行自动验证的JSON文档和优化的存储结构，使得在MySQL中存储和读取JSON类型的数据更加方便和高效。 创建数据表，表中包含一个JSON类型的字段 js 。</p>
<p>CREATE TABLE test_json(<br>    js json<br>);<br>#向表中插入JSON数据。<br>INSERT INTO test_json (js)<br>VALUES (‘{“name”:”songhk”, “age”:18, “address”:{“province”:”beijing”, “city”:”beijing”}}’);<br>1<br>2<br>3<br>4<br>5<br>6<br>查询t19表中的数据。</p>
<p>当需要检索JSON类型的字段中数据的某个具体值时，可以使用“-&gt;”和“-&gt;&gt;”符号</p>
<p>通过“-&gt;”和“-&gt;&gt;”符号，从JSON字段中正确查询出了指定的JSON数据的值。</p>
<p>12.空间类型<br>MySQL 空间类型扩展支持地理特征的生成、存储和分析。这里的地理特征表示世界上具有位置的任何东西，可以是一个实体，例如一座山；可以是空间，例如一座办公楼；也可以是一个可定义的位置，例如一个十字路口等等。MySQL中使用 Geometry（几何） 来表示所有地理特征。Geometry指一个点或点的集合，代表世界上任何具有位置的事物。</p>
<p>MySQL的空间数据类型（Spatial Data Type）对应于OpenGIS类，包括单值类型：GEOMETRY、POINT、 LINESTRING、POLYGON以及集合类型：MULTIPOINT、MULTILINESTRING、MULTIPOLYGON、 GEOMETRYCOLLECTION 。</p>
<p>Geometry是所有空间集合类型的基类，其他类型如POINT、LINESTRING、POLYGON都是Geometry的子类。<br>Point，顾名思义就是点，有一个坐标值。例如POINT(121.213342 31.234532)POINT(30 10)，坐标值支持DECIMAL类型，经度（longitude）在前，维度（latitude）在后，用空格分隔。<br>LineString，线，由一系列点连接而成。如果线从头至尾没有交叉，那就是简单的（simple）；如果起点和终点重叠，那就是封闭的（closed）。例如LINESTRING(30 10,10 30,40 40)，点与点之间用逗号分隔，一个点中的经纬度用空格分隔，与POINT格式一致。<br>Polygon，多边形。可以是一个实心平面形，即没有内部边界，也可以有空洞，类似纽扣。最简单的就是只有一个外边界的情况，例如POLYGON((0 0,10 0,10 10, 0 10))。<br>下面展示几种常见的几何图形元素：</p>
<p>MultiPoint、MultiLineString、MultiPolygon、GeometryCollection 这4种类型都是集合类，是多个Point、LineString或Polygon组合而成。<br>下面展示的是多个同类或异类几何图形元素的组合：</p>
<p>13.小结及选择建议<br>在定义数据类型时，如果确定是 整数 ，就用 INT ； 如果是 小数 ，一定用定点数类型DECIMAL(M,D) ； 如果是日期与时间，就用 DATETIME 。</p>
<p>这样做的好处是，首先确保你的系统不会因为数据类型定义出错。不过，凡事都是有两面的，可靠性好，并不意味着高效。比如，TEXT 虽然使用方便，但是效率不如 CHAR(M) 和VARCHAR(M)。</p>
<p>关于字符串的选择，建议参考如下阿里巴巴的《Java开发手册》规范：</p>
<p>阿里巴巴《Java开发手册》之MySQL数据库：</p>
<p>任何字段如果为非负数，必须是 UNSIGNED</p>
<p>【 强制 】小数类型为 DECIMAL，禁止使用 FLOAT 和 DOUBLE。</p>
<p>说明：在存储的时候，FLOAT 和 DOUBLE 都存在精度损失的问题，很可能在比较值的候，得到不正确的结果。如果存储的数据范围超过 DECIMAL 的范围，建议将数据拆成整数和小数并分开存储。<br>【 强制 】如果存储的字符串长度几乎相等，使用 CHAR 定长字符串类型。</p>
<p>【 强制 】VARCHAR 是可变长字符串，不预先分配存储空间，长度不要超过 5000。如果存储长度大于此值，定义字段类型为 TEXT，独立出来一张表，用主键来对应，避免影响其它字段索引效率。</p>
<h1 id="数据库优化"><a href="#数据库优化" class="headerlink" title="数据库优化"></a>数据库优化</h1><h3 id="数据库结构优化"><a href="#数据库结构优化" class="headerlink" title="数据库结构优化"></a>数据库结构优化</h3><p>一个好的数据库设计方案对于数据库的性能往往会起到事半功倍的效果。</p>
<p>需要考虑数据冗余、查询和更新的速度、字段的数据类型是否合理等多方面的内容。</p>
<p><strong>将字段很多的表分解成多个表</strong></p>
<p>对于字段较多的表，如果有些字段的使用频率很低，可以将这些字段分离出来形成新表。</p>
<p>因为当一个表的数据量很大时，会由于使用频率低的字段的存在而变慢。</p>
<p><strong>增加中间表</strong></p>
<p>对于需要经常联合查询的表，可以建立中间表以提高查询效率。</p>
<p>通过建立中间表，将需要通过联合查询的数据插入到中间表中，然后将原来的联合查询改为对中间表的查询。</p>
<p><strong>增加冗余字段</strong></p>
<p>设计数据表时应尽量遵循范式理论的规约，尽可能的减少冗余字段，让数据库设计看起来精致、优雅。但是，合理的加入冗余字段可以提高查询速度。</p>
<p>表的规范化程度越高，表和表之间的关系越多，需要连接查询的情况也就越多，性能也就越差。</p>
<p><strong>注意：</strong></p>
<p><strong>冗余字段的值在一个表中修改了，就要想办法在其他表中更新，否则就会导致数据不一致的问题。</strong></p>
<h3 id="大表怎么优化？某个表有近千万数据，CRUD比较慢，如何优化？分库分表是怎么做的？分表分库了有什么问题？有用到中间件么？他们的原理知道么？"><a href="#大表怎么优化？某个表有近千万数据，CRUD比较慢，如何优化？分库分表是怎么做的？分表分库了有什么问题？有用到中间件么？他们的原理知道么？" class="headerlink" title="@$大表怎么优化？某个表有近千万数据，CRUD比较慢，如何优化？分库分表是怎么做的？分表分库了有什么问题？有用到中间件么？他们的原理知道么？"></a>@$大表怎么优化？某个表有近千万数据，CRUD比较慢，如何优化？分库分表是怎么做的？分表分库了有什么问题？有用到中间件么？他们的原理知道么？</h3><p><strong>水平分表：</strong></p>
<p><strong>保持数据表结构不变，通过某种策略进行存储数据分片。这样每一片数据分散到不同的表或者库中，达到了分布式的目的。水平拆分可以支撑非常大的数据量。</strong></p>
<p>水平拆分是指数据表行的拆分，表的行数超过200万行时，就会变慢，这时可以把一张表的数据拆成多张表来存放。举个例子：我们可以将用户信息表拆分成多个用户信息表，这样就可以避免单一表数据量过大对性能造成影响。</p>
<ol>
<li><p>水平拆分可以支持非常大的数据量。需要注意的一点是：水平分表仅仅是解决了单一表数据过大的问题，但由于表的数据还是在同一台机器上，其实对于提升MySQL并发能力没有什么意义，所以 <strong>水平拆分最好分库</strong> 。</p>
<p><strong>适用场景</strong>：支持非常大的数据量存储</p>
<p><strong>水平拆分优点</strong>：支持非常大的数据量存储</p>
<p><strong>水平拆分缺点</strong>：给应用增加复杂度，通常查询时需要多个表名，查询所有数据都需UNION操作；分片事务难以解决 ，跨库join性能较差，逻辑复杂。</p>
</li>
</ol>
<p>《Java工程师修炼之道》的作者推荐 <strong>尽量不要对数据进行分片，因为拆分会带来逻辑、部署、运维的各种复杂度</strong> ，一般的数据表在优化得当的情况下支撑千万以下的数据量是没有太大问题的。如果实在要分片，尽量选择客户端分片架构，这样可以减少一次和中间件的网络I&#x2F;O。</p>
<p>下面补充一下<strong>数据库分片的两种常见方案</strong>：</p>
<ul>
<li><strong>客户端代理：</strong> <strong>分片逻辑在应用端，封装在jar包中，通过修改或者封装JDBC层来实现。</strong> 当当网的 <strong>Sharding-JDBC</strong> 、阿里的TDDL是两种比较常用的实现。</li>
<li><strong>中间件代理：</strong> <strong>在应用和数据库中间加了一个代理层。分片逻辑统一维护在中间件服务中。</strong>  <strong>Mycat</strong> 、360的Atlas、网易的DDB等等都是这种架构的实现。</li>
</ul>
<h3 id="MySQL的主从复制原理以及流程"><a href="#MySQL的主从复制原理以及流程" class="headerlink" title="MySQL的主从复制原理以及流程"></a>MySQL的主从复制原理以及流程</h3><p>主从复制：将主数据库中的DDL和DML操作通过二进制日志（BINLOG）传输到从数据库上，然后将这些日志重新执行，从而使得从数据库的数据与主数据库保持一致。</p>
<p><strong>主从复制的作用</strong></p>
<ol>
<li>高可用和故障切换：主数据库出现问题，可以切换到从数据库。</li>
<li>负载均衡：可以进行数据库层面的读写分离。</li>
<li>数据备份：可以在从数据库上进行日常备份。</li>
</ol>
<p><strong>复制过程</strong></p>
<p><img src="https://mmbiz.qpic.cn/mmbiz_jpg/O8AYEZicmmkmwZEW0CHPKiaicfj0QMyG18ibz1NtCINZWz1ss5sk1nSJRyTLica5ialsvPubmOV6UicSAubGmhzNAXr8A/640?wx_fmt=jpeg&wxfrom=5&wx_lazy=1&wx_co=1" alt="图片"></p>
<p>Binary log：主数据库的二进制日志</p>
<p>Relay log：从数据库的中继日志</p>
<p>第一步：master在每个事务更新数据完成之前，将该操作记录串行地写入到binlog文件中。</p>
<p>第二步：salve开启一个I&#x2F;O Thread，该线程在master打开一个普通连接，将这些事件写入到中继日志中。如果读取的进度已经跟上了master，就进入睡眠状态并等待master产生新的事件。</p>
<p>第三步：SQL Thread会读取中继日志，并顺序执行该日志中的SQL事件，从而与主数据库中的数据保持一致。</p>
<h3 id="读写分离有哪些解决方案？未完成"><a href="#读写分离有哪些解决方案？未完成" class="headerlink" title="读写分离有哪些解决方案？未完成"></a>读写分离有哪些解决方案？未完成</h3><p>读写分离是依赖于主从复制，而主从复制又是为读写分离服务的。主从复制要求<code>slave</code>不能写只能读</p>
<p><strong>方案一</strong> </p>
<p>利用中间件来做代理，使用mysql-proxy代理，负责对数据库的请求识别出读还是写，并分发到不同的数据库中。</p>
<p>优点：直接实现读写分离和负载均衡，不用修改代码，数据库和应用程序弱耦合，master和slave用一样的帐号，mysql官方不建议实际生产中使用</p>
<p>缺点：降低性能， 不支持事务，代理存在性能瓶颈和可靠性风险增加。</p>
<p><strong>方案二</strong></p>
<p>使用AbstractRoutingDataSource+aop+annotation在dao层决定数据源。</p>
<p> 如果采用了mybatis， 可以将读写分离放在ORM层，比如mybatis可以通过mybatis plugin拦截sql语句，所有的insert&#x2F;update&#x2F;delete都访问master库，所有的select 都访问salve库，这样对于dao层都是透明。plugin实现时可以通过注解或者分析语句是读写方法来选定主从库。</p>
<p>不过这样依然有一个问题， 也就是不支持事务， 所以我们还需要重写一下DataSourceTransactionManager， 将read-only的事务扔进读库， 其余的有读有写的扔进写库。</p>
<p><strong>方案三</strong></p>
<p>使用AbstractRoutingDataSource+aop+annotation在service层决定数据源，可以支持事务</p>
<p>缺点：类内部方法通过this.xx()方式相互调用时，aop不会进行拦截，需要进行特殊处理</p>
<h1 id="SQL查询的基本原理"><a href="#SQL查询的基本原理" class="headerlink" title="SQL查询的基本原理"></a>SQL查询的基本原理</h1><p>六、SQL查询的基本原理</p>
<p>单表查询：根据WHERE条件过滤表中的记录，形成中间表（这个中间表对用户是不可见的）；然后根据SELECT的选择列选择相应的列进行返回最终结果。</p>
<p>两表连接查询：对两表求积（笛卡尔积）并用ON条件和连接连接类型进行过滤形成中间表；然后根据WHERE条件过滤中间表的记录，并根据SELECT指定的列返回查询结果。</p>
<p>多表连接查询：先对第一个和第二个表按照两表连接做查询，然后用查询结果和第三个表做连接查询，以此类推，直到所有的表都连接上为止，最终形成一个中间的结果表，然后根据WHERE条件过滤中间表的记录，并根据SELECT指定的列返回查询结果。理解SQL查询的过程是进行SQL优化的理论依据。</p>
<h3 id="SQL的生命周期？一条SQL查询语句是如何执行的？MySQL总体架构—-gt-SQL执行流程—-gt-语句执行顺序"><a href="#SQL的生命周期？一条SQL查询语句是如何执行的？MySQL总体架构—-gt-SQL执行流程—-gt-语句执行顺序" class="headerlink" title="@$SQL的生命周期？一条SQL查询语句是如何执行的？MySQL总体架构—&gt;SQL执行流程—&gt;语句执行顺序"></a>@$SQL的生命周期？一条SQL查询语句是如何执行的？MySQL总体架构—&gt;SQL执行流程—&gt;语句执行顺序</h3><ol>
<li><p>连接：应用服务器与数据库服务器建立一个连接</p>
</li>
<li><p>获得请求SQL：数据库进程拿到请求sql</p>
</li>
<li><p>查询缓存：如果查询命中缓存则直接返回结果</p>
</li>
<li><p>语法解析和预处理：</p>
<p>首先通过mysql关键字将语句解析，会生成一个内部解析树，mysql解析器将对其解析，查看是否是有错误的关键字，关键字顺序是否正确；预处理器则是根据mysql的规则进行进一步的检查，检查mysql语句是否合法，如库表是否存在，字段是否存在，字段之间是否模棱两可等等，预处理器也会验证权限。</p>
</li>
<li><p>查询优化器：sql语句在优化器中转换成执行计划，一条sql语句可以有多种方式查询，最后返回的结果肯定是相同，但是不同的查询方式效果不同，优化器的作用就是：选择一种合适的执行计划。mysql是基于成本的优化器，他将预测执行此计划的成本，并选择成本最小的那条</p>
</li>
<li><p>执行计划，执行SQL：在解析和优化后，MySQL将生成查询对应的执行计划，由执行计划调用存储引擎的API来执行查询</p>
</li>
<li><p>将结果返回给客户端</p>
</li>
<li><p>关掉连接，释放资源</p>
</li>
</ol>
<h3 id="一条更新语句的执行流程又是怎样的呢？持久化机制"><a href="#一条更新语句的执行流程又是怎样的呢？持久化机制" class="headerlink" title="一条更新语句的执行流程又是怎样的呢？持久化机制"></a>一条更新语句的执行流程又是怎样的呢？持久化机制</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-- 如果要将 ID=2 这一行的值加 1</span><br><span class="line">mysql&gt; update T set c=c+1 where ID=2;</span><br></pre></td></tr></table></figure>

<p>你执行语句前要先连接数据库，这是连接器的工作。</p>
<p>前面我们说过，在一个表上有更新的时候，跟这个表有关的查询缓存会失效，所以这条语句就会把表 T 上所有缓存结果都清空。这也就是我们一般不建议使用查询缓存的原因。</p>
<p>接下来，分析器会通过词法和语法解析知道这是一条更新语句。优化器决定要使用 ID 这个索引。然后，执行器负责具体执行，找到这一行，然后更新。</p>
<p>与查询流程不一样的是，更新流程还涉及两个重要的日志模块，它们正是我们今天要讨论的主角：redo log（重做日志）和 binlog（归档日志）。</p>
<p>在 MySQL 里也有这个问题，如果每一次的更新操作都需要写进磁盘，然后磁盘也要找到对应的那条记录，然后再更新，整个过程 IO 成本、查找成本都很高。为了解决这个问题，MySQL 的设计者就用了类似酒店掌柜粉板的思路来提升更新效率。</p>
<p>而粉板和账本配合的整个过程，其实就是 MySQL 里经常说到的 WAL 技术，WAL 的全称是 Write-Ahead Logging，它的关键点就是先写日志，再写磁盘，也就是先写粉板，等不忙的时候再写账本。</p>
<p>具体来说，当有一条记录需要更新的时候，InnoDB 引擎就会先把记录写到 redo log（粉板）里面，并更新内存，这个时候更新就算完成了。同时，InnoDB 引擎会在适当的时候，将这个操作记录更新到磁盘里面，而这个更新往往是在系统比较空闲的时候做，这就像打烊以后掌柜做的事。</p>
<p>如果今天赊账的不多，掌柜可以等打烊后再整理。但如果某天赊账的特别多，粉板写满了，又怎么办呢？这个时候掌柜只好放下手中的活儿，把粉板中的一部分赊账记录更新到账本中，然后把这些记录从粉板上擦掉，为记新账腾出空间。</p>
<p>write pos 是当前记录的位置，一边写一边后移，写到第 3 号文件末尾后就回到 0 号文件开头。checkpoint 是当前要擦除的位置，也是往后推移并且循环的，擦除记录前要把记录更新到数据文件。</p>
<p>write pos 和 checkpoint 之间的是“粉板”上还空着的部分，可以用来记录新的操作。如果 write pos 追上 checkpoint，表示“粉板”满了，这时候不能再执行新的更新，得停下来先擦掉一些记录，把 checkpoint 推进一下。</p>
<p>有了 redo log，InnoDB 就可以保证即使数据库发生异常重启，之前提交的记录都不会丢失，这个能力称为<strong>crash-safe</strong>。</p>
<p>要理解 crash-safe 这个概念，可以想想我们前面赊账记录的例子。只要赊账记录记在了粉板上或写在了账本上，之后即使掌柜忘记了，比如突然停业几天，恢复生意后依然可以通过账本和粉板上的数据明确赊账账目。</p>
<blockquote>
<p> 补充: redo是存储在磁盘上的 是顺序写  提前分配好一块区域追加写速度很快(Kafka,mq等就是顺序写)</p>
<p> 直接往磁盘(账本)上写是随机写,修改这条数据和修改那条数据,所以很慢</p>
</blockquote>
<p>​		</p>
<p>重要的日志模块：binlog</p>
<p>前面我们讲过，MySQL 整体来看，其实就有两块：一块是 Server 层，它主要做的是 MySQL 功能层面的事情；还有一块是引擎层，负责存储相关的具体事宜。上面我们聊到的粉板 redo log 是 InnoDB 引擎特有的日志，而 Server 层也有自己的日志，称为 binlog（归档日志）。</p>
<p>我想你肯定会问，为什么会有两份日志呢？</p>
<p>因为最开始 MySQL 里并没有 InnoDB 引擎。MySQL 自带的引擎是 MyISAM，但是 MyISAM 没有 crash-safe 的能力，binlog 日志只能用于归档。而 InnoDB 是另一个公司以插件形式引入 MySQL 的，既然只依靠 binlog 是没有 crash-safe 能力的，所以 InnoDB 使用另外一套日志系统——也就是 redo log 来实现 crash-safe 能力。</p>
<p>这两种日志有以下三点不同。</p>
<ol>
<li>redo log 是 InnoDB 引擎特有的；binlog 是 MySQL 的 Server 层实现的，所有引擎都可以使用。</li>
<li>redo log 是物理日志，记录的是“在某个数据页上做了什么修改”；binlog 是逻辑日志，记录的是这个语句的原始逻辑，比如“给 ID&#x3D;2 这一行的 c 字段加 1 ”。</li>
<li>redo log 是循环写的，空间固定会用完；binlog 是可以追加写入的。“追加写”是指 binlog 文件写到一定大小后会切换到下一个，并不会覆盖以前的日志。</li>
</ol>
<h1 id="事务与锁"><a href="#事务与锁" class="headerlink" title="事务与锁"></a>事务与锁</h1><h2 id="事务"><a href="#事务" class="headerlink" title="事务"></a>事务</h2><h3 id="什么是数据库事务？"><a href="#什么是数据库事务？" class="headerlink" title="什么是数据库事务？"></a>什么是数据库事务？</h3><p>事务是逻辑上的一组操作，要么都执行，要么都不执行</p>
<h3 id="事务的四大特性-ACID-介绍一下"><a href="#事务的四大特性-ACID-介绍一下" class="headerlink" title="@$事务的四大特性(ACID)介绍一下?"></a>@$事务的四大特性(ACID)介绍一下?</h3><p>关系性数据库需要遵循ACID规则，具体内容如下：</p>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/O8AYEZicmmkmwZEW0CHPKiaicfj0QMyG18ib9S9VcVk8sOTmFEWWAlMALPiaZgyFECftlYiaEuOcNQNEwl2fPgEEicedw/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1" alt="图片"></p>
<table>
<thead>
<tr>
<th align="center">特性</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td align="center">原子性 Atomic</td>
<td>事务是最小的执行单位，不允许分割。事务包含的所有操作要么全部成功，要么全部失败回滚。</td>
</tr>
<tr>
<td align="center">一致性 Consistency</td>
<td>事务执行之前和执行之后都必须处于一致性状态。举例：拿转账来说，假设用户A和用户B两者的钱加起来一共是5000，那么不管A和B之间如何转账，转几次账，事务结束后两个用户的钱相加起来应该还得是5000，这就是事务的一致性。</td>
</tr>
<tr>
<td align="center">隔离性 Isolation</td>
<td>隔离性是当多个用户并发访问数据库时，比如操作同一张表时，数据库为每一个用户开启的事务，不能被其他事务的操作所干扰，多个并发事务之间是相互隔离的。数据库规定了多种事务隔离级别，不同的隔离级别对应不同的干扰程度。隔离级别越高，数据一致性越好，但并发性越差。</td>
</tr>
<tr>
<td align="center">持久性 Durability</td>
<td>持久性是指一个事务一旦被提交了，那么对数据库中的数据的改变就是永久性的，即便是在数据库系统遇到故障的情况下，也不会丢失提交事务的操作。</td>
</tr>
</tbody></table>
<h3 id="什么是脏读？不可重复读？幻读？"><a href="#什么是脏读？不可重复读？幻读？" class="headerlink" title="@$什么是脏读？不可重复读？幻读？"></a>@$什么是脏读？不可重复读？幻读？</h3><p><img src="https://mmbiz.qpic.cn/mmbiz_png/O8AYEZicmmkmwZEW0CHPKiaicfj0QMyG18ib5cTibSEUgaFxj4iaRgiaT5aZesYVErdlI2TEFGpEpFKICnoxoxRibeL0hg/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1" alt="图片"></p>
<ul>
<li>脏读(Dirty Read)：一个事务读取到另外一个事务未提交的数据。举例：一个事务1读取了被另一个事务2修改但还未提交的数据。由于某种异常事务2回滚，则事务1读取的是无效数据。</li>
</ul>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/O8AYEZicmmkmwZEW0CHPKiaicfj0QMyG18ibowNicsnic2xtcbEhFky1xSks7UMyuKF2GV8CezcYcLHQrXiavgFh30qMw/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1" alt="图片"></p>
<ul>
<li>不可重复读(Non-repeatable read)：一个事务读取同一条记录2次，得到的结果不一致。这可能是两次查询过程中间，另一个事务更新了这条记录。</li>
</ul>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/O8AYEZicmmkmwZEW0CHPKiaicfj0QMyG18ibkl2hITIPvhnrlmQ6LMRT8vjuic0n885FEv3UNbvbsCKU3R9aLz0pQxQ/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1" alt="图片"></p>
<ul>
<li>幻读(Phantom Read)：幻读发生在两个完全相同的查询，得到的结果不一致。这可能是两次查询过程中间，另一个事务增加或者减少了行记录。</li>
</ul>
<p><strong>不可重复度和幻读区别</strong></p>
<p>不可重复读的重点是修改，幻读的重点在于新增或者删除。</p>
<h3 id="什么是事务的隔离级别？MySQL的默认的隔离级别是什么？"><a href="#什么是事务的隔离级别？MySQL的默认的隔离级别是什么？" class="headerlink" title="@$什么是事务的隔离级别？MySQL的默认的隔离级别是什么？"></a>@$什么是事务的隔离级别？MySQL的默认的隔离级别是什么？</h3><p>为了达到事务的四大特性，数据库定义了4种不同的事务隔离级别，由低到高依次为Read uncommitted、Read committed、Repeatable read、Serializable，后三个级别可以逐个解决脏读、不可重复读、幻读这几类问题。</p>
<table>
<thead>
<tr>
<th align="center">隔离级别</th>
<th align="center">脏读</th>
<th align="center">不可重复读</th>
<th align="center">幻读</th>
</tr>
</thead>
<tbody><tr>
<td align="center">READ-UNCOMMITTED</td>
<td align="center">√</td>
<td align="center">√</td>
<td align="center">√</td>
</tr>
<tr>
<td align="center">READ-COMMITTED</td>
<td align="center">×</td>
<td align="center">√</td>
<td align="center">√</td>
</tr>
<tr>
<td align="center">REPEATABLE-READ</td>
<td align="center">×</td>
<td align="center">×</td>
<td align="center">√</td>
</tr>
<tr>
<td align="center">SERIALIZABLE</td>
<td align="center">×</td>
<td align="center">×</td>
<td align="center">×</td>
</tr>
</tbody></table>
<p><strong>SQL 标准定义了四个隔离级别</strong></p>
<ul>
<li><strong>READ-UNCOMMITTED(读未提交)<strong>：最低的隔离级别，一个事务可以读取另一个事务更新但未提交的数据。</strong>可能会导致脏读、不可重复读或幻读</strong>。</li>
<li><strong>READ-COMMITTED(读已提交)<strong>：一个事务提交后才能被其他事务读取到，</strong>可以阻止脏读，但是不可重复读或幻读仍有可能发生</strong>。</li>
<li><strong>REPEATABLE-READ(可重复读)<strong>：对同一记录的多次读取结果都是一致的，除非数据是被本身事务所修改，</strong>可以阻止脏读和不可重复读，但幻读仍有可能发生</strong>。</li>
<li><strong>SERIALIZABLE(可串行化)<strong>：最高的隔离级别，完全服从ACID的隔离级别。所有的事务依次逐个执行，这样事务之间就完全不可能产生干扰，也就是说，</strong>该级别可以防止脏读、不可重复读以及幻读</strong>。</li>
</ul>
<p>这里需要注意的是：MySQL 默认采用的 REPEATABLE_READ隔离级别，Oracle 默认采用的 READ_COMMITTED隔离级别</p>
<p>事务隔离机制的实现基于锁机制和并发调度。其中并发调度使用的是MVVC（多版本并发控制），通过保存修改的旧版本信息来支持并发一致性读和回滚等特性。</p>
<p>因为隔离级别越低，事务请求的锁越少，所以大部分数据库系统的隔离级别都是**READ-COMMITTED(读取已提交)**，但是你要知道的是InnoDB 存储引擎默认使用 <strong>REPEATABLE-READ（可重复读）</strong>并不会有任何性能损失。</p>
<p>InnoDB 存储引擎在 <strong>分布式事务</strong> 的情况下一般会用到**SERIALIZABLE(可串行化)**隔离级别。</p>
<h3 id="MySQL数据库可重复读隔离级别是怎么实现的，MVCC并发版本控制原理"><a href="#MySQL数据库可重复读隔离级别是怎么实现的，MVCC并发版本控制原理" class="headerlink" title="@$MySQL数据库可重复读隔离级别是怎么实现的，MVCC并发版本控制原理"></a>@$MySQL数据库可重复读隔离级别是怎么实现的，MVCC并发版本控制原理</h3><p>实际上就是一个copyOrwrite 写的是副本数据,写完在提交,读的是旧数据,所以写的可能是脏写,所以加CAS 读操作会有一个版本号,写的时候必须要和持有的版本号一致,负责重查</p>
<blockquote>
<p>事务一查询 version1 500</p>
<p>事务二 修改为 1000 version2</p>
<p>事务一 在查询的数据上+300 提交时发现 version不是1 则重新查询</p>
<p>​			查询version 2 1000</p>
<p>​			+300  version 是2 则提交 变为1300</p>
</blockquote>
<p>MySQL可重复读是通过MVCC实现的</p>
<p>MVCC(Multi Version Concurrency Control的简称)，代表多版本并发控制。与MVCC相对的，是基于锁的并发控制，Lock-Based Concurrency Control)。MVCC最大的优势：读不加锁，读写不冲突。在读多写少的OLTP应用中，读写不冲突是非常重要的，极大的增加了系统的并发性能</p>
<p>MVCC是通过在每行记录后面保存两个隐藏的列来实现的。这两个列，一个保存了行的创建时间，一个保存行的过期时间（或删除时间）。当然存储的并不是实际的时间值，而是系统版本号（system version number)。每开始一个新的事务，系统版本号都会自动递增。事务开始时刻的系统版本号会作为事务的版本号，用来和查询到的每行记录的版本号进行比较。</p>
<p>InnoDB MVCC 实现原理</p>
<p><code>InnoDB</code> 中 <code>MVCC</code> 的实现方式为：每一行记录都有两个隐藏列：<code>DATA_TRX_ID</code>、<code>DATA_ROLL_PTR</code>（如果没有主键，则还会多一个隐藏的主键列）。</p>
<p><img src="https://mmbiz.qpic.cn/mmbiz_jpg/O8AYEZicmmkmwZEW0CHPKiaicfj0QMyG18ibqN1P4DR4QsDl493GwWmiaWkyl5dyCGCCCziawiabiccEBtKCibc89sCJJQQ/640?wx_fmt=jpeg&wxfrom=5&wx_lazy=1&wx_co=1" alt="图片"></p>
<p><strong>DATA_TRX_ID</strong></p>
<p>记录最近更新这条行记录的<code>事务 ID</code>，大小为 <code>6</code> 个字节</p>
<p><strong>DATA_ROLL_PTR</strong></p>
<p>表示指向该行回滚段<code>（rollback segment）</code>的指针，大小为 <code>7</code> 个字节，<code>InnoDB</code> 便是通过这个指针找到之前版本的数据。该行记录上所有旧版本，在 <code>undo</code> 中都通过链表的形式组织。</p>
<p><strong>DB_ROW_ID</strong></p>
<p>行标识（隐藏单调自增 <code>ID</code>），大小为 <code>6</code> 字节，如果表没有主键，<code>InnoDB</code> 会自动生成一个隐藏主键，因此会出现这个列。另外，每条记录的头信息（<code>record header</code>）里都有一个专门的 <code>bit</code>（<code>deleted_flag</code>）来表示当前记录是否已经被删除。</p>
<p>增删改查</p>
<p>假设初始版本号为1：</p>
<p>INSERT</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">insert into user (id,name) values (1,&#x27;Tom&#x27;);</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th align="center">id</th>
<th align="center">name</th>
<th align="center">create_version</th>
<th align="center">delete_version</th>
</tr>
</thead>
<tbody><tr>
<td align="center">1</td>
<td align="center">Tom</td>
<td align="center">1</td>
<td align="center"></td>
</tr>
</tbody></table>
<p>下面模拟一下文章开头的场景：</p>
<p>SELECT (事务A)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from user where id = 1;</span><br></pre></td></tr></table></figure>

<p>此时读到的版本号为1</p>
<p>UPDATE(事务B)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">update user set name = &#x27;Jerry&#x27; where id = 1;</span><br></pre></td></tr></table></figure>

<p>在更新操作的时候，该事务的版本号在原来的基础上加1，所以版本号为2。先将要更新的这条数据标记为已删除，并且删除的版本号是当前事务的版本号，然后插入一行新的记录</p>
<table>
<thead>
<tr>
<th align="center">id</th>
<th align="center">name</th>
<th align="center">create_version</th>
<th align="center">delete_version</th>
</tr>
</thead>
<tbody><tr>
<td align="center">1</td>
<td align="center">Tom</td>
<td align="center">1</td>
<td align="center">2</td>
</tr>
<tr>
<td align="center">1</td>
<td align="center">Jerry</td>
<td align="center">2</td>
<td align="center"></td>
</tr>
</tbody></table>
<p>SELECT (事务A)</p>
<p>此时事务A再重新读数据：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from user where id = 1;</span><br></pre></td></tr></table></figure>

<p>由于事务A一直没提交，所以此时读到的版本号还是为1，所以读到的还是Tom这条数据，也就是可重复读</p>
<p>DELETE</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">delete from user where id = 1;</span><br></pre></td></tr></table></figure>

<p>在删除操作的时候，该事务的版本号在原来的基础上加1，所以版本号为3删除时，将当前版本号作为删除版本号</p>
<table>
<thead>
<tr>
<th align="center">id</th>
<th align="center">name</th>
<th align="center">create_version</th>
<th align="center">delete_version</th>
</tr>
</thead>
<tbody><tr>
<td align="center">1</td>
<td align="center">Jerry</td>
<td align="center">2</td>
<td align="center">3</td>
</tr>
</tbody></table>
<h3 id="长事务的优化"><a href="#长事务的优化" class="headerlink" title="长事务的优化"></a>长事务的优化</h3><p><img src="/../images/image-20220823211051568.png" alt="image-20220823211051568"></p>
<h2 id="锁"><a href="#锁" class="headerlink" title="锁"></a>锁</h2><h3 id="对MySQL的锁了解吗"><a href="#对MySQL的锁了解吗" class="headerlink" title="对MySQL的锁了解吗"></a>对MySQL的锁了解吗</h3><p>当数据库有并发事务的时候，可能会产生数据的不一致，这时候需要一些机制来保证访问的次序，锁机制就是这样的一个机制。</p>
<h3 id="隔离级别与锁的关系"><a href="#隔离级别与锁的关系" class="headerlink" title="隔离级别与锁的关系"></a>隔离级别与锁的关系</h3><p>在Read Uncommitted级别下，读取数据不需要加共享锁，这样就不会跟被修改的数据上的排他锁冲突</p>
<p>在Read Committed级别下，读操作需要加共享锁，在语句执行完以后释放共享锁；</p>
<p>在Repeatable Read级别下，读操作需要加共享锁，事务执行完毕后才释放共享锁。</p>
<p>在SERIALIZABLE级别下，是限制性最强的隔离级别，该级别下锁定整个范围的键，并一直持有锁，直到事务完成。</p>
<h3 id="按照锁的粒度分数据库锁有哪些？"><a href="#按照锁的粒度分数据库锁有哪些？" class="headerlink" title="按照锁的粒度分数据库锁有哪些？"></a>按照锁的粒度分数据库锁有哪些？</h3><p>在关系型数据库中，可以<strong>按照锁的粒度把数据库锁分</strong>为行级锁(INNODB引擎)、表级锁(MYISAM引擎)和页级锁(BDB引擎 )。</p>
<p><strong>MyISAM和InnoDB存储引擎使用的锁：</strong></p>
<ul>
<li>MyISAM采用表级锁(table-level locking)。</li>
<li>InnoDB支持行级锁(row-level locking)和表级锁，默认采用行级锁</li>
</ul>
<p>行级锁，表级锁和页级锁对比</p>
<p><strong>行级锁</strong> 行级锁是MySQL中锁定粒度最细的一种锁，表示只针对当前操作的行进行加锁。行级锁能大大减少数据库操作的冲突。其加锁粒度最小，但加锁的开销也最大。行级锁分为共享锁 和 排他锁。</p>
<p>特点：锁定粒度最小，对当前操作的行记录加锁，发生锁冲突的概率最低，并发度也最高；加锁开销大，加锁慢；会出现死锁；</p>
<p><strong>表级锁</strong> 表级锁是MySQL中锁定粒度最大的一种锁，表示对当前操作的整张表加锁，它实现简单，资源消耗较少，被大部分MySQL引擎支持。最常使用的MYISAM与INNODB都支持表级锁定。表级锁定分为表共享读锁（共享锁）与表独占写锁（排他锁）。</p>
<p>特点：锁定粒度大，对当前操作的整张表加锁，发出锁冲突的概率最高，并发度最低；加锁开销小，加锁快；不会出现死锁；</p>
<p><strong>页级锁</strong> 页级锁是MySQL中锁定粒度介于行级锁和表级锁中间的一种锁。表级锁速度快，但冲突多，行级冲突少，但速度慢。所以取了折衷的页级，一次锁定相邻的一组记录。</p>
<p>特点：开销和加锁时间界于表锁和行锁之间；会出现死锁；锁定粒度界于表锁和行锁之间，并发度一般</p>
<h3 id="共享锁和排他锁的区别"><a href="#共享锁和排他锁的区别" class="headerlink" title="共享锁和排他锁的区别"></a>共享锁和排他锁的区别</h3><p><strong>共享锁</strong></p>
<p>共享锁 share lock 又称<strong>读锁 read lock</strong>，简称S锁，是读取操作创建的锁。其他用户可以并发读取数据，但任何事务都不能对数据进行修改（获取数据上的排他锁），直到已释放所有共享锁。</p>
<p><strong>如果事务T对数据A加上共享锁后，则其他事务只能对A再加共享锁，不能加排他锁。获得共享锁的事务只能读数据，不能修改数据</strong></p>
<p>读取为什么要加读锁呢：防止数据在被读取的时候被别的线程加上写锁</p>
<p>使用方式：在需要执行的语句后面加上 <code>for update</code>就可以了</p>
<p><strong>排他锁</strong></p>
<p>排他锁 exclusive lock 又称<strong>写锁 writer lock</strong>，简称X锁。排他锁是悲观锁的一种实现。</p>
<p><strong>若事务T对数据A加上排他锁，则只允许事务T读取和修改数据A，其他任何事务都不能再对A加任何类型的锁，直到事务T释放X锁。排他锁会阻塞所有的排他锁和共享锁</strong></p>
<h3 id="数据库的乐观锁和悲观锁是什么？怎么实现的？"><a href="#数据库的乐观锁和悲观锁是什么？怎么实现的？" class="headerlink" title="数据库的乐观锁和悲观锁是什么？怎么实现的？"></a>数据库的乐观锁和悲观锁是什么？怎么实现的？</h3><p>数据库管理系统（DBMS）中的并发控制的任务是确保在多个事务同时存取同一数据时不破坏事务的隔离性和一致性以及数据库的统一性。乐观并发控制（乐观锁）和悲观并发控制（悲观锁）是并发控制主要采用的技术手段。</p>
<p><strong>悲观锁</strong>：假定会发生并发冲突，每次去查询数据的时候都认为别人会修改，每次查询完数据的时候就把事务锁起来，直到提交事务。实现方式：使用数据库中的锁机制</p>
<p><strong>乐观锁</strong>：假设不会发生并发冲突，每次去查询数据的时候都认为别人不会修改，所以不会上锁，在修改数据的时候才把事务锁起来。实现方式：乐观锁一般会使用版本号机制或CAS算法实现</p>
<p><strong>两种锁的使用场景</strong></p>
<p>从上面对两种锁的介绍，我们知道两种锁各有优缺点，不可认为一种好于另一种，像<strong>乐观锁适用于写比较少的情况下（多读场景）</strong>，即冲突真的很少发生的时候，这样可以省去了锁的开销，加大了系统的整个吞吐量。</p>
<p>但如果是多写的情况，一般会经常产生冲突，这就会导致上层应用会不断的进行retry，这样反倒是降低了性能，所以<strong>一般多写的场景下用悲观锁就比较合适。</strong></p>
<h2 id="SQL优化"><a href="#SQL优化" class="headerlink" title="SQL优化"></a>SQL优化</h2><h3 id="如何定位及优化SQL语句的性能问题？创建的索引有没有被使用到？或者说怎么才可以知道这条语句运行很慢的原因？"><a href="#如何定位及优化SQL语句的性能问题？创建的索引有没有被使用到？或者说怎么才可以知道这条语句运行很慢的原因？" class="headerlink" title="@$如何定位及优化SQL语句的性能问题？创建的索引有没有被使用到？或者说怎么才可以知道这条语句运行很慢的原因？"></a>@$如何定位及优化SQL语句的性能问题？创建的索引有没有被使用到？或者说怎么才可以知道这条语句运行很慢的原因？</h3><p>对于低性能的SQL语句的定位，最重要也是最有效的方法就是使用执行计划，MySQL提供了explain命令来查看语句的执行计划。我们知道，不管是哪种数据库，或者是哪种数据库引擎，在对一条SQL语句进行执行的过程中都会做很多相关的优化，<strong>对于查询语句，最重要的优化方式就是使用索引</strong>。而<strong>执行计划，就是显示数据库引擎对于SQL语句执行的详细情况，其中包含了是否使用索引，使用什么索引，使用的索引的相关信息等</strong>。</p>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/O8AYEZicmmkmwZEW0CHPKiaicfj0QMyG18ibRW8NBW73vop4pYXTncTc6aeBZyEQEsSbgM2KgjgAerBbBjbYefRHBw/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1" alt="图片"></p>
<p>执行计划包含的信息</p>
<p><strong>id</strong> 由一组数字组成。表示一个查询中各个子查询的执行顺序;</p>
<ul>
<li>id相同执行顺序由上至下。</li>
<li>id不同，id值越大优先级越高，越先被执行。</li>
<li>id为null时，表示一个合并结果集的操作的执行id为null，常出现在包含union等查询语句中。</li>
</ul>
<p><strong>select_type</strong> 每个子查询的查询类型，一些常见的查询类型。</p>
<table>
<thead>
<tr>
<th>id</th>
<th>select_type</th>
<th>description</th>
</tr>
</thead>
<tbody><tr>
<td>1</td>
<td><strong>SIMPLE</strong></td>
<td>不包含任何子查询或union查询</td>
</tr>
<tr>
<td>2</td>
<td><strong>PRIMARY</strong></td>
<td>包含子查询时最外层查询就显示为 PRIMARY</td>
</tr>
<tr>
<td>3</td>
<td><strong>SUBQUERY</strong></td>
<td>在select或where子句中出现的子查询</td>
</tr>
<tr>
<td>4</td>
<td>DERIVED</td>
<td>from字句中出现的子查询</td>
</tr>
<tr>
<td>5</td>
<td>UNION</td>
<td>union连接的两个select查询，第一个查询是dervied派生表，除了第一个表外，第二个以后的表select_type都是union。</td>
</tr>
<tr>
<td>6</td>
<td>UNION RESULT</td>
<td>包含union的结果集，在union和union all语句中，因为它不需要参与查询，所以id字段为null</td>
</tr>
<tr>
<td>7</td>
<td>dependent subquery</td>
<td>与dependent union类似，表示这个subquery的查询要受到外部表查询的影响。</td>
</tr>
<tr>
<td>8</td>
<td>dependent union</td>
<td>与union一样，出现在union 或union all语句中，但是这个查询要受到外部查询的影响</td>
</tr>
</tbody></table>
<p><strong>table</strong> 显示的查询表名，如果查询使用了别名，那么这里显示的是别名。</p>
<p><strong>type</strong>访问类型(非常重要，可以看到有没有走索引)</p>
<p><strong>依次从好到差：system，const，eq_ref，ref，fulltext，ref_or_null，unique_subquery，index_subquery，range，index_merge，index，ALL。</strong></p>
<p><strong>除了all之外，其他的type都可以使用到索引，除了index_merge之外，其他的type只可以用到一个索引。</strong></p>
<table>
<thead>
<tr>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>system</td>
<td>表中只有一行数据或者是空表，且只能用于myisam和memory表。如果是Innodb引擎表，type列在这个情况通常都是all或者index。</td>
</tr>
<tr>
<td><strong>const</strong></td>
<td><strong>使用唯一索引或者主键，返回记录是1行记录的等值where条件时，通常type是const</strong>。其他数据库也叫做唯一索引扫描。</td>
</tr>
<tr>
<td>eq_ref</td>
<td>出现在要连接多个表的查询计划中，驱动表只返回一行数据，且这行数据是第二个表的主键或者唯一索引，且必须为not null，唯一索引和主键是多列时，只有所有的列都用作比较时才会出现eq_ref。</td>
</tr>
<tr>
<td><strong>ref</strong></td>
<td>像eq_ref那样要求连接顺序，也没有主键和唯一索引的要求，只要使用相等条件检索时就可能出现，<strong>常见于普通索引的等值查找</strong>。或者多列主键、唯一索引中，使用第一个列之外的列作为等值查找也会出现，总之，返回数据不唯一的等值查找就可能出现。</td>
</tr>
<tr>
<td>fulltext</td>
<td>全文索引检索，要注意，全文索引的优先级很高，若全文索引和普通索引同时存在时，mysql不管代价，优先选择使用全文索引。</td>
</tr>
<tr>
<td>ref_or_null</td>
<td>与ref方法类似，只是增加了null值的比较。实际用的不多。</td>
</tr>
<tr>
<td>unique_subquery</td>
<td>用于where中的in形式子查询，子查询返回不重复值唯一值。</td>
</tr>
<tr>
<td>index_subquery</td>
<td>用于in形式子查询使用到了辅助索引或者in常数列表，子查询可能返回重复值，可以使用索引将子查询去重。</td>
</tr>
<tr>
<td><strong>range</strong></td>
<td><strong>索引范围扫描</strong>，常见于使用&gt;,&lt;,is null,between ,in ,like等运算符的查询中。</td>
</tr>
<tr>
<td>index_merge</td>
<td>表示查询使用了两个以上的索引，最后取交集或者并集。常见and ，or的条件使用了不同的索引，官方排序这个在ref_or_null之后，但是实际上由于要读取多个索引，性能可能都不如range。</td>
</tr>
<tr>
<td><strong>index</strong></td>
<td><strong>索引全表扫描</strong>。把索引从头到尾扫一遍，常见于使用索引列就可以处理，不需要读取数据文件的查询、可以使用索引排序或者分组的查询。</td>
</tr>
<tr>
<td><strong>ALL</strong></td>
<td><strong>全表扫描数据文件</strong></td>
</tr>
</tbody></table>
<p><strong>possible_keys</strong> 可能使用的索引，注意不一定会使用。查询涉及到的字段上若存在索引，则该索引将被列出来。当该列为 NULL时就要考虑当前的SQL是否需要优化了。</p>
<p><strong>key</strong> 显示MySQL在查询中实际使用的索引，若没有使用索引，显示为NULL。</p>
<p><strong>key_length</strong> 索引长度</p>
<p><strong>ref</strong> 表示上述表的连接匹配条件，即哪些列或常量被用于查找索引列上的值</p>
<p><strong>rows</strong> 这里是执行计划中估算的扫描行数，不是精确值。</p>
<p><strong>extra</strong> 的信息非常丰富，常见的有：</p>
<ol>
<li>Using index 使用覆盖索引</li>
<li>Using where 使用了where子句来过滤结果集</li>
<li>Using filesort 使用文件排序，使用非索引列进行排序时出现，非常消耗性能，尽量优化。</li>
<li>Using temporary 使用了临时表</li>
</ol>
<p>SQL优化的目标可以参考阿里开发手册</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">【推荐】SQL性能优化的目标：至少要达到 range 级别，要求是ref级别，如果可以是consts最好。</span><br><span class="line">说明：</span><br><span class="line">1） consts 单表中最多只有一个匹配行（主键或者唯一索引），在优化阶段即可读取到数据。</span><br><span class="line">2） ref 指的是使用普通的索引（normal index）。</span><br><span class="line">3） range 对索引进行范围检索。</span><br><span class="line">反例：explain表的结果，type=index，索引物理文件全扫描，速度非常慢，这个index级别比较range还低，与全表扫描是小巫见大巫。</span><br></pre></td></tr></table></figure>



<h3 id="SQL的生命周期？一条SQL查询语句是如何执行的？MySQL总体架构—-gt-SQL执行流程—-gt-语句执行顺序-1"><a href="#SQL的生命周期？一条SQL查询语句是如何执行的？MySQL总体架构—-gt-SQL执行流程—-gt-语句执行顺序-1" class="headerlink" title="@$SQL的生命周期？一条SQL查询语句是如何执行的？MySQL总体架构—&gt;SQL执行流程—&gt;语句执行顺序"></a>@$SQL的生命周期？一条SQL查询语句是如何执行的？MySQL总体架构—&gt;SQL执行流程—&gt;语句执行顺序</h3><p>MySQL 的逻辑架构图</p>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/O8AYEZicmmkmwZEW0CHPKiaicfj0QMyG18ibyTSkJvGnffydmYbtxvzUaFNPTwRE1wN81fbm2t7b5pVMW5SW5h4oicA/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1" alt="图片"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-- 比如，你有个最简单的表，表里只有一个 ID 字段，在执行下面这个查询语句时：</span><br><span class="line">mysql&gt; select * from T where ID=10;</span><br></pre></td></tr></table></figure>

<p>MySQL的框架有几个组件, 各是什么作用? Server层和存储引擎层各是什么作用？</p>
<p>大体来说，MySQL 可以分为 Server 层和存储引擎层两部分。</p>
<p>Server 层包括连接器、分析器、优化器、执行器等，涵盖 MySQL 的大多数核心服务功能，以及所有的内置函数（如日期、时间、数学和加密函数等），所有跨存储引擎的功能都在这一层实现，比如存储过程、触发器、视图等。</p>
<p>而存储引擎层负责数据的存储和提取。其架构模式是插件式的，支持 InnoDB、MyISAM、Memory 等多个存储引擎。现在最常用的存储引擎是 InnoDB，它从 MySQL 5.5.5 版本开始成为了默认存储引擎。</p>
<p>SQL执行流程，SQL的生命周期？</p>
<p>连接器</p>
<p>第一步，客户端与数据库server层的连接器进行连接。连接器负责跟客户端建立连接、获取权限、维持和管理连接。</p>
<p>查询缓存</p>
<p>连接建立完成后，会判断查询缓存是否开启，如果已经开启，会判断sql是select还是update&#x2F;insert&#x2F;delete，对于select，尝试去查询缓存，如果命中缓存直接返回数据给客户端， 如果缓存没有命中，或者没有开启缓存， 会进入到下一步分析器。</p>
<p>分析器</p>
<p>分析器进行词法分析和语法分析，分析器先会做“词法分析”，分析SQL中的字符串分别是什么，校验数据库表和字段是否存在，然后进行语法分析，判断SQL是否满足MySQL语法。</p>
<p>优化器</p>
<p>优化器对sql执行计划分析，得到最终执行计划，得到优化后的执行计划交给执行器。</p>
<p>优化器是在表里面有多个索引的时候，决定使用哪个索引，或者在一个语句有多表关联（join）的时候，决定各个表的连接顺序。</p>
<p>执行器</p>
<p>开始执行的时候，要先判断一下你对这个表 T 有没有执行查询的权限，如果没有，就会返回没有权限的错误，如果有权限，执行器调用存储引擎api执行sql，得到响应结果， 将结果返回给客户端，如果缓存是开启状态， 会更新缓存。</p>
<p>详细逻辑架构图</p>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/O8AYEZicmmkmwZEW0CHPKiaicfj0QMyG18ibUyJWZftDKcGMZSCUe1dzwRLBPajzP9micSC0AoMjPiciccKibsnBRzKJow/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1" alt="图片"></p>
<ol>
<li><p>连接：应用服务器与数据库服务器建立一个连接</p>
</li>
<li><p>获得请求SQL：数据库进程拿到请求sql</p>
</li>
<li><p>查询缓存：如果查询命中缓存则直接返回结果</p>
</li>
<li><p>语法解析和预处理：</p>
<p>首先通过mysql关键字将语句解析，会生成一个内部解析树，mysql解析器将对其解析，查看是否是有错误的关键字，关键字顺序是否正确；预处理器则是根据mysql的规则进行进一步的检查，检查mysql语句是否合法，如库表是否存在，字段是否存在，字段之间是否模棱两可等等，预处理器也会验证权限。</p>
</li>
<li><p>查询优化器：sql语句在优化器中转换成执行计划，一条sql语句可以有多种方式查询，最后返回的结果肯定是相同，但是不同的查询方式效果不同，优化器的作用就是：选择一种合适的执行计划。mysql是基于成本的优化器，他将预测执行此计划的成本，并选择成本最小的那条</p>
</li>
<li><p>执行计划，执行SQL：在解析和优化后，MySQL将生成查询对应的执行计划，由执行计划调用存储引擎的API来执行查询</p>
</li>
<li><p>将结果返回给客户端</p>
</li>
<li><p>关掉连接，释放资源</p>
</li>
</ol>
<h3 id="一条更新语句的执行流程又是怎样的呢？"><a href="#一条更新语句的执行流程又是怎样的呢？" class="headerlink" title="一条更新语句的执行流程又是怎样的呢？"></a>一条更新语句的执行流程又是怎样的呢？</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-- 如果要将 ID=2 这一行的值加 1</span><br><span class="line">mysql&gt; update T set c=c+1 where ID=2;</span><br></pre></td></tr></table></figure>

<p>你执行语句前要先连接数据库，这是连接器的工作。</p>
<p>前面我们说过，在一个表上有更新的时候，跟这个表有关的查询缓存会失效，所以这条语句就会把表 T 上所有缓存结果都清空。这也就是我们一般不建议使用查询缓存的原因。</p>
<p>接下来，分析器会通过词法和语法解析知道这是一条更新语句。优化器决定要使用 ID 这个索引。然后，执行器负责具体执行，找到这一行，然后更新。</p>
<p>与查询流程不一样的是，更新流程还涉及两个重要的日志模块，它们正是我们今天要讨论的主角：redo log（重做日志）和 binlog（归档日志）。</p>
<p>在 MySQL 里也有这个问题，如果每一次的更新操作都需要写进磁盘，然后磁盘也要找到对应的那条记录，然后再更新，整个过程 IO 成本、查找成本都很高。为了解决这个问题，MySQL 的设计者就用了类似酒店掌柜粉板的思路来提升更新效率。</p>
<p>而粉板和账本配合的整个过程，其实就是 MySQL 里经常说到的 WAL 技术，WAL 的全称是 Write-Ahead Logging，它的关键点就是先写日志，再写磁盘，也就是先写粉板，等不忙的时候再写账本。</p>
<p>具体来说，当有一条记录需要更新的时候，InnoDB 引擎就会先把记录写到 redo log（粉板）里面，并更新内存，这个时候更新就算完成了。同时，InnoDB 引擎会在适当的时候，将这个操作记录更新到磁盘里面，而这个更新往往是在系统比较空闲的时候做，这就像打烊以后掌柜做的事。</p>
<p>如果今天赊账的不多，掌柜可以等打烊后再整理。但如果某天赊账的特别多，粉板写满了，又怎么办呢？这个时候掌柜只好放下手中的活儿，把粉板中的一部分赊账记录更新到账本中，然后把这些记录从粉板上擦掉，为记新账腾出空间。</p>
<p>write pos 是当前记录的位置，一边写一边后移，写到第 3 号文件末尾后就回到 0 号文件开头。checkpoint 是当前要擦除的位置，也是往后推移并且循环的，擦除记录前要把记录更新到数据文件。</p>
<p>write pos 和 checkpoint 之间的是“粉板”上还空着的部分，可以用来记录新的操作。如果 write pos 追上 checkpoint，表示“粉板”满了，这时候不能再执行新的更新，得停下来先擦掉一些记录，把 checkpoint 推进一下。</p>
<p>有了 redo log，InnoDB 就可以保证即使数据库发生异常重启，之前提交的记录都不会丢失，这个能力称为<strong>crash-safe</strong>。</p>
<p>要理解 crash-safe 这个概念，可以想想我们前面赊账记录的例子。只要赊账记录记在了粉板上或写在了账本上，之后即使掌柜忘记了，比如突然停业几天，恢复生意后依然可以通过账本和粉板上的数据明确赊账账目。</p>
<p>重要的日志模块：binlog</p>
<p>前面我们讲过，MySQL 整体来看，其实就有两块：一块是 Server 层，它主要做的是 MySQL 功能层面的事情；还有一块是引擎层，负责存储相关的具体事宜。上面我们聊到的粉板 redo log 是 InnoDB 引擎特有的日志，而 Server 层也有自己的日志，称为 binlog（归档日志）。</p>
<p>我想你肯定会问，为什么会有两份日志呢？</p>
<p>因为最开始 MySQL 里并没有 InnoDB 引擎。MySQL 自带的引擎是 MyISAM，但是 MyISAM 没有 crash-safe 的能力，binlog 日志只能用于归档。而 InnoDB 是另一个公司以插件形式引入 MySQL 的，既然只依靠 binlog 是没有 crash-safe 能力的，所以 InnoDB 使用另外一套日志系统——也就是 redo log 来实现 crash-safe 能力。</p>
<p>这两种日志有以下三点不同。</p>
<ol>
<li>redo log 是 InnoDB 引擎特有的；binlog 是 MySQL 的 Server 层实现的，所有引擎都可以使用。</li>
<li>redo log 是物理日志，记录的是“在某个数据页上做了什么修改”；binlog 是逻辑日志，记录的是这个语句的原始逻辑，比如“给 ID&#x3D;2 这一行的 c 字段加 1 ”。</li>
<li>redo log 是循环写的，空间固定会用完；binlog 是可以追加写入的。“追加写”是指 binlog 文件写到一定大小后会切换到下一个，并不会覆盖以前的日志。</li>
</ol>
<h3 id="常用SQL查询语句优化方法"><a href="#常用SQL查询语句优化方法" class="headerlink" title="常用SQL查询语句优化方法"></a>常用SQL查询语句优化方法</h3><ul>
<li>不要使用select * from t，用具体的字段列表代替“*”，使用星号会降低查询效率，如果数据库字段改变，可能出现不可预知隐患。</li>
<li>应尽量避免在where子句中使用!&#x3D;或&lt;&gt;操作符，避免在where子句中字段进行null值判断，存储引擎将放弃使用索引而进行全表扫描。</li>
<li>避免使用左模糊，左模糊查询将导致全表扫描。</li>
<li>IN语句查询时包含的值不应过多，否则将导致全表扫描。</li>
<li>为经常作为查询条件的字段，经常需要排序、分组操作的字段建立索引。</li>
<li>在使用联合索引字段作为条件时，应遵循最左前缀原则。</li>
<li>OR前后两个条件都要有索引，整个SQL才会使用索引，只要有一个条件没索引整个SQL就不会使用索引。</li>
<li>尽量用union all代替union，union需要将结果集合并后再进行唯一性过滤操作，这就会涉及到排序，增加大量的CPU运算，加大资源消耗及延迟。</li>
</ul>
<h2 id="总结-1"><a href="#总结-1" class="headerlink" title="总结"></a>总结</h2><h2 id="ACID"><a href="#ACID" class="headerlink" title="ACID"></a>ACID</h2><h2 id="隔离级别"><a href="#隔离级别" class="headerlink" title="隔离级别"></a>隔离级别</h2><h1 id="Explain工具介绍"><a href="#Explain工具介绍" class="headerlink" title="Explain工具介绍"></a>Explain工具介绍</h1><p>使用EXPLAIN关键字可以模拟优化器执行SQL语句，分析你的查询语句或是结构的性能瓶颈</p>
<p>在 select 语句之前增加 explain 关键字，MySQL 会在查询上设置一个标记，执行查询会返回执行计划的信息，而不是</p>
<p>执行这条SQL</p>
<p>注意：如果 from 中包含子查询，仍会执行该子查询，将结果放入临时表中</p>
<p>Explain分析示例</p>
<p>示例表</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> ggq_tulin;</span><br><span class="line">USE ggq_tulin;</span><br><span class="line"></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> IF <span class="keyword">EXISTS</span> `actor`;</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `actor` (</span><br><span class="line">`id` <span class="type">INT</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">`name` <span class="type">VARCHAR</span>(<span class="number">45</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">`update_time` DATETIME <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line"><span class="keyword">PRIMARY</span> KEY (`id`)</span><br><span class="line">) ENGINE<span class="operator">=</span>INNODB <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SHOW</span> <span class="keyword">CREATE</span> DATABASE ggq_tulin;</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `actor` (`id`, `name`, `update_time`) <span class="keyword">VALUES</span> (<span class="number">1</span>,<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;2017-12-22 15:27:18&#x27;</span>),</span><br><span class="line"> (<span class="number">2</span>,<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;2017-12-22 15:27:18&#x27;</span>), (<span class="number">3</span>,<span class="string">&#x27;c&#x27;</span>,<span class="string">&#x27;2017-12-22 15:27:18&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> actor;</span><br><span class="line"></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> IF <span class="keyword">EXISTS</span> `film`;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `film` (</span><br><span class="line">`id` <span class="type">INT</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT,</span><br><span class="line">`name` <span class="type">VARCHAR</span>(<span class="number">10</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line"><span class="keyword">PRIMARY</span> KEY (`id`),</span><br><span class="line">KEY `idx_name` (`name`)</span><br><span class="line">) ENGINE<span class="operator">=</span>INNODB <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SHOW</span> DATABASES;</span><br><span class="line">USE ggq_tuling;</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `film` (`id`, `name`) <span class="keyword">VALUES</span> (<span class="number">3</span>,<span class="string">&#x27;film0&#x27;</span>),(<span class="number">1</span>,<span class="string">&#x27;film1&#x27;</span>),(<span class="number">2</span>,<span class="string">&#x27;film2&#x27;</span>);</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> film;</span><br><span class="line"></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> IF <span class="keyword">EXISTS</span> `film_actor`;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `film_actor` (</span><br><span class="line">`id` <span class="type">INT</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">`film_id` <span class="type">INT</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">`actor_id` <span class="type">INT</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">`remark` <span class="type">VARCHAR</span>(<span class="number">255</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line"><span class="keyword">PRIMARY</span> KEY (`id`),</span><br><span class="line">KEY `idx_film_actor_id` (`film_id`,`actor_id`)</span><br><span class="line">) ENGINE<span class="operator">=</span>INNODB <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8;</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `film_actor` (`id`, `film_id`, `actor_id`) <span class="keyword">VALUES</span> (<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>),(<span class="number">2</span>,<span class="number">1</span>,<span class="number">2</span>),(<span class="number">3</span>,<span class="number">2</span>,<span class="number">1</span>);</span><br></pre></td></tr></table></figure>



<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">explain <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> actor;</span><br></pre></td></tr></table></figure>

<blockquote>
<p><img src="/../images/image-20220926132103157-1666009042664.png" alt="image-20220926132103157"></p>
</blockquote>
<p>在查询中的每个表会输出一行，如果有两个表通过 join 连接查询，那么会输出两行</p>
<p>explain 两个变种</p>
<p>1紧随其后通过 show warnings 命令可</p>
<p>以得到优化后的查询语句，从而看出优化器优化了什么。额外还有 filtered 列，是一个半分比的值，rows *</p>
<p>filtered&#x2F;100 可以<strong>估算</strong>出将要和 explain 中前一个表进行连接的行数（前一个表指 explain 中的id值比当前表id值小的</p>
<p>表）。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">explain  <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> film <span class="keyword">where</span> id <span class="operator">=</span> <span class="number">1</span>; </span><br><span class="line"></span><br><span class="line"><span class="keyword">show</span> warnings;</span><br></pre></td></tr></table></figure>

<blockquote>
<p> <img src="/../images/image-20220926132339904-1666009042664.png" alt="image-20220926132339904"></p>
</blockquote>
<h2 id="explain中的列"><a href="#explain中的列" class="headerlink" title="explain中的列"></a>explain中的列</h2><p>接下来我们将展示 explain 中每个列的信息。</p>
<h3 id="1-id列"><a href="#1-id列" class="headerlink" title="\1. id列"></a>\1. id列</h3><p>不一定唯一</p>
<p>id列的编号是 select 的序列号，有几个 select 就有几个id，并且id的顺序是按 select 出现的顺序增长的。</p>
<p><strong>id列越大执行优先级越高</strong>，id相同则从上往下执行，id为NULL最后执行。</p>
<h3 id="2-select-type列"><a href="#2-select-type列" class="headerlink" title="\2. select_type列"></a>\2. select_type列</h3><p>select_type 表示对应行是简单还是复杂的查询。</p>
<p>1）simple：简单查询。查询不包含子查询和union</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span> mysql<span class="operator">&gt;</span> explain <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> film <span class="keyword">where</span> id <span class="operator">=</span> <span class="number">2</span>;</span><br></pre></td></tr></table></figure>

<p>2）primary：复杂查询中<strong>最外层的 select</strong></p>
<p>3）subquery：包含在 <strong>select</strong> 中的子查询（不在 from 子句中）</p>
<p>4）derived：包含在 <strong>from</strong> 子句中的子查询。MySQL会将结果存放在一个临时表(原来没有的表)中，也称为派生(衍生)表（derived的英文含</p>
<p>义）</p>
<p>用这个例子来了解 primary、subquery 和 derived 类型</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span> mysql<span class="operator">&gt;</span> <span class="keyword">set</span> session optimizer_switch<span class="operator">=</span><span class="string">&#x27;derived_merge=off&#x27;</span>; #关闭mysql5<span class="number">.7</span>新特性对衍生表的合并优化</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">2</span> mysql<span class="operator">&gt;</span> explain <span class="keyword">select</span> (<span class="keyword">select</span> <span class="number">1</span> <span class="keyword">from</span> actor <span class="keyword">where</span> id <span class="operator">=</span> <span class="number">1</span>) <span class="keyword">from</span> (<span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> film <span class="keyword">where</span> id <span class="operator">=</span> <span class="number">1</span>) der;</span><br><span class="line"></span><br><span class="line"><span class="number">1</span> mysql<span class="operator">&gt;</span> <span class="keyword">set</span> session optimizer_switch<span class="operator">=</span><span class="string">&#x27;derived_merge=on&#x27;</span>; #还原默认配置</span><br></pre></td></tr></table></figure>

<p><img src="/../images/image-20220926133715839-1666009042665.png" alt="image-20220926133715839"></p>
<p>5）union：在 union 中的第二个和随后的 select</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span> mysql<span class="operator">&gt;</span> explain <span class="keyword">select</span> <span class="number">1</span> <span class="keyword">union</span> <span class="keyword">all</span> <span class="keyword">select</span> <span class="number">1</span>;</span><br></pre></td></tr></table></figure>



<h3 id="3-table列"><a href="#3-table列" class="headerlink" title="\3. table列"></a>\3. table列</h3><p>这一列表示 <strong>explain 的一行正在访问哪个表</strong>。</p>
<p><strong>当 from 子句中有子查询时，table列是 <derivenN> 格式，表示当前查询依赖 id&#x3D;N 的查询，于是先执行 id&#x3D;N 的查</derivenN></strong></p>
<p><strong>询。</strong></p>
<p><strong>当有 union 时，UNION RESULT 的 table 列的值为&lt;union1,2&gt;，1和2表示参与 union 的 select 行id。</strong></p>
<h3 id="4-type列"><a href="#4-type列" class="headerlink" title="\4. type列"></a>\4. type列</h3><p>这一列表示关联类型或访问类型，即MySQL决定如何查找表中的行，<strong>查找数据行记录的大概范围</strong>。</p>
<p>效率依次从最优到最差分别为：<strong>system &gt; const &gt; eq_ref &gt; ref &gt; range &gt; index &gt; ALL</strong></p>
<p>一般来说，得保证查询达到range级别，最好达到ref</p>
<p>很少: NULL：mysql能够在优化阶段分解查询语句，在执行阶段用不着再访问表或索引。例如：在索引列中选取最小值，可</p>
<p>以单独查找索引来完成，不需要在执行时访问表</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span> mysql<span class="operator">&gt;</span> explain <span class="keyword">select</span> <span class="built_in">min</span>(id) <span class="keyword">from</span> film;</span><br></pre></td></tr></table></figure>



<p>const, system：mysql能对查询的某部分进行优化并将其转化成一个<strong>常量</strong>（可以看show warnings 的结果）。用于</p>
<p>primary key 或 unique key 的所有列与常数比较时，所以表最多有一个匹配行，读取1次，速度比较快。system是</p>
<p>const的特例，表里只有<strong>一条元组匹配时为system</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span> mysql<span class="operator">&gt;</span> explain extended <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> (<span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> film <span class="keyword">where</span> id <span class="operator">=</span> <span class="number">1</span>) tmp;</span><br><span class="line"></span><br><span class="line"><span class="number">1</span> mysql<span class="operator">&gt;</span> <span class="keyword">show</span> warnings;</span><br></pre></td></tr></table></figure>



<p>eq_ref：<strong>primary key 或 unique key 索引的所有部分被连接使用&#x2F;唯一索引</strong> ，最多只会返回<strong>一条符合条件</strong>的记录。这可能是在</p>
<p>const 之外最好的联接类型了，简单的 select 查询不会出现这种 type。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span> mysql<span class="operator">&gt;</span> explain <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> film_actor <span class="keyword">left</span> <span class="keyword">join</span> film <span class="keyword">on</span> film_actor.film_id <span class="operator">=</span> film.id;</span><br></pre></td></tr></table></figure>



<p>ref：相比 eq_ref，不使用唯一索引，而是使用<strong>普通索引</strong>或者<strong>唯一性索引的部分前缀</strong>，索引要和某个值相比较，可能会</p>
<p>找到<strong>多个符合条件</strong>的行。</p>
<p>\1. 简单 select 查询，name是普通索引（非唯一索引）</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span> mysql<span class="operator">&gt;</span> explain <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> film <span class="keyword">where</span> name <span class="operator">=</span> <span class="string">&#x27;film1&#x27;</span>;</span><br></pre></td></tr></table></figure>



<p>2.关联表查询，idx_film_actor_id是film_id和actor_id的联合索引，这里使用到了film_actor的左边前缀film_id部分。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span> mysql<span class="operator">&gt;</span> explain <span class="keyword">select</span> film_id <span class="keyword">from</span> film <span class="keyword">left</span> <span class="keyword">join</span> film_actor <span class="keyword">on</span> film.id <span class="operator">=</span> film_actor.fi</span><br></pre></td></tr></table></figure>



<p>lm_id;</p>
<p>range：范围扫描通常出现在 in(), between ,&gt; ,&lt;, &gt;&#x3D; 等操作中。使用一个索引来检索给定范围的行。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span> mysql<span class="operator">&gt;</span> explain <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> actor <span class="keyword">where</span> id <span class="operator">&gt;</span> <span class="number">1</span>;</span><br></pre></td></tr></table></figure>



<p>index：扫描全索引就能拿到结果，一般是扫描某个二级索引，这种扫描不会从索引树根节点开始快速查找，而是直接</p>
<p>对二级索引的叶子节点遍历和扫描，速度还是比较慢的，这种查询一般为使用覆盖索引，二级索引一般比较小，所以这</p>
<p>种通常比ALL快一些。</p>
<p>1 mysql&gt; explain select * from film;</p>
<p>ALL：即全表扫描，扫描你的聚簇索引的所有叶子节点。通常情况下这需要增加索引来进行优化了。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span> mysql<span class="operator">&gt;</span> explain <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> actor;</span><br></pre></td></tr></table></figure>



<h3 id="5-possible-keys列"><a href="#5-possible-keys列" class="headerlink" title="\5. possible_keys列"></a>\5. possible_keys列</h3><p>这一列显示查询可能使用哪些索引来查找。</p>
<p>explain 时可能出现 possible_keys 有列，而 key 显示 NULL 的情况，这种情况是因为表中数据不多，mysql认为索引</p>
<p>对此查询帮助不大，选择了全表查询。</p>
<p>如果该列是NULL，则没有相关的索引。在这种情况下，可以通过检查 where 子句看是否可以创造一个适当的索引来提</p>
<p>高查询性能，然后用 explain 查看效果。</p>
<h3 id="6-key列"><a href="#6-key列" class="headerlink" title="\6. key列"></a>\6. key列</h3><p>这一列显示mysql实际采用哪个索引来优化对该表的访问。</p>
<p>如果没有使用索引，则该列是 NULL。如果想强制mysql使用或忽视possible_keys列中的索引，在查询中使用 force</p>
<p>index、ignore index。</p>
<h3 id="7-key-len列"><a href="#7-key-len列" class="headerlink" title="\7. key_len列"></a>\7. key_len列</h3><p>这一列显示了mysql在索引里使用的字节数，通过这个值可以算出具体使用了索引中的哪些列。</p>
<p>举例来说，film_actor的联合索引 idx_film_actor_id 由 film_id 和 actor_id 两个int列组成，并且每个int是4字节。通</p>
<p>过结果中的key_len&#x3D;4可推断出查询使用了第一个列：film_id列来执行索引查找。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span> mysql<span class="operator">&gt;</span> explain <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> film_actor <span class="keyword">where</span> film_id <span class="operator">=</span> <span class="number">2</span>;</span><br></pre></td></tr></table></figure>



<p>key_len计算规则如下：</p>
<p>字符串，char(n)和varchar(n)，5.0.3以后版本中，n均代表字符数，而不是字节数，如果是utf-8，一个数字</p>
<p>或字母占1个字节，一个汉字占3个字节</p>
<p>char(n)：如果存汉字长度就是 3n 字节</p>
<p>varchar(n)：如果存汉字则长度是 3n + 2 字节，加的2字节用来存储字符串长度，因为</p>
<p>varchar是变长字符串</p>
<p>数值类型</p>
<p>tinyint：1字节</p>
<p>smallint：2字节</p>
<p>int：4字节</p>
<p>bigint：8字节</p>
<p>时间类型</p>
<p>date：3字节</p>
<p>timestamp：4字节</p>
<p>datetime：8字节</p>
<p>如果字段允许为 NULL，需要1字节记录是否为 NULL</p>
<p>索引最大长度是768字节，当字符串过长时，mysql会做一个类似左前缀索引的处理，将前半部分的字符提取出来做索</p>
<p>引。</p>
<h3 id="8-ref列"><a href="#8-ref列" class="headerlink" title="\8. ref列"></a>\8. ref列</h3><p>这一列显示了在key列记录的索引中，表查找值所用到的列或常量，常见的有：const（常量），字段名（例：film.id）</p>
<h3 id="9-rows列"><a href="#9-rows列" class="headerlink" title="\9. rows列"></a>\9. rows列</h3><p>这一列是mysql估计要读取并检测的行数，注意这个不是结果集里的行数。</p>
<h3 id="10-Extra列"><a href="#10-Extra列" class="headerlink" title="\10. Extra列"></a>\10. Extra列</h3><p>这一列展示的是额外信息。常见的重要值如下：</p>
<p>1）Using index：使用覆盖索引</p>
<p>覆盖索引定义：mysql执行计划explain结果里的key有使用索引，如果select后面查询的字段都可以从这个索引的树中</p>
<p>获取，这种情况一般可以说是用到了覆盖索引，extra里一般都有using index；覆盖索引一般针对的是辅助索引，整个</p>
<p>查询结果只通过辅助索引就能拿到结果，不需要通过辅助索引树找到主键，再通过主键去主键索引树里获取其它字段值</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span> mysql<span class="operator">&gt;</span> explain <span class="keyword">select</span> film_id <span class="keyword">from</span> film_actor <span class="keyword">where</span> film_id <span class="operator">=</span> <span class="number">1</span>;</span><br></pre></td></tr></table></figure>



<p>2）Using where：使用 where 语句来处理结果，并且查询的列未被索引覆盖</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span> mysql<span class="operator">&gt;</span> explain <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> actor <span class="keyword">where</span> name <span class="operator">=</span> <span class="string">&#x27;a&#x27;</span>;</span><br></pre></td></tr></table></figure>



<p>3）Using index condition：查询的列不完全被索引覆盖，where条件中是一个前导列的范围；</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span> mysql<span class="operator">&gt;</span> explain <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> film_actor <span class="keyword">where</span> film_id <span class="operator">&gt;</span> <span class="number">1</span>;</span><br></pre></td></tr></table></figure>



<p>4）Using temporary：mysql需要创建一张临时表来处理查询。出现这种情况一般是要进行优化的，首先是想到用索</p>
<p>引来优化。</p>
<p>\1. actor.name没有索引，此时创建了张临时表来distinct</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span> mysql<span class="operator">&gt;</span> explain <span class="keyword">select</span> <span class="keyword">distinct</span> name <span class="keyword">from</span> actor;</span><br></pre></td></tr></table></figure>



<p>\2. film.name建立了idx_name索引，此时查询时extra是using index,没有用临时表</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span> mysql<span class="operator">&gt;</span> explain <span class="keyword">select</span> <span class="keyword">distinct</span> name <span class="keyword">from</span> film;</span><br></pre></td></tr></table></figure>



<p>5）Using filesort：将用外部排序而不是索引排序，数据较小时从内存排序，否则需要在磁盘完成排序。这种情况下一</p>
<p>般也是要考虑使用索引来优化的。</p>
<p>\1. actor.name未创建索引，会浏览actor整个表，保存排序关键字name和对应的id，然后排序name并检索行记录</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span> mysql<span class="operator">&gt;</span> explain <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> actor <span class="keyword">order</span> <span class="keyword">by</span> name;</span><br></pre></td></tr></table></figure>



<p>\2. film.name建立了idx_name索引,此时查询时extra是using index</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span> mysql<span class="operator">&gt;</span> explain <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> film <span class="keyword">order</span> <span class="keyword">by</span> name;</span><br></pre></td></tr></table></figure>



<p>6）Select tables optimized away：使用某些聚合函数（比如 max、min）来访问存在索引的某个字段是</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span> mysql<span class="operator">&gt;</span> explain <span class="keyword">select</span> <span class="built_in">min</span>(id) <span class="keyword">from</span> film;</span><br></pre></td></tr></table></figure>



<h2 id="索引最佳实践"><a href="#索引最佳实践" class="headerlink" title="索引最佳实践"></a>索引最佳实践</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span> 示例表：</span><br><span class="line"></span><br><span class="line"><span class="number">2</span> <span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `employees` (</span><br><span class="line"></span><br><span class="line"><span class="number">3</span> `id` <span class="type">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT,</span><br><span class="line"></span><br><span class="line"><span class="number">4</span> `name` <span class="type">varchar</span>(<span class="number">24</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">&#x27;&#x27;</span> COMMENT <span class="string">&#x27;姓名&#x27;</span>,</span><br><span class="line"></span><br><span class="line"><span class="number">5</span> `age` <span class="type">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">&#x27;0&#x27;</span> COMMENT <span class="string">&#x27;年龄&#x27;</span>,</span><br><span class="line"></span><br><span class="line"><span class="number">6</span> `position` <span class="type">varchar</span>(<span class="number">20</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">&#x27;&#x27;</span> COMMENT <span class="string">&#x27;职位&#x27;</span>,</span><br><span class="line"></span><br><span class="line"><span class="number">7</span> `hire_time` <span class="type">timestamp</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="built_in">CURRENT_TIMESTAMP</span> COMMENT <span class="string">&#x27;入职时间&#x27;</span>,</span><br><span class="line"></span><br><span class="line"><span class="number">8</span> <span class="keyword">PRIMARY</span> KEY (`id`),</span><br><span class="line"></span><br><span class="line"><span class="number">9</span> KEY `idx_name_age_position` (`name`,`age`,`position`) <span class="keyword">USING</span> BTREE</span><br><span class="line"></span><br><span class="line"><span class="number">10</span> ) ENGINE<span class="operator">=</span>InnoDB AUTO_INCREMENT<span class="operator">=</span><span class="number">4</span> <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8 COMMENT<span class="operator">=</span><span class="string">&#x27;员工记录表&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="number">11</span></span><br><span class="line"></span><br><span class="line"><span class="number">12</span> <span class="keyword">INSERT</span> <span class="keyword">INTO</span> employees(name,age,position,hire_time) <span class="keyword">VALUES</span>(<span class="string">&#x27;LiLei&#x27;</span>,<span class="number">22</span>,<span class="string">&#x27;manager&#x27;</span>,NOW());</span><br><span class="line"></span><br><span class="line"><span class="number">13</span> <span class="keyword">INSERT</span> <span class="keyword">INTO</span> employees(name,age,position,hire_time) <span class="keyword">VALUES</span>(<span class="string">&#x27;HanMeimei&#x27;</span>,</span><br><span class="line"></span><br><span class="line"><span class="number">23</span>,<span class="string">&#x27;dev&#x27;</span>,NOW());</span><br><span class="line"></span><br><span class="line"><span class="number">14</span> <span class="keyword">INSERT</span> <span class="keyword">INTO</span> employees(name,age,position,hire_time) <span class="keyword">VALUES</span>(<span class="string">&#x27;Lucy&#x27;</span>,<span class="number">23</span>,<span class="string">&#x27;dev&#x27;</span>,NOW());</span><br></pre></td></tr></table></figure>



<p>1.全值匹配</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span> EXPLAIN <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> employees <span class="keyword">WHERE</span> name<span class="operator">=</span> <span class="string">&#x27;LiLei&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="number">1</span> EXPLAIN <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> employees <span class="keyword">WHERE</span> name<span class="operator">=</span> <span class="string">&#x27;LiLei&#x27;</span> <span class="keyword">AND</span> age <span class="operator">=</span> <span class="number">22</span>;</span><br><span class="line"></span><br><span class="line"><span class="number">1</span> EXPLAIN <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> employees <span class="keyword">WHERE</span> name<span class="operator">=</span> <span class="string">&#x27;LiLei&#x27;</span> <span class="keyword">AND</span> age <span class="operator">=</span> <span class="number">22</span> <span class="keyword">AND</span> position <span class="operator">=</span><span class="string">&#x27;manager&#x27;</span>;</span><br></pre></td></tr></table></figure>



<p>2.最左前缀法则</p>
<p>如果索引了多列，要遵守最左前缀法则。指的是查询从索引的最左前列开始并且不跳过索引中的列。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span> EXPLAIN <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> employees <span class="keyword">WHERE</span> name <span class="operator">=</span> <span class="string">&#x27;Bill&#x27;</span> <span class="keyword">and</span> age <span class="operator">=</span> <span class="number">31</span>;</span><br><span class="line"></span><br><span class="line"><span class="number">2</span> EXPLAIN <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> employees <span class="keyword">WHERE</span> age <span class="operator">=</span> <span class="number">30</span> <span class="keyword">AND</span> position <span class="operator">=</span> <span class="string">&#x27;dev&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="number">3</span> EXPLAIN <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> employees <span class="keyword">WHERE</span> position <span class="operator">=</span> <span class="string">&#x27;manager&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="number">3.</span>不在索引列上做任何操作（计算、函数、（自动<span class="keyword">or</span>手动）类型转换），会导致索引失效而转向全表扫描</span><br><span class="line"></span><br><span class="line"><span class="number">1</span> EXPLAIN <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> employees <span class="keyword">WHERE</span> name <span class="operator">=</span> <span class="string">&#x27;LiLei&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="number">2</span> EXPLAIN <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> employees <span class="keyword">WHERE</span> <span class="keyword">left</span>(name,<span class="number">3</span>) <span class="operator">=</span> <span class="string">&#x27;LiLei&#x27;</span>;</span><br></pre></td></tr></table></figure>



<p>给hire_time增加一个普通索引：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span> <span class="keyword">ALTER</span> <span class="keyword">TABLE</span> `employees` <span class="keyword">ADD</span> INDEX `idx_hire_time` (`hire_time`) <span class="keyword">USING</span> BTREE ;</span><br><span class="line"></span><br><span class="line"><span class="number">1</span> EXPLAIN <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> employees <span class="keyword">where</span> <span class="type">date</span>(hire_time) <span class="operator">=</span><span class="string">&#x27;2018‐09‐30&#x27;</span>;</span><br></pre></td></tr></table></figure>



<p>转化为日期范围查询，有可能会走索引：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span> EXPLAIN <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> employees <span class="keyword">where</span> hire_time <span class="operator">&gt;=</span><span class="string">&#x27;2018‐09‐30 00:00:00&#x27;</span> <span class="keyword">and</span> hire_time <span class="operator">&lt;</span></span><br><span class="line"></span><br><span class="line"><span class="operator">=</span><span class="string">&#x27;2018‐09‐30 23:59:59&#x27;</span>;</span><br></pre></td></tr></table></figure>



<p>还原最初索引状态</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span> <span class="keyword">ALTER</span> <span class="keyword">TABLE</span> `employees` <span class="keyword">DROP</span> INDEX `idx_hire_time`;</span><br></pre></td></tr></table></figure>



<p>4.存储引擎不能使用索引中范围条件右边的列</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span> EXPLAIN <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> employees <span class="keyword">WHERE</span> name<span class="operator">=</span> <span class="string">&#x27;LiLei&#x27;</span> <span class="keyword">AND</span> age <span class="operator">=</span> <span class="number">22</span> <span class="keyword">AND</span> position <span class="operator">=</span><span class="string">&#x27;manager&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="number">2</span> EXPLAIN <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> employees <span class="keyword">WHERE</span> name<span class="operator">=</span> <span class="string">&#x27;LiLei&#x27;</span> <span class="keyword">AND</span> age <span class="operator">&gt;</span> <span class="number">22</span> <span class="keyword">AND</span> position <span class="operator">=</span><span class="string">&#x27;manager&#x27;</span>;</span><br></pre></td></tr></table></figure>



<p>5.尽量使用覆盖索引（只访问索引的查询（索引列包含查询列）），减少 select * 语句</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span> EXPLAIN <span class="keyword">SELECT</span> name,age <span class="keyword">FROM</span> employees <span class="keyword">WHERE</span> name<span class="operator">=</span> <span class="string">&#x27;LiLei&#x27;</span> <span class="keyword">AND</span> age <span class="operator">=</span> <span class="number">23</span> <span class="keyword">AND</span> position</span><br><span class="line"></span><br><span class="line"><span class="operator">=</span><span class="string">&#x27;manager&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="number">1</span> EXPLAIN <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> employees <span class="keyword">WHERE</span> name<span class="operator">=</span> <span class="string">&#x27;LiLei&#x27;</span> <span class="keyword">AND</span> age <span class="operator">=</span> <span class="number">23</span> <span class="keyword">AND</span> position <span class="operator">=</span><span class="string">&#x27;manage</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">r&#x27;</span>;</span><br></pre></td></tr></table></figure>



<p>6.mysql在使用不等于（！&#x3D;或者&lt;&gt;），not in ，not exists 的时候无法使用索引会导致全表扫描</p>
<p>&lt; 小于、 &gt; 大于、 &lt;&#x3D;、&gt;&#x3D; 这些，mysql内部优化器会根据检索比例、表大小等多个因素整体评估是否使用索引</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span> EXPLAIN <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> employees <span class="keyword">WHERE</span> name <span class="operator">!=</span> <span class="string">&#x27;LiLei&#x27;</span>;</span><br></pre></td></tr></table></figure>



<p>7.is null,is not null 一般情况下也无法使用索引</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span> EXPLAIN <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> employees <span class="keyword">WHERE</span> name <span class="keyword">is</span> <span class="keyword">null</span></span><br></pre></td></tr></table></figure>



<p>8.like以通配符开头（’$abc…’）mysql索引失效会变成全表扫描操作</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span> EXPLAIN <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> employees <span class="keyword">WHERE</span> name <span class="keyword">like</span> <span class="string">&#x27;%Lei&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="number">1</span> EXPLAIN <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> employees <span class="keyword">WHERE</span> name <span class="keyword">like</span> <span class="string">&#x27;Lei%&#x27;</span></span><br></pre></td></tr></table></figure>



<p>问题：解决like’%字符串%’索引不被使用的方法？</p>
<p>a）使用覆盖索引，查询字段必须是建立覆盖索引字段</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span> EXPLAIN <span class="keyword">SELECT</span> name,age,position <span class="keyword">FROM</span> employees <span class="keyword">WHERE</span> name <span class="keyword">like</span> <span class="string">&#x27;%Lei%&#x27;</span>;</span><br></pre></td></tr></table></figure>



<p>b）如果不能使用覆盖索引则可能需要借助搜索引擎</p>
<p>9.字符串不加单引号索引失效</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1 EXPLAIN SELECT * FROM employees WHERE name = &#x27;1000&#x27;;</span><br><span class="line"></span><br><span class="line">2 EXPLAIN SELECT * FROM employees WHERE name = 1000;</span><br></pre></td></tr></table></figure>



<p>10.少用or或in，用它查询时，mysql不一定使用索引，mysql内部优化器会根据检索比例、表大小等多个因素整体评</p>
<p>估是否使用索引，详见范围查询优化</p>
<p>1 EXPLAIN SELECT * FROM employees WHERE name &#x3D; ‘LiLei’ or name &#x3D; ‘HanMeimei’;</p>
<p>11.范围查询优化</p>
<p>给年龄添加单值索引</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span> <span class="keyword">ALTER</span> <span class="keyword">TABLE</span> `employees` <span class="keyword">ADD</span> INDEX `idx_age` (`age`) <span class="keyword">USING</span> BTREE ;</span><br><span class="line"></span><br><span class="line"><span class="number">1</span> explain <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> employees <span class="keyword">where</span> age <span class="operator">&gt;=</span><span class="number">1</span> <span class="keyword">and</span> age <span class="operator">&lt;=</span><span class="number">2000</span>;</span><br></pre></td></tr></table></figure>



<p>没走索引原因：mysql内部优化器会根据检索比例、表大小等多个因素整体评估是否使用索引。比如这个例子，可能是</p>
<p>由于单次数据量查询过大导致优化器最终选择不走索引</p>
<p>优化方法：可以将大的范围拆分成多个小范围</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span> explain <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> employees <span class="keyword">where</span> age <span class="operator">&gt;=</span><span class="number">1</span> <span class="keyword">and</span> age <span class="operator">&lt;=</span><span class="number">1000</span>;</span><br><span class="line"></span><br><span class="line"><span class="number">2</span> explain <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> employees <span class="keyword">where</span> age <span class="operator">&gt;=</span><span class="number">1001</span> <span class="keyword">and</span> age <span class="operator">&lt;=</span><span class="number">2000</span>;</span><br></pre></td></tr></table></figure>



<p>还原最初索引状态</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span> <span class="keyword">ALTER</span> <span class="keyword">TABLE</span> `employees` <span class="keyword">DROP</span> INDEX `idx_age`;</span><br></pre></td></tr></table></figure>



<p>索引使用总结：</p>
<p>like KK%相当于&#x3D;常量，%KK和%KK% 相当于范围</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span> ‐‐ mysql5<span class="number">.7</span>关闭ONLY_FULL_GROUP_BY报错</span><br><span class="line"></span><br><span class="line"><span class="number">2</span> <span class="keyword">select</span> version(), @<span class="variable">@sql</span>_mode;<span class="keyword">SET</span> sql_mode<span class="operator">=</span>(<span class="keyword">SELECT</span> REPLACE(@<span class="variable">@sql</span>_mode,<span class="string">&#x27;ONLY_FULL_GROUP_BY&#x27;</span>,<span class="string">&#x27;&#x27;</span>));</span><br></pre></td></tr></table></figure>



<p>文档：02-VIP-Explain详解与索引最佳实践</p>
<p>1 <a target="_blank" rel="noopener" href="http://note.youdao.com/noteshare?id=59d7a574ef9a905e3bb0982bbe33e74d&amp;sub=83A39BAAADD14B8F99E1DCEFFB">http://note.youdao.com/noteshare?id=59d7a574ef9a905e3bb0982bbe33e74d&amp;sub=83A39BAAADD14B8F99E1DCEFFB</a></p>
<p>7642CA</p>
<h1 id="随笔"><a href="#随笔" class="headerlink" title="随笔"></a>随笔</h1><p>什么是候选键：能够完全决定所有属性的那个属性或者属性组是候选键<br>什么是非主属性：不包含在任何候选键中的属性是非主属性<br>什么是完全函数依赖：如果x决定y那么x的任何一个真子集x&#96;都不能决定y 就叫做</p>
<p><img src="/../images/image-20220422213505915.png" alt="image-20220422213505915"></p>
<p><img src="/../images/image-20220422213456579.png" alt="image-20220422213456579"></p>
<h3 id="24-3-SQL语句分类"><a href="#24-3-SQL语句分类" class="headerlink" title="24.3 SQL语句分类"></a>24.3 SQL语句分类</h3><p>DDL：数据定义语句【create 表，库…】</p>
<p>DML：数据操作语句【增加 insert，修改update，删除delete】</p>
<p>DQL：数据查询语句【select】</p>
<p>DCL：数据控制语句【管理数据库：比如用户权限 grant revoke】</p>
<h1 id="第24章-零基础-MYSQL"><a href="#第24章-零基础-MYSQL" class="headerlink" title="第24章 零基础 MYSQL"></a>第24章 零基础 MYSQL</h1><p>管理员身份开启cmd ,net start mysql</p>
<p>登陆mysql</p>
<p><img src="/../images/image-20220117154239967.png" alt="image-20220117154239967"></p>
<p>root 默认密码 什么都没有 直接回车就行</p>
<p><img src="/../images/image-20220117154320826.png" alt="image-20220117154320826"></p>
<h3 id="24-1数据库三层结构"><a href="#24-1数据库三层结构" class="headerlink" title="24.1数据库三层结构"></a>24.1数据库三层结构</h3><p>1.所谓安装Mysql数据库，就是在主机安装一个数据库管理系统（DBMS，data base manage system），这个管理程序可以管理多个数据库。</p>
<p>2.一个数据库可以创建多个表，以保存数据（信息）</p>
<p>3，数据库管理系统，数据库和表的关系如图所示</p>
<p><img src="/../images/image-20220117153139548.png" alt="image-20220117153139548"></p>
<p>客户端，java等通过过3306端口与DBMS通信对数据库操作</p>
<p>普通表的本质仍然是文件</p>
<h3 id="24-2-数据在数据库中的存储方式"><a href="#24-2-数据在数据库中的存储方式" class="headerlink" title="24.2 数据在数据库中的存储方式"></a>24.2 数据在数据库中的存储方式</h3><p><img src="/../images/image-20220117153440229.png" alt="image-20220117153440229"></p>
<h3 id="24-3-SQL语句分类-1"><a href="#24-3-SQL语句分类-1" class="headerlink" title="24.3 SQL语句分类"></a>24.3 SQL语句分类</h3><p>DDL：数据定义语句【create 表，库…】</p>
<p>DML：数据操作语句【增加 insert，修改update，删除delete】</p>
<p>DQL：数据查询语句【select】</p>
<p>DCL：数据控制语句【管理数据库：比如用户权限 grant revoke】</p>
<h3 id="24-4-创建数据库"><a href="#24-4-创建数据库" class="headerlink" title="24.4 创建数据库"></a>24.4 创建数据库</h3><p><img src="/../images/image-20220117155455762.png" alt="image-20220117155455762"></p>
<p>反引号 将关键字括在一起可创建带关键字的数据库</p>
<p>备份和</p>
<p><img src="/../images/image-20220118161207719.png" alt="image-20220118161207719"></p>
<p>CHARACTER SET 指定数据库采用的字符集，如果不指定字符集，默认utf8</p>
<p>COLLATE：指定数据库字符集的校对规则（常用的utf8_bin[区分大小写]、默认是utf8_general_ci[不区分大小写]）</p>
<h3 id="24-5查看、删除数据库"><a href="#24-5查看、删除数据库" class="headerlink" title="24.5查看、删除数据库"></a>24.5查看、删除数据库</h3><p>显示数据库语句：show databases</p>
<p>显示数据库创建语句：show create database db_name</p>
<p>数据库删除语句: drop database [if exists] db_name</p>
<p>为了规避关键字，可以使用反引号解决 &#96;  反引号在TAB上面</p>
<h3 id="24-6-备份恢复数据库"><a href="#24-6-备份恢复数据库" class="headerlink" title="24.6 备份恢复数据库"></a>24.6 备份恢复数据库</h3><p>备份数据库（注意：在DOS执行）</p>
<pre><code>mysqldump -u 用户名 -p -B 数据库1 数据库n &gt;文件名.sql
</code></pre>
<p><img src="/../images/image-20220126221605152.png" alt="image-20220126221605152"></p>
<p>恢复数据库（注意：进入Mysql命令在执行）</p>
<pre><code>source 文件名.sql
</code></pre>
<h3 id="24-7创建表"><a href="#24-7创建表" class="headerlink" title="24.7创建表"></a>24.7创建表</h3><p><img src="/../images/image-20220126221747273.png" alt="image-20220126221747273"></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `emp2` (</span><br><span class="line">id <span class="type">INT</span>, `name` <span class="type">VARCHAR</span>(<span class="number">32</span>),</span><br><span class="line">sex <span class="type">CHAR</span>(<span class="number">1</span>), birthday <span class="type">DATE</span>,</span><br><span class="line">entry_date DATETIME,job <span class="type">VARCHAR</span>(<span class="number">32</span>),</span><br><span class="line">salary <span class="keyword">DOUBLE</span>, `resume` TEXT)</span><br><span class="line">CHARSET utf8 <span class="keyword">COLLATE</span> utf8_bin ENGINE INNODB;</span><br></pre></td></tr></table></figure>



<p>CREATE TABLE <code>user</code> ( id INT, <code>name</code> VARCHAR(255), <code>password</code> VARCHAR(255), <code>birthday</code> DATE) CHARACTER SET utf8 COLLATE utf8_bin ENGINE INNODB</p>
<h3 id="24-8Mysql常用数据类型（列类型）"><a href="#24-8Mysql常用数据类型（列类型）" class="headerlink" title="24.8Mysql常用数据类型（列类型）"></a>24.8Mysql常用数据类型（列类型）</h3><p><img src="/../images/image-20220126221932661.png" alt="image-20220126221932661"></p>
<h4 id="24-8-1-整形使用"><a href="#24-8-1-整形使用" class="headerlink" title="24.8.1 整形使用"></a>24.8.1 整形使用</h4><p>#1. 如果没有指定 unsinged , 则 TINYINT 就是有符号 #2. 如果指定 unsinged , 则 TINYINT 就是无符号 0-2</p>
<h4 id="24-8-2-bit的使用"><a href="#24-8-2-bit的使用" class="headerlink" title="24.8.2 bit的使用"></a>24.8.2 bit的使用</h4><p>#演示 bit 类型使用 #说明 #1. bit(m) m 在 1-64 #2. 添加数据 范围 按照你给的位数来确定，比如 m &#x3D; 8 表示一个字节 0~255 #3. 显示按照 bit #4. 查询时，仍然可以按照数来查询</p>
<h4 id="24-8-3-小数的基本使用"><a href="#24-8-3-小数的基本使用" class="headerlink" title="24.8.3 小数的基本使用"></a>24.8.3 小数的基本使用</h4><p>FLOAT DOUBLE </p>
<p>DECIMAL[M,D] </p>
<p><img src="/../images/image-20220126223706048.png" alt="image-20220126223706048"></p>
<h4 id="24-8-4字符串的基本使用"><a href="#24-8-4字符串的基本使用" class="headerlink" title="24.8.4字符串的基本使用"></a>24.8.4字符串的基本使用</h4><p>#演示字符串类型使用 char varchar #注释的快捷键 shift+ctrl+c , 注销注释 shift+ctrl+r – CHAR(size)</p>
<p> – 固定长度字符串 最大 255 字符 – VARCHAR(size) 0~65535 字节 </p>
<p>– 可变长度字符串 最大 65532 字节 【utf8 编码最大 21844 字符 1-3 个字节用于记录大小】</p>
<p> – 如果表的编码是 utf8 varchar(size) size &#x3D; (65535-3) &#x2F; 3 &#x3D; 21844 </p>
<p>– 如果表的编码是 gbk varchar(size) size &#x3D; (65535-3) &#x2F; 2&#x3D;32766</p>
<p><img src="/../images/image-20220126224550625.png" alt="image-20220126224550625"></p>
<p><img src="/../images/image-20220126224611133.png" alt="image-20220126224611133"></p>
<p><img src="/../images/image-20220126224751550.png" alt="image-20220126224751550"></p>
<h4 id="24-8-5日期类型的基本使用"><a href="#24-8-5日期类型的基本使用" class="headerlink" title="24.8.5日期类型的基本使用"></a>24.8.5日期类型的基本使用</h4><p>\</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">#演示时间相关的类型 </span><br><span class="line"></span><br><span class="line">#创建一张表, date , datetime , timestamp </span><br><span class="line">CREATE TABLE t14 ( birthday DATE , -- 生日 </span><br><span class="line"></span><br><span class="line">job_time DATETIME, -- 记录年月日 时分秒 </span><br><span class="line"></span><br><span class="line">login_time TIMESTAMP </span><br><span class="line"></span><br><span class="line">NOT NULL DEFAULT CURRENT_TIMESTAMP </span><br><span class="line"></span><br><span class="line">ON UPDATE CURRENT_TIMESTAMP); -- 登录时间, 如果希望 login_time 列自动更新, 需要配置 </span><br><span class="line"></span><br><span class="line">SELECT * FROM t14; INSERT INTO t14(birthday, job_time) VALUES(&#x27;2022-11-11&#x27;,&#x27;2022-11-11 10:10:10&#x27;);</span><br><span class="line"></span><br><span class="line"> -- 如果我们更新 t14 表的某条记录，login_time 列会自动的以当前时间进行更新</span><br></pre></td></tr></table></figure>



<h3 id="24-9-修改表"><a href="#24-9-修改表" class="headerlink" title="24.9 修改表"></a>24.9 修改表</h3><p>使用alter table 语句追加，修改，或删除列的语法</p>
<p>添加列：alter table tablename</p>
<pre><code>            add （column datatype [default expr ] [,column datatype]...);
</code></pre>
<p>修改列：alter table tablename</p>
<pre><code>            modify （column datatype [default expr ] [,column datatype]...);
</code></pre>
<p>删除列：alter table tablename</p>
<pre><code>            drop （column);
</code></pre>
<p>修改表名 rename table 表名 to 新表名</p>
<p>修改表字符集：alter table 表名 character set 字符集</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">#修改表的操作练习</span><br><span class="line"><span class="comment">-- 员工表 emp 的上增加一个 image 列，varchar 类型(要求在 resume 后面)。</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> emp</span><br><span class="line"><span class="keyword">ADD</span> image <span class="type">VARCHAR</span>(<span class="number">32</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">&#x27;&#x27;</span> AFTER RESUME</span><br><span class="line"><span class="keyword">DESC</span> employee <span class="comment">-- 显示表结构，可以查看表的所有列</span></span><br><span class="line"><span class="comment">-- 修改 job 列，使其长度为 60。</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> emp</span><br><span class="line">MODIFY job <span class="type">VARCHAR</span>(<span class="number">60</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">&#x27;&#x27;</span> <span class="comment">-- 删除 sex 列。</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> emp</span><br><span class="line"><span class="keyword">DROP</span> sex</span><br><span class="line"><span class="comment">-- 表名改为 employee。</span></span><br><span class="line">RENAME <span class="keyword">TABLE</span> emp <span class="keyword">TO</span> employee</span><br><span class="line"><span class="comment">-- 修改表的字符集为 utf8</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> employee <span class="type">CHARACTER</span> <span class="keyword">SET</span> utf8</span><br><span class="line"><span class="comment">-- 列名 name 修改为 user_name</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> employee</span><br><span class="line">CHANGE `name` `user_name` <span class="type">VARCHAR</span>(<span class="number">64</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">&#x27;&#x27;</span> <span class="keyword">DESC</span> employee</span><br></pre></td></tr></table></figure>

<h3 id="24-10-数据库CRUD语句"><a href="#24-10-数据库CRUD语句" class="headerlink" title="24.10 数据库CRUD语句"></a>24.10 数据库CRUD语句</h3><p>insert 添加数据</p>
<p>update 更新数据</p>
<p>delete 删除数据</p>
<p>select 查找数据</p>
<h3 id="24-11-insert-语句"><a href="#24-11-insert-语句" class="headerlink" title="24.11 insert 语句"></a>24.11 insert 语句</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Insert</span> <span class="keyword">into</span> tablename [(<span class="keyword">column</span>[,column...])]</span><br><span class="line"></span><br><span class="line"><span class="keyword">values</span> (<span class="keyword">value</span> [,value...]);</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">#练习 <span class="keyword">insert</span> 语句</span><br><span class="line"><span class="comment">-- 创建一张商品表 goods (id int , goods_name varchar(10), price double ); -- 添加 2 条记录</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `goods` (</span><br><span class="line">id <span class="type">INT</span> , goods_name <span class="type">VARCHAR</span>(<span class="number">10</span>), <span class="comment">-- 长度 10</span></span><br><span class="line">price <span class="keyword">DOUBLE</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="number">100</span> ); <span class="comment">-- 添加数据</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `goods` (id, goods_name, price)</span><br><span class="line"><span class="keyword">VALUES</span>(<span class="number">10</span>, <span class="string">&#x27;华为手机&#x27;</span>, <span class="number">2000</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `goods` (id, goods_name, price)</span><br><span class="line"><span class="keyword">VALUES</span>(<span class="number">20</span>, <span class="string">&#x27;苹果手机&#x27;</span>, <span class="number">3000</span>);</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> goods;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `goods2` (</span><br><span class="line">id <span class="type">INT</span> , goods_name <span class="type">VARCHAR</span>(<span class="number">10</span>), <span class="comment">-- 长度 10</span></span><br><span class="line">price <span class="keyword">DOUBLE</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span></span><br></pre></td></tr></table></figure>

<h4 id="使用细节"><a href="#使用细节" class="headerlink" title="使用细节"></a>使用细节</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">#说明 <span class="keyword">insert</span> 语句的细节</span><br><span class="line"><span class="comment">-- 1.插入的数据应与字段的数据类型相同。</span></span><br><span class="line"><span class="comment">-- 比如 把 &#x27;abc&#x27; 添加到 int 类型会错误</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `goods` (id, goods_name, price)</span><br><span class="line"><span class="keyword">VALUES</span>(<span class="string">&#x27;韩顺平&#x27;</span>, <span class="string">&#x27;小米手机&#x27;</span>, <span class="number">2000</span>); <span class="comment">-- 2. 数据的长度应在列的规定范围内，例如：不能将一个长度为 80 的字符串加入到长度为 40 的列中。</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `goods` (id, goods_name, price)</span><br><span class="line"><span class="keyword">VALUES</span>(<span class="number">40</span>, <span class="string">&#x27;vovo 手机 vovo 手机 vovo 手机 vovo 手机 vovo 手机&#x27;</span>, <span class="number">3000</span>); <span class="comment">-- 3. 在 values 中列出的数据位置必须与被加入的列的排列位置相对应。</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `goods` (id, goods_name, price) <span class="comment">-- 不对</span></span><br><span class="line"><span class="keyword">VALUES</span>(<span class="string">&#x27;vovo 手机&#x27;</span>,<span class="number">40</span>, <span class="number">2000</span>); <span class="comment">-- 4. 字符和日期型数据应包含在单引号中。</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `goods` (id, goods_name, price)</span><br><span class="line"><span class="keyword">VALUES</span>(<span class="number">40</span>, vovo 手机, <span class="number">3000</span>); <span class="comment">-- 错误的 vovo 手机 应该 &#x27;vovo 手机&#x27; -- 5. 列可以插入空值[前提是该字段允许为空]，insert into table value(null)</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `goods` (id, goods_name, price)</span><br><span class="line"><span class="keyword">VALUES</span>(<span class="number">40</span>, <span class="string">&#x27;vovo 手机&#x27;</span>, <span class="keyword">NULL</span>); <span class="comment">-- 6. insert into tab_name (列名..) values (),(),() 形式添加多条记录</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `goods` (id, goods_name, price)</span><br><span class="line"><span class="keyword">VALUES</span>(<span class="number">50</span>, <span class="string">&#x27;三星手机&#x27;</span>, <span class="number">2300</span>),(<span class="number">60</span>, <span class="string">&#x27;海尔手机&#x27;</span>, <span class="number">1800</span>); <span class="comment">-- 7. 如果是给表中的所有字段添加数据，可以不写前面的字段名称</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `goods` <span class="keyword">VALUES</span>(<span class="number">70</span>, <span class="string">&#x27;IBM 手机&#x27;</span>, <span class="number">5000</span>); <span class="comment">-- 8. 默认值的使用，当不给某个字段值时，如果有默认值就会添加默认值，否则报错</span></span><br><span class="line"><span class="comment">-- 如果某个列 没有指定 not null ,那么当添加数据时，没有给定值，则会默认给 null -- 如果我们希望指定某个列的默认值，可以在创建表时指定</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `goods` (id, goods_name)</span><br><span class="line"><span class="keyword">VALUES</span>(<span class="number">80</span>, <span class="string">&#x27;格力手机&#x27;</span>);</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> goods;</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `goods2` (id, goods_name)</span><br><span class="line"><span class="keyword">VALUES</span>(<span class="number">10</span>, <span class="string">&#x27;顺平手机&#x27;</span>);</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> goods2;</span><br></pre></td></tr></table></figure>

<h3 id="24-12-update-语句"><a href="#24-12-update-语句" class="headerlink" title="24.12 update 语句"></a>24.12 update 语句</h3><p>update tablename</p>
<pre><code>            set col_name1 =expr1[,]
</code></pre>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 演示 update 语句</span></span><br><span class="line"><span class="comment">-- 要求: 在上面创建的 employee 表中修改表中的纪录</span></span><br><span class="line"><span class="comment">-- 1. 将所有员工薪水修改为 5000 元。[如果没有带 where 条件，会修改所有的记录，因此要小心]</span></span><br><span class="line"><span class="keyword">UPDATE</span> employee <span class="keyword">SET</span> salary <span class="operator">=</span> <span class="number">5000</span></span><br><span class="line"><span class="comment">-- 2. 将姓名为 小妖怪 的员工薪水修改为 3000 元。</span></span><br><span class="line"><span class="keyword">UPDATE</span> employee</span><br><span class="line"><span class="keyword">SET</span> salary <span class="operator">=</span> <span class="number">3000</span></span><br><span class="line"><span class="keyword">WHERE</span> user_name <span class="operator">=</span> <span class="string">&#x27;小妖怪&#x27;</span> <span class="comment">-- 3. 将 老妖怪 的薪水在原有基础上增加 1000 元</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> employee</span><br><span class="line"><span class="keyword">VALUES</span>(<span class="number">200</span>, <span class="string">&#x27;老妖怪&#x27;</span>, <span class="string">&#x27;1990-11-11&#x27;</span>, <span class="string">&#x27;2000-11-11 10:10:10&#x27;</span>, <span class="string">&#x27;捶背的&#x27;</span>, <span class="number">5000</span>, <span class="string">&#x27;给大王捶背&#x27;</span>, <span class="string">&#x27;d:\\a.jpg&#x27;</span>);</span><br><span class="line"><span class="keyword">UPDATE</span> employee</span><br><span class="line"><span class="keyword">SET</span> salary <span class="operator">=</span> salary <span class="operator">+</span> <span class="number">1000</span></span><br><span class="line"><span class="keyword">WHERE</span> user_name <span class="operator">=</span> <span class="string">&#x27;老妖怪&#x27;</span> <span class="comment">-- 可以修改多个列的值</span></span><br><span class="line"><span class="keyword">UPDATE</span> employee</span><br><span class="line"><span class="keyword">SET</span> salary <span class="operator">=</span> salary <span class="operator">+</span> <span class="number">1000</span> , job <span class="operator">=</span> <span class="string">&#x27;出主意的&#x27;</span> <span class="keyword">WHERE</span> user_name <span class="operator">=</span> <span class="string">&#x27;老妖怪&#x27;</span> <span class="keyword">SELECT</span> <span class="operator">*</span></span><br></pre></td></tr></table></figure>

<p>使用细节</p>
<h3 id="24-13-delete语句"><a href="#24-13-delete语句" class="headerlink" title="24.13 delete语句"></a>24.13 delete语句</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 删除表中名称为’老妖怪’的记录。</span></span><br><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> employee</span><br><span class="line"><span class="keyword">WHERE</span> user_name <span class="operator">=</span> <span class="string">&#x27;老妖怪&#x27;</span>; <span class="comment">-- 删除表中所有记录, 老师提醒，一定要小心</span></span><br><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> employee; <span class="comment">-- Delete 语句不能删除某一列的值（可使用 update 设为 null 或者 &#x27;&#x27;）</span></span><br><span class="line"><span class="keyword">UPDATE</span> employee <span class="keyword">SET</span> job <span class="operator">=</span> <span class="string">&#x27;&#x27;</span> <span class="keyword">WHERE</span> user_name <span class="operator">=</span> <span class="string">&#x27;老妖怪&#x27;</span>;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> employee</span><br><span class="line"><span class="comment">-- 要删除这个表</span></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> employee;</span><br></pre></td></tr></table></figure>

<p>如果不使用where子句，将删除表中所有数据</p>
<p>delete语句不能删除某一列的值（可使用update设为null或者’’)</p>
<p>仅能删除记录，不能删除表本省</p>
<h3 id="24-14-select-语句"><a href="#24-14-select-语句" class="headerlink" title="24.14 select 语句"></a>24.14 select 语句</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- select 语句【重点 难点】</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> student(</span><br><span class="line">id <span class="type">INT</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="number">1</span>, NAME <span class="type">VARCHAR</span>(<span class="number">20</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">&#x27;&#x27;</span>, chinese <span class="type">FLOAT</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="number">0.0</span>, english <span class="type">FLOAT</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="number">0.0</span>, math <span class="type">FLOAT</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="number">0.0</span></span><br><span class="line">);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> student(id,NAME,chinese,english,math) <span class="keyword">VALUES</span>(<span class="number">1</span>,<span class="string">&#x27;韩顺平&#x27;</span>,<span class="number">89</span>,<span class="number">78</span>,<span class="number">90</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> student(id,NAME,chinese,english,math) <span class="keyword">VALUES</span>(<span class="number">2</span>,<span class="string">&#x27;张飞&#x27;</span>,<span class="number">67</span>,<span class="number">98</span>,<span class="number">56</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> student(id,NAME,chinese,english,math) <span class="keyword">VALUES</span>(<span class="number">3</span>,<span class="string">&#x27;宋江&#x27;</span>,<span class="number">87</span>,<span class="number">78</span>,<span class="number">77</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> student(id,NAME,chinese,english,math) <span class="keyword">VALUES</span>(<span class="number">4</span>,<span class="string">&#x27;关羽&#x27;</span>,<span class="number">88</span>,<span class="number">98</span>,<span class="number">90</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> student(id,NAME,chinese,english,math) <span class="keyword">VALUES</span>(<span class="number">5</span>,<span class="string">&#x27;赵云&#x27;</span>,<span class="number">82</span>,<span class="number">84</span>,<span class="number">67</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> student(id,NAME,chinese,english,math) <span class="keyword">VALUES</span>(<span class="number">6</span>,<span class="string">&#x27;欧阳锋&#x27;</span>,<span class="number">55</span>,<span class="number">85</span>,<span class="number">45</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> student(id,NAME,chinese,english,math) <span class="keyword">VALUES</span>(<span class="number">7</span>,<span class="string">&#x27;黄蓉&#x27;</span>,<span class="number">75</span>,<span class="number">65</span>,<span class="number">30</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> student(id,NAME,chinese,english,math) <span class="keyword">VALUES</span>(<span class="number">8</span>,<span class="string">&#x27;韩信&#x27;</span>,<span class="number">45</span>,<span class="number">65</span>,<span class="number">99</span>);</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> student; <span class="comment">-- 查询表中所有学生的信息。</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> student; <span class="comment">-- 查询表中所有学生的姓名和对应的英语成绩。</span></span><br><span class="line"><span class="keyword">SELECT</span> `name`,english <span class="keyword">FROM</span> student; <span class="comment">-- 过滤表中重复数据 distinct 。</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> english <span class="keyword">FROM</span> student; <span class="comment">-- 要查询的记录，每个字段都相同，才会去重</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> `name`, english <span class="keyword">FROM</span> student</span><br></pre></td></tr></table></figure></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="https://gouguoqiang.github.io">ggq</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://gouguoqiang.github.io/2022/09/01/11Mysql/">https://gouguoqiang.github.io/2022/09/01/11Mysql/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://gouguoqiang.github.io" target="_blank">ggq</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/">数据库</a></div><div class="post_share"><div class="social-share" data-image="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2022/09/01/15os/"><img class="prev-cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">OS</div></div></a></div><div class="next-post pull-right"><a href="/2022/09/01/16net/"><img class="next-cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">Net</div></div></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://i.loli.net/2021/02/24/5O1day2nriDzjSu.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">ggq</div><div class="author-info__description"></div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">78</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">42</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">19</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xxxxxx"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-number">1.</span> <span class="toc-text">创建数据库</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AF%AD%E6%B3%95"><span class="toc-number">1.0.1.</span> <span class="toc-text">语法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1%E3%80%81%E6%9F%A5%E7%9C%8BMySQL%E9%BB%98%E8%AE%A4%E7%9A%84%E5%AD%97%E7%AC%A6%E9%9B%86%E5%92%8C%E6%A0%A1%E5%AF%B9%E8%A7%84%E5%88%99"><span class="toc-number">1.0.2.</span> <span class="toc-text">1、查看MySQL默认的字符集和校对规则</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BF%AE%E6%94%B9%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-number">1.0.3.</span> <span class="toc-text">修改数据库</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%A0%E9%99%A4%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-number">1.0.4.</span> <span class="toc-text">删除数据库</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E6%95%B0%E6%8D%AE%E8%A1%A8-table"><span class="toc-number">2.</span> <span class="toc-text">创建数据表(table)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AF%AD%E6%B3%95-1"><span class="toc-number">2.0.1.</span> <span class="toc-text">语法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%BE%E4%BE%8B"><span class="toc-number">2.0.2.</span> <span class="toc-text">举例</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%80%9A%E8%BF%87%E5%B7%B2%E6%9C%89%E7%9A%84%E8%A1%A8%E5%BB%BA%E6%96%B0%E8%A1%A8"><span class="toc-number">2.0.3.</span> <span class="toc-text">通过已有的表建新表</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8-select-%E6%9F%A5%E8%AF%A2%E7%9A%84%E7%BB%93%E6%9E%9C%E9%9B%86%E6%9D%A5%E5%88%9B%E5%BB%BA%E8%A1%A8"><span class="toc-number">2.0.4.</span> <span class="toc-text">使用 select 查询的结果集来创建表</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%A0%E9%99%A4%E6%95%B0%E6%8D%AE%E8%A1%A8"><span class="toc-number">2.0.5.</span> <span class="toc-text">删除数据表</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BF%AE%E6%94%B9%E8%A1%A8%E7%BB%93%E6%9E%84"><span class="toc-number">3.</span> <span class="toc-text">修改表结构</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80%E3%80%81%E5%A2%9E%E5%8A%A0%E5%92%8C%E5%88%A0%E9%99%A4%E5%AD%97%E6%AE%B5"><span class="toc-number">3.1.</span> <span class="toc-text">一、增加和删除字段</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1%E3%80%81%E5%A2%9E%E5%8A%A0%E5%AD%97%E6%AE%B5"><span class="toc-number">3.1.0.1.</span> <span class="toc-text">1、增加字段</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%EF%BC%881%EF%BC%89%E6%B7%BB%E5%8A%A0%E4%B8%80%E4%B8%AA%E5%88%97-phone"><span class="toc-number">3.1.0.2.</span> <span class="toc-text">（1）添加一个列 phone</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%EF%BC%882%EF%BC%89%E6%B7%BB%E5%8A%A0%E4%B8%80%E4%B8%AA%E5%88%97-salary%EF%BC%8C%E9%BB%98%E8%AE%A4%E5%80%BC%E4%B8%BA0%EF%BC%8C%E4%B8%8D%E8%83%BD%E5%8F%96%E7%A9%BA%E5%80%BC"><span class="toc-number">3.1.0.3.</span> <span class="toc-text">（2）添加一个列 salary，默认值为0，不能取空值</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%EF%BC%883%EF%BC%89%E6%96%B0%E5%A2%9E%E4%B8%80%E4%B8%AA%E5%AD%97%E6%AE%B5-birth%EF%BC%8C%E5%B9%B6%E6%94%BE%E5%9C%A8-name-%E5%AD%97%E6%AE%B5%E4%B9%8B%E5%90%8E"><span class="toc-number">3.1.0.4.</span> <span class="toc-text">（3）新增一个字段 birth，并放在 name 字段之后</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2%E3%80%81%E5%88%A0%E9%99%A4%E5%AD%97%E6%AE%B5"><span class="toc-number">3.1.0.5.</span> <span class="toc-text">2、删除字段</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C%E3%80%81%E4%BF%AE%E6%94%B9%E5%AD%97%E6%AE%B5%E7%9A%84%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%E3%80%81%E5%90%8D%E7%A7%B0%E5%92%8C%E5%AD%97%E6%AE%B5%E7%9A%84%E4%BD%8D%E7%BD%AE"><span class="toc-number">3.2.</span> <span class="toc-text">二、修改字段的数据类型、名称和字段的位置</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1%E3%80%81%E4%BF%AE%E6%94%B9%E5%AD%97%E6%AE%B5%E7%9A%84%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B"><span class="toc-number">3.2.0.1.</span> <span class="toc-text">1、修改字段的数据类型</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2%E3%80%81%E4%BF%AE%E6%94%B9%E5%AD%97%E6%AE%B5%E7%9A%84%E5%90%8D%E7%A7%B0"><span class="toc-number">3.2.0.2.</span> <span class="toc-text">2、修改字段的名称</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3%E3%80%81%E6%9B%B4%E6%94%B9%E5%AD%97%E6%AE%B5%E7%9A%84%E4%BD%8D%E7%BD%AE"><span class="toc-number">3.2.0.3.</span> <span class="toc-text">3、更改字段的位置</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%89%E3%80%81%E4%BF%AE%E6%94%B9%E8%A1%A8%E5%90%8D"><span class="toc-number">3.3.</span> <span class="toc-text">三、修改表名</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E6%9B%B4%E6%96%B0%E4%B9%8BINSERT"><span class="toc-number">4.</span> <span class="toc-text">数据更新之INSERT</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80%E3%80%81%E6%95%B0%E6%8D%AE%E5%87%86%E5%A4%87"><span class="toc-number">4.1.</span> <span class="toc-text">一、数据准备</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C%E3%80%81%E6%95%B0%E6%8D%AE%E7%9A%84%E6%8F%92%E5%85%A5%E6%93%8D%E4%BD%9C"><span class="toc-number">4.2.</span> <span class="toc-text">二、数据的插入操作</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1%E3%80%81%E6%8F%92%E5%85%A5%E4%B8%80%E6%9D%A1%E6%88%96%E5%A4%9A%E6%9D%A1%E6%95%B0%E6%8D%AE%E8%AE%B0%E5%BD%95"><span class="toc-number">4.2.0.1.</span> <span class="toc-text">1、插入一条或多条数据记录</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%EF%BC%881%EF%BC%89%E7%94%A8-insert-%E5%91%BD%E4%BB%A4%E4%B8%80%E6%AC%A1%E6%8F%92%E5%85%A5%E4%B8%80%E6%9D%A1%E8%AE%B0%E5%BD%95"><span class="toc-number">4.2.0.2.</span> <span class="toc-text">（1）用 insert 命令一次插入一条记录</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%EF%BC%882%EF%BC%89%E7%94%A8-insert-%E5%91%BD%E4%BB%A4%E4%B8%80%E6%AC%A1%E6%8F%92%E5%85%A5%E5%A4%9A%E6%9D%A1%E8%AE%B0%E5%BD%95"><span class="toc-number">4.2.0.3.</span> <span class="toc-text">（2）用 insert 命令一次插入多条记录</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2%E3%80%81%E4%BD%BF%E7%94%A8-set-%E5%8F%82%E6%95%B0%E6%8F%92%E5%85%A5%E6%95%B0%E6%8D%AE"><span class="toc-number">4.2.0.4.</span> <span class="toc-text">2、使用 set 参数插入数据</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3%E3%80%81%E6%8A%8A%E4%B8%80%E4%B8%AA%E6%9F%A5%E8%AF%A2%E7%9A%84%E7%BB%93%E6%9E%9C%E6%8F%92%E5%85%A5%E5%88%B0%E6%95%B0%E6%8D%AE%E8%A1%A8%E4%B8%AD"><span class="toc-number">4.2.0.5.</span> <span class="toc-text">3、把一个查询的结果插入到数据表中</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%EF%BC%881%EF%BC%89%E5%88%9B%E5%BB%BA%E4%B8%80%E5%BC%A0%E6%95%B0%E6%8D%AE%E8%A1%A8"><span class="toc-number">4.2.0.6.</span> <span class="toc-text">（1）创建一张数据表</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%EF%BC%882%EF%BC%89%E4%BB%8E-emp-%E8%A1%A8%E4%B8%AD%E6%9F%A5%E8%AF%A2%E4%B8%AD%E7%94%B7%E6%80%A7%E5%91%98%E5%B7%A5%E7%9A%84%E4%BF%A1%E6%81%AF%E6%8F%92%E5%85%A5-emp001-%E8%A1%A8%E4%B8%AD"><span class="toc-number">4.2.0.7.</span> <span class="toc-text">（2）从 emp 表中查询中男性员工的信息插入 emp001 表中</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4%E3%80%81replace-into-%E5%91%BD%E4%BB%A4"><span class="toc-number">4.2.0.8.</span> <span class="toc-text">4、replace into 命令</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E6%9B%B4%E6%96%B0%E4%B9%8BUPDATE"><span class="toc-number">5.</span> <span class="toc-text">数据更新之UPDATE</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80%E3%80%81%E6%95%B0%E6%8D%AE%E5%87%86%E5%A4%87-1"><span class="toc-number">5.1.</span> <span class="toc-text">一、数据准备</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C%E3%80%81%E6%95%B0%E6%8D%AE%E6%9B%B4%E6%96%B0%E6%93%8D%E4%BD%9C"><span class="toc-number">5.2.</span> <span class="toc-text">二、数据更新操作</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1%E3%80%81%E4%B8%BA%E8%A1%A8%E4%B8%AD%E7%9A%84%E5%AD%97%E6%AE%B5%E6%8C%87%E5%AE%9A%E4%B8%80%E4%B8%AA%E5%B8%B8%E9%87%8F%E6%88%96%E8%A1%A8%E8%BE%BE%E5%BC%8F"><span class="toc-number">5.2.0.1.</span> <span class="toc-text">1、为表中的字段指定一个常量或表达式</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2%E3%80%81%E5%88%A9%E7%94%A8%E5%8F%A6%E4%B8%80%E4%B8%AA%E8%A1%A8%E4%B8%AD%E7%9A%84%E6%95%B0%E6%8D%AE%E6%9B%B4%E6%96%B0%E5%BD%93%E5%89%8D%E8%A1%A8"><span class="toc-number">5.2.0.2.</span> <span class="toc-text">2、利用另一个表中的数据更新当前表</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E6%9B%B4%E6%96%B0%E4%B9%8BDELETE"><span class="toc-number">6.</span> <span class="toc-text">数据更新之DELETE</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80%E3%80%81%E4%BD%BF%E7%94%A8-delete-%E5%91%BD%E4%BB%A4%E5%88%A0%E9%99%A4%E8%A1%A8%E4%B8%AD%E7%9A%84%E6%95%B0%E6%8D%AE"><span class="toc-number">6.1.</span> <span class="toc-text">一、使用 delete 命令删除表中的数据</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%AE%8C%E6%95%B4%E6%80%A7%E7%BA%A6%E6%9D%9F%E6%A6%82%E8%BF%B0"><span class="toc-number">7.</span> <span class="toc-text">完整性约束概述</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80%E3%80%81%E4%B8%BB%E9%94%AE%E7%BA%A6%E6%9D%9F"><span class="toc-number">7.1.</span> <span class="toc-text">一、主键约束</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E8%A1%A8%E6%97%B6%E5%AE%9A%E4%B9%89"><span class="toc-number">7.1.1.</span> <span class="toc-text">创建表时定义</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1%E3%80%81%E5%AE%9A%E4%B9%89%E5%88%97%E6%97%B6%E5%90%8C%E6%97%B6%E5%AE%9A%E4%B9%89%E4%B8%BB%E9%94%AE"><span class="toc-number">7.1.1.1.</span> <span class="toc-text">1、定义列时同时定义主键</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2%E3%80%81%E5%9C%A8%E5%AE%9A%E4%B9%89%E5%AE%8C%E6%89%80%E6%9C%89%E5%88%97%E4%B9%8B%E5%90%8E%E5%AE%9A%E4%B9%89%E4%B8%BB%E9%94%AE"><span class="toc-number">7.1.1.2.</span> <span class="toc-text">2、在定义完所有列之后定义主键</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9A%E4%B9%89%E5%A4%9A%E5%88%97%E4%B8%BB%E9%94%AE"><span class="toc-number">7.1.2.</span> <span class="toc-text">定义多列主键</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E8%A1%A8%E4%B9%8B%E5%90%8E%E6%B7%BB%E5%8A%A0%E4%B8%BB%E9%94%AE"><span class="toc-number">7.1.3.</span> <span class="toc-text">创建表之后添加主键</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8A%8A%E4%B8%80%E4%B8%AA%E5%B7%B2%E7%BB%8F%E5%AD%98%E5%9C%A8%E7%9A%84%E5%88%97%E5%AE%9A%E4%B9%89%E4%B8%BA%E4%B8%BB%E9%94%AE"><span class="toc-number">7.1.4.</span> <span class="toc-text">把一个已经存在的列定义为主键</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%A0%E9%99%A4%E4%B8%BB%E9%94%AE"><span class="toc-number">7.1.5.</span> <span class="toc-text">删除主键</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C%E3%80%81%E5%94%AF%E4%B8%80%E7%BA%A6%E6%9D%9F"><span class="toc-number">7.2.</span> <span class="toc-text">二、唯一约束</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%80%E3%80%81UNIQUE-%E7%BA%A6%E6%9D%9F%E4%B8%8E-PRIMARY-KEY-%E7%BA%A6%E6%9D%9F%E7%9A%84%E5%8C%BA%E5%88%AB%E5%92%8C%E8%81%94%E7%B3%BB"><span class="toc-number">7.2.1.</span> <span class="toc-text">一、UNIQUE 约束与 PRIMARY KEY 约束的区别和联系</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%8C%E3%80%81%E5%88%9B%E5%BB%BA%E8%A1%A8%E6%97%B6%EF%BC%8C%E5%90%8C%E6%97%B6%E5%88%9B%E5%BB%BA-UNIQUE-%E7%BA%A6%E6%9D%9F"><span class="toc-number">7.2.2.</span> <span class="toc-text">二、创建表时，同时创建 UNIQUE 约束</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1%E3%80%81%E5%AE%9A%E4%B9%89%E5%88%97%E7%9A%84%E5%90%8C%E6%97%B6%E5%AE%9A%E4%B9%89-UNIQUE-%E7%BA%A6%E6%9D%9F"><span class="toc-number">7.2.3.</span> <span class="toc-text">1、定义列的同时定义 UNIQUE 约束</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2%E3%80%81%E5%9C%A8%E6%89%80%E6%9C%89%E7%9A%84%E5%88%97%E5%AE%9A%E4%B9%89%E4%B9%8B%E5%90%8E%E5%AE%9A%E4%B9%89-UNIQUE-%E7%BA%A6%E6%9D%9F"><span class="toc-number">7.2.3.1.</span> <span class="toc-text">2、在所有的列定义之后定义 UNIQUE 约束</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%89%E3%80%81%E5%88%9B%E5%BB%BA%E8%A1%A8%E4%B9%8B%E5%90%8E%E6%B7%BB%E5%8A%A0-UNIQUE-%E7%BA%A6%E6%9D%9F"><span class="toc-number">7.2.4.</span> <span class="toc-text">三、创建表之后添加 UNIQUE 约束</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9B%9B%E3%80%81%E5%88%A0%E9%99%A4-UNIQUE-%E7%BA%A6%E6%9D%9F"><span class="toc-number">7.2.5.</span> <span class="toc-text">四、删除 UNIQUE 约束</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%89%E3%80%81%E5%A4%96%E9%94%AE%E7%BA%A6%E6%9D%9F"><span class="toc-number">7.3.</span> <span class="toc-text">三、外键约束</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%80%E3%80%81%E5%88%9B%E5%BB%BA%E8%A1%A8%E7%9A%84%E5%90%8C%E6%97%B6%E5%AE%9A%E4%B9%89%E5%A4%96%E9%94%AE"><span class="toc-number">7.3.1.</span> <span class="toc-text">一、创建表的同时定义外键</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1%E3%80%81%E5%88%9B%E5%BB%BA%E9%83%A8%E9%97%A8%EF%BC%88dept%EF%BC%89%E5%92%8C%E5%91%98%E5%B7%A5%EF%BC%88emp%EF%BC%89%E8%A1%A8%EF%BC%8C%E5%B9%B6%E5%88%9B%E5%BB%BA%E5%A4%96%E9%94%AE%E3%80%82"><span class="toc-number">7.3.1.1.</span> <span class="toc-text">1、创建部门（dept）和员工（emp）表，并创建外键。</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2%E3%80%81%E6%8A%8A-emp-%E8%A1%A8%E7%9A%84%E5%A4%96%E9%94%AE%E8%AE%BE%E7%BD%AE%E4%B8%BA%E7%BA%A7%E8%81%94%E6%9B%B4%E6%96%B0%E5%92%8C%E7%BA%A7%E8%81%94%E5%88%A0%E9%99%A4"><span class="toc-number">7.3.1.2.</span> <span class="toc-text">2、把 emp 表的外键设置为级联更新和级联删除</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%8C%E3%80%81%E5%88%A0%E9%99%A4%E5%A4%96%E9%94%AE%E7%BA%A6%E6%9D%9F"><span class="toc-number">7.3.2.</span> <span class="toc-text">二、删除外键约束</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%89%E3%80%81%E4%B8%BA%E5%B7%B2%E6%9C%89%E7%9A%84%E8%A1%A8%E6%B7%BB%E5%8A%A0%E5%A4%96%E9%94%AE%E7%BA%A6%E6%9D%9F"><span class="toc-number">7.3.3.</span> <span class="toc-text">三、为已有的表添加外键约束</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%9B%E3%80%81%E9%9D%9E%E7%A9%BA%E7%BA%A6%E6%9D%9F"><span class="toc-number">7.4.</span> <span class="toc-text">四、非空约束</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%94%E3%80%81%E9%BB%98%E8%AE%A4%E5%80%BC"><span class="toc-number">7.5.</span> <span class="toc-text">五、默认值</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%AD%E3%80%81%E8%87%AA%E5%A2%9E%E5%88%97"><span class="toc-number">7.6.</span> <span class="toc-text">六、自增列</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#3%E3%80%81%E4%BF%AE%E6%94%B9%E8%87%AA%E5%A2%9E%E5%88%97%E7%9A%84%E8%B5%B7%E5%A7%8B%E5%80%BC"><span class="toc-number">7.6.0.1.</span> <span class="toc-text">3、修改自增列的起始值</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%B4%A2%E5%BC%95"><span class="toc-number">8.</span> <span class="toc-text">索引</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9C%A8%E5%88%9B%E5%BB%BA%E8%A1%A8%E6%97%B6%E5%90%8C%E6%97%B6%E5%88%9B%E5%BB%BA%E7%B4%A2%E5%BC%95"><span class="toc-number">8.1.</span> <span class="toc-text">在创建表时同时创建索引</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E8%A1%A8%E4%B9%8B%E5%90%8E%E6%9C%89%E9%9C%80%E8%A6%81%E6%97%B6%E5%86%8D%E5%88%9B%E5%BB%BA%E7%B4%A2%E5%BC%95"><span class="toc-number">8.2.</span> <span class="toc-text">创建表之后有需要时再创建索引</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Alter-%E6%B7%BB%E5%8A%A0%E7%B4%A2%E5%BC%95"><span class="toc-number">8.2.1.</span> <span class="toc-text">Alter 添加索引</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8-create-index-%E5%91%BD%E4%BB%A4%E6%B7%BB%E5%8A%A0%E7%B4%A2%E5%BC%95"><span class="toc-number">8.2.2.</span> <span class="toc-text">使用 create index 命令添加索引</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8-alter-table-%E5%91%BD%E4%BB%A4%E5%88%A0%E9%99%A4%E7%B4%A2%E5%BC%95"><span class="toc-number">8.3.</span> <span class="toc-text">使用 alter table 命令删除索引</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8-drop-index-%E5%91%BD%E4%BB%A4%E5%88%A0%E9%99%A4%E7%B4%A2%E5%BC%95"><span class="toc-number">8.4.</span> <span class="toc-text">使用 drop index 命令删除索引</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#explain%E5%88%86%E6%9E%90%E7%B4%A2%E5%BC%95%E4%BD%BF%E7%94%A8%E6%83%85%E5%86%B5"><span class="toc-number">9.</span> <span class="toc-text">explain分析索引使用情况</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80%E3%80%81%E6%95%B0%E6%8D%AE%E5%87%86%E5%A4%87-2"><span class="toc-number">9.1.</span> <span class="toc-text">一、数据准备</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C%E3%80%81%E4%BD%BF%E7%94%A8-explain-%E5%88%86%E6%9E%90%E6%9F%A5%E8%AF%A2"><span class="toc-number">9.2.</span> <span class="toc-text">二、使用 explain 分析查询</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%89%E3%80%81explain-%E5%90%84%E4%B8%AA%E9%80%89%E9%A1%B9%E7%9A%84%E8%AF%A6%E7%BB%86%E8%AF%B4%E6%98%8E%E5%8F%8A%E4%B8%BE%E4%BE%8B"><span class="toc-number">9.3.</span> <span class="toc-text">三、explain 各个选项的详细说明及举例</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1%E3%80%81id"><span class="toc-number">9.3.0.1.</span> <span class="toc-text">1、id</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2%E3%80%81select-type"><span class="toc-number">9.3.0.2.</span> <span class="toc-text">2、select_type</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3%E3%80%81table"><span class="toc-number">9.3.0.3.</span> <span class="toc-text">3、table</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4%E3%80%81partitions"><span class="toc-number">9.3.0.4.</span> <span class="toc-text">4、partitions</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5%E3%80%81type"><span class="toc-number">9.3.0.5.</span> <span class="toc-text">5、type</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6%E3%80%81possible-keys"><span class="toc-number">9.3.0.6.</span> <span class="toc-text">6、possible_keys</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#7%E3%80%81key"><span class="toc-number">9.3.0.7.</span> <span class="toc-text">7、key</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#8%E3%80%81key-len"><span class="toc-number">9.3.0.8.</span> <span class="toc-text">8、key_len</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#9%E3%80%81ref"><span class="toc-number">9.3.0.9.</span> <span class="toc-text">9、ref</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#11%E3%80%81filtered"><span class="toc-number">9.3.0.10.</span> <span class="toc-text">11、filtered</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#10%E3%80%81rows"><span class="toc-number">9.3.0.11.</span> <span class="toc-text">10、rows</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#12%E3%80%81extra"><span class="toc-number">9.3.0.12.</span> <span class="toc-text">12、extra</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#select-%E6%9F%A5%E8%AF%A2%E4%B9%8B-select-%E8%AF%AD%E6%B3%95"><span class="toc-number">10.</span> <span class="toc-text">select 查询之 select 语法</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80%E3%80%81SELECT-%E8%AF%AD%E5%8F%A5%E7%9A%84%E8%AF%AD%E6%B3%95"><span class="toc-number">10.1.</span> <span class="toc-text">一、SELECT 语句的语法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C%E3%80%81SELECT-%E8%AF%AD%E5%8F%A5%E5%90%84%E9%83%A8%E5%88%86%E7%9A%84%E8%AF%B4%E6%98%8E"><span class="toc-number">10.2.</span> <span class="toc-text">二、SELECT 语句各部分的说明</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%A9%E7%94%A8%E5%AD%97%E6%AE%B5%E5%90%8D%E3%80%81%E8%BF%90%E7%AE%97%E7%AC%A6%E5%92%8C%E5%87%BD%E6%95%B0%E6%9E%84%E9%80%A0%E8%A1%A8%E8%BE%BE%E5%BC%8F"><span class="toc-number">10.3.</span> <span class="toc-text">利用字段名、运算符和函数构造表达式</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%BA%E5%AD%97%E6%AE%B5%E5%92%8C%E8%A1%A8%E8%BE%BE%E5%BC%8F%E6%8C%87%E5%AE%9A%E5%88%AB%E5%90%8D"><span class="toc-number">10.4.</span> <span class="toc-text">为字段和表达式指定别名</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8-distinct-%E5%8F%82%E6%95%B0%E5%AF%B9%E6%9F%A5%E8%AF%A2%E7%BB%93%E6%9E%9C%E5%8E%BB%E9%87%8D"><span class="toc-number">10.5.</span> <span class="toc-text">使用 distinct 参数对查询结果去重</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#select-%E6%9F%A5%E8%AF%A2%E4%B9%8B%E6%9F%A5%E8%AF%A2%E6%9D%A1%E4%BB%B6"><span class="toc-number">11.</span> <span class="toc-text">select 查询之查询条件</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Order-by"><span class="toc-number">11.1.</span> <span class="toc-text">Order by</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9F%A5%E8%AF%A2%E6%89%80%E6%9C%89%E5%AD%A6%E7%94%9F%E7%9A%84%E4%BF%A1%E6%81%AF%EF%BC%8C%E5%B9%B6%E4%B8%94%E6%8C%89%E5%AD%A6%E7%94%9F%E7%9A%84%E5%B9%B4%E9%BE%84%E6%8E%92%E5%BA%8F"><span class="toc-number">11.1.0.1.</span> <span class="toc-text">查询所有学生的信息，并且按学生的年龄排序</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#limit"><span class="toc-number">11.2.</span> <span class="toc-text">limit</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BF%9E%E6%8E%A5%E6%9F%A5%E8%AF%A2"><span class="toc-number">11.3.</span> <span class="toc-text">连接查询</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%80%E3%80%81%E4%BA%A4%E5%8F%89%E8%BF%9E%E6%8E%A5%EF%BC%88CROSS-JOIN%EF%BC%89"><span class="toc-number">11.3.1.</span> <span class="toc-text">一、交叉连接（CROSS JOIN）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%8C%E3%80%81%E5%86%85%E8%BF%9E%E6%8E%A5%EF%BC%88INNER-JOIN%EF%BC%89"><span class="toc-number">11.3.2.</span> <span class="toc-text">二、内连接（INNER JOIN）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A4%9A%E8%A1%A8%E8%81%94%E6%9F%A5"><span class="toc-number">11.3.3.</span> <span class="toc-text">多表联查</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%81%9A%E5%90%88%E5%87%BD%E6%95%B0"><span class="toc-number">11.3.4.</span> <span class="toc-text">聚合函数</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#count"><span class="toc-number">11.3.4.1.</span> <span class="toc-text">count</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1%E3%80%81%E7%BB%9F%E8%AE%A1%E7%94%B7%E7%94%9F%E4%BA%BA%E6%95%B0"><span class="toc-number">11.3.4.2.</span> <span class="toc-text">1、统计男生人数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2%E3%80%81%E7%BB%9F%E8%AE%A1%E8%BA%AB%E9%AB%98%E8%B6%85%E8%BF%87-175-%E7%9A%84%E5%AD%A6%E7%94%9F%E4%BA%BA%E6%95%B0"><span class="toc-number">11.3.4.3.</span> <span class="toc-text">2、统计身高超过 175 的学生人数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3%E3%80%81%E7%BB%9F%E8%AE%A1%E6%9C%89%E5%AD%A6%E7%94%9F%E7%9A%84%E7%B3%BB%E7%9A%84%E4%B8%AA%E6%95%B0"><span class="toc-number">11.3.4.4.</span> <span class="toc-text">3、统计有学生的系的个数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#sum"><span class="toc-number">11.3.4.5.</span> <span class="toc-text">sum</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#avg"><span class="toc-number">11.3.4.6.</span> <span class="toc-text">avg()</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#max-min"><span class="toc-number">11.3.4.7.</span> <span class="toc-text">max,min</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#group-by"><span class="toc-number">11.3.5.</span> <span class="toc-text">group by</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#select-%E9%80%89%E6%8B%A9%E7%9A%84%E5%AD%97%E6%AE%B5%E5%88%97%E8%A1%A8%E5%8C%85%E5%90%AB%E4%BA%86%E5%85%B6%E4%BB%96%E7%9A%84%E5%AD%97%E6%AE%B5%E5%90%8D%E6%88%96%E8%A1%A8%E8%BE%BE%E5%BC%8F"><span class="toc-number">11.3.5.1.</span> <span class="toc-text">select 选择的字段列表包含了其他的字段名或表达式</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%86%E5%88%AB%E7%BB%9F%E8%AE%A1%E7%94%B7%E7%94%9F%E5%92%8C%E5%A5%B3%E7%94%9F%E7%9A%84%E5%B9%B3%E5%9D%87%E8%BA%AB%E9%AB%98"><span class="toc-number">11.3.5.2.</span> <span class="toc-text">分别统计男生和女生的平均身高</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BB%9F%E8%AE%A1%E6%AF%8F%E4%B8%AA%E7%B3%BB%E7%9A%84%E5%AD%A6%E7%94%9F%E4%BA%BA%E6%95%B0"><span class="toc-number">11.3.5.3.</span> <span class="toc-text">统计每个系的学生人数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BB%9F%E8%AE%A1%E5%90%84%E4%B8%AA%E5%B9%B4%E7%BA%A7%E7%9A%84%E5%AD%A6%E7%94%9F%E4%BA%BA%E6%95%B0"><span class="toc-number">11.3.5.4.</span> <span class="toc-text">统计各个年级的学生人数</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#SELECT-%E8%AF%AD%E5%8F%A5%E7%9A%84%E8%AF%AD%E6%B3%95%E9%A1%BA%E5%BA%8F"><span class="toc-number">12.</span> <span class="toc-text">SELECT 语句的语法顺序</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%B4%A2%E5%BC%95-1"><span class="toc-number">13.</span> <span class="toc-text">索引</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E6%98%AF%E7%B4%A2%E5%BC%95%EF%BC%9F"><span class="toc-number">13.0.1.</span> <span class="toc-text">什么是索引？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%B4%A2%E5%BC%95%E6%9C%89%E5%93%AA%E4%BA%9B%E4%BC%98%E7%BC%BA%E7%82%B9%EF%BC%9F"><span class="toc-number">13.0.2.</span> <span class="toc-text">索引有哪些优缺点？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%B4%A2%E5%BC%95%E6%9C%89%E5%93%AA%E5%87%A0%E7%A7%8D%E7%B1%BB%E5%9E%8B%EF%BC%9F"><span class="toc-number">13.0.3.</span> <span class="toc-text">@$索引有哪几种类型？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%B4%A2%E5%BC%95%E7%9A%84%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%EF%BC%88B-%E6%A0%91%EF%BC%8CHash%EF%BC%89"><span class="toc-number">13.0.4.</span> <span class="toc-text">@$索引的数据结构（B+树，Hash）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%93%E4%B8%BA%E4%BB%80%E4%B9%88%E4%BD%BF%E7%94%A8B-%E6%A0%91%E8%80%8C%E4%B8%8D%E6%98%AFB%E6%A0%91"><span class="toc-number">13.0.5.</span> <span class="toc-text">数据库为什么使用B+树而不是B树</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%B4%A2%E5%BC%95%E7%AE%97%E6%B3%95%E6%9C%89%E5%93%AA%E4%BA%9B%EF%BC%9F"><span class="toc-number">13.0.6.</span> <span class="toc-text">索引算法有哪些？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E7%B4%A2%E5%BC%95%E7%9A%84%E5%8E%9F%E5%88%99%EF%BC%9F%E7%B4%A2%E5%BC%95%E8%AE%BE%E8%AE%A1%E7%9A%84%E5%8E%9F%E5%88%99%EF%BC%9F"><span class="toc-number">13.0.7.</span> <span class="toc-text">@$创建索引的原则？索引设计的原则？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E6%83%85%E5%86%B5%E4%BD%BF%E7%94%A8%E4%BA%86%E7%B4%A2%E5%BC%95%EF%BC%8C%E6%9F%A5%E8%AF%A2%E8%BF%98%E6%98%AF%E6%85%A2"><span class="toc-number">13.0.8.</span> <span class="toc-text">什么情况使用了索引，查询还是慢</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MySQL%E4%BD%BF%E7%94%A8%E8%87%AA%E5%A2%9E%E4%B8%BB%E9%94%AE%E7%9A%84%E5%A5%BD%E5%A4%84"><span class="toc-number">13.0.9.</span> <span class="toc-text">MySQL使用自增主键的好处</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E6%98%AF%E8%81%9A%E7%B0%87%E7%B4%A2%E5%BC%95%EF%BC%9F%E4%BD%95%E6%97%B6%E4%BD%BF%E7%94%A8%E8%81%9A%E7%B0%87%E7%B4%A2%E5%BC%95%E4%B8%8E%E9%9D%9E%E8%81%9A%E7%B0%87%E7%B4%A2%E5%BC%95"><span class="toc-number">13.0.10.</span> <span class="toc-text">@$什么是聚簇索引？何时使用聚簇索引与非聚簇索引</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%81%94%E5%90%88%E7%B4%A2%E5%BC%95%E6%98%AF%E4%BB%80%E4%B9%88%EF%BC%9F%E7%BB%84%E5%90%88%E7%B4%A2%E5%BC%95%E6%98%AF%E4%BB%80%E4%B9%88%EF%BC%9F"><span class="toc-number">13.0.11.</span> <span class="toc-text">联合索引是什么？组合索引是什么？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%81%94%E5%90%88%E7%B4%A2%E5%BC%95%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%92%8C%E5%AE%9E%E7%8E%B0%E5%8E%9F%E7%90%86%EF%BC%8C%E4%BD%BF%E7%94%A8%E8%81%94%E5%90%88%E7%B4%A2%E5%BC%95%E6%98%AF%E6%80%8E%E4%B9%88%E8%BF%9B%E8%A1%8C%E6%9F%A5%E8%AF%A2%E7%9A%84"><span class="toc-number">13.0.12.</span> <span class="toc-text">@$联合索引数据结构和实现原理，使用联合索引是怎么进行查询的</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E6%98%AF%E6%9C%80%E5%B7%A6%E5%89%8D%E7%BC%80%E5%8E%9F%E5%88%99%EF%BC%9F%E4%BB%80%E4%B9%88%E6%98%AF%E6%9C%80%E5%B7%A6%E5%8C%B9%E9%85%8D%E5%8E%9F%E5%88%99%EF%BC%9F%E4%B8%BA%E4%BB%80%E4%B9%88%E9%9C%80%E8%A6%81%E6%B3%A8%E6%84%8F%E8%81%94%E5%90%88%E7%B4%A2%E5%BC%95%E4%B8%AD%E7%9A%84%E9%A1%BA%E5%BA%8F%EF%BC%9F"><span class="toc-number">13.0.13.</span> <span class="toc-text">@$什么是最左前缀原则？什么是最左匹配原则？为什么需要注意联合索引中的顺序？</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%80%BB%E7%BB%93"><span class="toc-number">13.1.</span> <span class="toc-text">总结</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E6%98%AF%E7%B4%A2%E5%BC%95"><span class="toc-number">13.2.</span> <span class="toc-text">什么是索引</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%B4%A2%E5%BC%95%E4%BC%98%E7%BC%BA%E7%82%B9"><span class="toc-number">13.3.</span> <span class="toc-text">索引优缺点</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#MySQL%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%E7%B2%BE%E8%AE%B2"><span class="toc-number">14.</span> <span class="toc-text">MySQL数据类型精讲</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BF%BD%E7%95%A5%E5%A4%A7%E5%B0%8F%E5%86%99"><span class="toc-number">14.1.</span> <span class="toc-text">忽略大小写</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%81%E8%AE%B8%E6%8C%89%E7%85%A7%E8%A7%92%E6%A0%87%E7%9A%84%E6%96%B9%E5%BC%8F%E8%8E%B7%E5%8F%96%E6%8C%87%E5%AE%9A%E7%B4%A2%E5%BC%95%E4%BD%8D%E7%BD%AE%E7%9A%84%E6%9E%9A%E4%B8%BE%E5%80%BC"><span class="toc-number">14.2.</span> <span class="toc-text">允许按照角标的方式获取指定索引位置的枚举值</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Data-truncated-for-column-%E2%80%98season%E2%80%99-at-row-1"><span class="toc-number">14.3.</span> <span class="toc-text">Data truncated for column ‘season’ at row 1</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BD%93ENUM%E7%B1%BB%E5%9E%8B%E7%9A%84%E5%AD%97%E6%AE%B5%E6%B2%A1%E6%9C%89%E5%A3%B0%E6%98%8E%E4%B8%BANOT-NULL%E6%97%B6%EF%BC%8C%E6%8F%92%E5%85%A5NULL%E4%B9%9F%E6%98%AF%E6%9C%89%E6%95%88%E7%9A%84"><span class="toc-number">14.4.</span> <span class="toc-text">当ENUM类型的字段没有声明为NOT NULL时，插入NULL也是有效的</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Data-truncated-for-column-%E2%80%98gender%E2%80%99-at-row-1"><span class="toc-number">14.5.</span> <span class="toc-text">Data truncated for column ‘gender’ at row 1</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Data-truncated-for-column-%E2%80%98gender%E2%80%99-at-row-1-1"><span class="toc-number">14.6.</span> <span class="toc-text">Data truncated for column ‘gender’ at row 1</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%93%E4%BC%98%E5%8C%96"><span class="toc-number">15.</span> <span class="toc-text">数据库优化</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%93%E7%BB%93%E6%9E%84%E4%BC%98%E5%8C%96"><span class="toc-number">15.0.1.</span> <span class="toc-text">数据库结构优化</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A4%A7%E8%A1%A8%E6%80%8E%E4%B9%88%E4%BC%98%E5%8C%96%EF%BC%9F%E6%9F%90%E4%B8%AA%E8%A1%A8%E6%9C%89%E8%BF%91%E5%8D%83%E4%B8%87%E6%95%B0%E6%8D%AE%EF%BC%8CCRUD%E6%AF%94%E8%BE%83%E6%85%A2%EF%BC%8C%E5%A6%82%E4%BD%95%E4%BC%98%E5%8C%96%EF%BC%9F%E5%88%86%E5%BA%93%E5%88%86%E8%A1%A8%E6%98%AF%E6%80%8E%E4%B9%88%E5%81%9A%E7%9A%84%EF%BC%9F%E5%88%86%E8%A1%A8%E5%88%86%E5%BA%93%E4%BA%86%E6%9C%89%E4%BB%80%E4%B9%88%E9%97%AE%E9%A2%98%EF%BC%9F%E6%9C%89%E7%94%A8%E5%88%B0%E4%B8%AD%E9%97%B4%E4%BB%B6%E4%B9%88%EF%BC%9F%E4%BB%96%E4%BB%AC%E7%9A%84%E5%8E%9F%E7%90%86%E7%9F%A5%E9%81%93%E4%B9%88%EF%BC%9F"><span class="toc-number">15.0.2.</span> <span class="toc-text">@$大表怎么优化？某个表有近千万数据，CRUD比较慢，如何优化？分库分表是怎么做的？分表分库了有什么问题？有用到中间件么？他们的原理知道么？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MySQL%E7%9A%84%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6%E5%8E%9F%E7%90%86%E4%BB%A5%E5%8F%8A%E6%B5%81%E7%A8%8B"><span class="toc-number">15.0.3.</span> <span class="toc-text">MySQL的主从复制原理以及流程</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AF%BB%E5%86%99%E5%88%86%E7%A6%BB%E6%9C%89%E5%93%AA%E4%BA%9B%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88%EF%BC%9F%E6%9C%AA%E5%AE%8C%E6%88%90"><span class="toc-number">15.0.4.</span> <span class="toc-text">读写分离有哪些解决方案？未完成</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#SQL%E6%9F%A5%E8%AF%A2%E7%9A%84%E5%9F%BA%E6%9C%AC%E5%8E%9F%E7%90%86"><span class="toc-number">16.</span> <span class="toc-text">SQL查询的基本原理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#SQL%E7%9A%84%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%EF%BC%9F%E4%B8%80%E6%9D%A1SQL%E6%9F%A5%E8%AF%A2%E8%AF%AD%E5%8F%A5%E6%98%AF%E5%A6%82%E4%BD%95%E6%89%A7%E8%A1%8C%E7%9A%84%EF%BC%9FMySQL%E6%80%BB%E4%BD%93%E6%9E%B6%E6%9E%84%E2%80%94-gt-SQL%E6%89%A7%E8%A1%8C%E6%B5%81%E7%A8%8B%E2%80%94-gt-%E8%AF%AD%E5%8F%A5%E6%89%A7%E8%A1%8C%E9%A1%BA%E5%BA%8F"><span class="toc-number">16.0.1.</span> <span class="toc-text">@$SQL的生命周期？一条SQL查询语句是如何执行的？MySQL总体架构—&gt;SQL执行流程—&gt;语句执行顺序</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%80%E6%9D%A1%E6%9B%B4%E6%96%B0%E8%AF%AD%E5%8F%A5%E7%9A%84%E6%89%A7%E8%A1%8C%E6%B5%81%E7%A8%8B%E5%8F%88%E6%98%AF%E6%80%8E%E6%A0%B7%E7%9A%84%E5%91%A2%EF%BC%9F%E6%8C%81%E4%B9%85%E5%8C%96%E6%9C%BA%E5%88%B6"><span class="toc-number">16.0.2.</span> <span class="toc-text">一条更新语句的执行流程又是怎样的呢？持久化机制</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BA%8B%E5%8A%A1%E4%B8%8E%E9%94%81"><span class="toc-number">17.</span> <span class="toc-text">事务与锁</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8B%E5%8A%A1"><span class="toc-number">17.1.</span> <span class="toc-text">事务</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E6%98%AF%E6%95%B0%E6%8D%AE%E5%BA%93%E4%BA%8B%E5%8A%A1%EF%BC%9F"><span class="toc-number">17.1.1.</span> <span class="toc-text">什么是数据库事务？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%8B%E5%8A%A1%E7%9A%84%E5%9B%9B%E5%A4%A7%E7%89%B9%E6%80%A7-ACID-%E4%BB%8B%E7%BB%8D%E4%B8%80%E4%B8%8B"><span class="toc-number">17.1.2.</span> <span class="toc-text">@$事务的四大特性(ACID)介绍一下?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E6%98%AF%E8%84%8F%E8%AF%BB%EF%BC%9F%E4%B8%8D%E5%8F%AF%E9%87%8D%E5%A4%8D%E8%AF%BB%EF%BC%9F%E5%B9%BB%E8%AF%BB%EF%BC%9F"><span class="toc-number">17.1.3.</span> <span class="toc-text">@$什么是脏读？不可重复读？幻读？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E6%98%AF%E4%BA%8B%E5%8A%A1%E7%9A%84%E9%9A%94%E7%A6%BB%E7%BA%A7%E5%88%AB%EF%BC%9FMySQL%E7%9A%84%E9%BB%98%E8%AE%A4%E7%9A%84%E9%9A%94%E7%A6%BB%E7%BA%A7%E5%88%AB%E6%98%AF%E4%BB%80%E4%B9%88%EF%BC%9F"><span class="toc-number">17.1.4.</span> <span class="toc-text">@$什么是事务的隔离级别？MySQL的默认的隔离级别是什么？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MySQL%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8F%AF%E9%87%8D%E5%A4%8D%E8%AF%BB%E9%9A%94%E7%A6%BB%E7%BA%A7%E5%88%AB%E6%98%AF%E6%80%8E%E4%B9%88%E5%AE%9E%E7%8E%B0%E7%9A%84%EF%BC%8CMVCC%E5%B9%B6%E5%8F%91%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6%E5%8E%9F%E7%90%86"><span class="toc-number">17.1.5.</span> <span class="toc-text">@$MySQL数据库可重复读隔离级别是怎么实现的，MVCC并发版本控制原理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%95%BF%E4%BA%8B%E5%8A%A1%E7%9A%84%E4%BC%98%E5%8C%96"><span class="toc-number">17.1.6.</span> <span class="toc-text">长事务的优化</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%94%81"><span class="toc-number">17.2.</span> <span class="toc-text">锁</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AF%B9MySQL%E7%9A%84%E9%94%81%E4%BA%86%E8%A7%A3%E5%90%97"><span class="toc-number">17.2.1.</span> <span class="toc-text">对MySQL的锁了解吗</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%9A%94%E7%A6%BB%E7%BA%A7%E5%88%AB%E4%B8%8E%E9%94%81%E7%9A%84%E5%85%B3%E7%B3%BB"><span class="toc-number">17.2.2.</span> <span class="toc-text">隔离级别与锁的关系</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8C%89%E7%85%A7%E9%94%81%E7%9A%84%E7%B2%92%E5%BA%A6%E5%88%86%E6%95%B0%E6%8D%AE%E5%BA%93%E9%94%81%E6%9C%89%E5%93%AA%E4%BA%9B%EF%BC%9F"><span class="toc-number">17.2.3.</span> <span class="toc-text">按照锁的粒度分数据库锁有哪些？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%B1%E4%BA%AB%E9%94%81%E5%92%8C%E6%8E%92%E4%BB%96%E9%94%81%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="toc-number">17.2.4.</span> <span class="toc-text">共享锁和排他锁的区别</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%93%E7%9A%84%E4%B9%90%E8%A7%82%E9%94%81%E5%92%8C%E6%82%B2%E8%A7%82%E9%94%81%E6%98%AF%E4%BB%80%E4%B9%88%EF%BC%9F%E6%80%8E%E4%B9%88%E5%AE%9E%E7%8E%B0%E7%9A%84%EF%BC%9F"><span class="toc-number">17.2.5.</span> <span class="toc-text">数据库的乐观锁和悲观锁是什么？怎么实现的？</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SQL%E4%BC%98%E5%8C%96"><span class="toc-number">17.3.</span> <span class="toc-text">SQL优化</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A6%82%E4%BD%95%E5%AE%9A%E4%BD%8D%E5%8F%8A%E4%BC%98%E5%8C%96SQL%E8%AF%AD%E5%8F%A5%E7%9A%84%E6%80%A7%E8%83%BD%E9%97%AE%E9%A2%98%EF%BC%9F%E5%88%9B%E5%BB%BA%E7%9A%84%E7%B4%A2%E5%BC%95%E6%9C%89%E6%B2%A1%E6%9C%89%E8%A2%AB%E4%BD%BF%E7%94%A8%E5%88%B0%EF%BC%9F%E6%88%96%E8%80%85%E8%AF%B4%E6%80%8E%E4%B9%88%E6%89%8D%E5%8F%AF%E4%BB%A5%E7%9F%A5%E9%81%93%E8%BF%99%E6%9D%A1%E8%AF%AD%E5%8F%A5%E8%BF%90%E8%A1%8C%E5%BE%88%E6%85%A2%E7%9A%84%E5%8E%9F%E5%9B%A0%EF%BC%9F"><span class="toc-number">17.3.1.</span> <span class="toc-text">@$如何定位及优化SQL语句的性能问题？创建的索引有没有被使用到？或者说怎么才可以知道这条语句运行很慢的原因？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SQL%E7%9A%84%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%EF%BC%9F%E4%B8%80%E6%9D%A1SQL%E6%9F%A5%E8%AF%A2%E8%AF%AD%E5%8F%A5%E6%98%AF%E5%A6%82%E4%BD%95%E6%89%A7%E8%A1%8C%E7%9A%84%EF%BC%9FMySQL%E6%80%BB%E4%BD%93%E6%9E%B6%E6%9E%84%E2%80%94-gt-SQL%E6%89%A7%E8%A1%8C%E6%B5%81%E7%A8%8B%E2%80%94-gt-%E8%AF%AD%E5%8F%A5%E6%89%A7%E8%A1%8C%E9%A1%BA%E5%BA%8F-1"><span class="toc-number">17.3.2.</span> <span class="toc-text">@$SQL的生命周期？一条SQL查询语句是如何执行的？MySQL总体架构—&gt;SQL执行流程—&gt;语句执行顺序</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%80%E6%9D%A1%E6%9B%B4%E6%96%B0%E8%AF%AD%E5%8F%A5%E7%9A%84%E6%89%A7%E8%A1%8C%E6%B5%81%E7%A8%8B%E5%8F%88%E6%98%AF%E6%80%8E%E6%A0%B7%E7%9A%84%E5%91%A2%EF%BC%9F"><span class="toc-number">17.3.3.</span> <span class="toc-text">一条更新语句的执行流程又是怎样的呢？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B8%B8%E7%94%A8SQL%E6%9F%A5%E8%AF%A2%E8%AF%AD%E5%8F%A5%E4%BC%98%E5%8C%96%E6%96%B9%E6%B3%95"><span class="toc-number">17.3.4.</span> <span class="toc-text">常用SQL查询语句优化方法</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%80%BB%E7%BB%93-1"><span class="toc-number">17.4.</span> <span class="toc-text">总结</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ACID"><span class="toc-number">17.5.</span> <span class="toc-text">ACID</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%9A%94%E7%A6%BB%E7%BA%A7%E5%88%AB"><span class="toc-number">17.6.</span> <span class="toc-text">隔离级别</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Explain%E5%B7%A5%E5%85%B7%E4%BB%8B%E7%BB%8D"><span class="toc-number">18.</span> <span class="toc-text">Explain工具介绍</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#explain%E4%B8%AD%E7%9A%84%E5%88%97"><span class="toc-number">18.1.</span> <span class="toc-text">explain中的列</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-id%E5%88%97"><span class="toc-number">18.1.1.</span> <span class="toc-text">\1. id列</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-select-type%E5%88%97"><span class="toc-number">18.1.2.</span> <span class="toc-text">\2. select_type列</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-table%E5%88%97"><span class="toc-number">18.1.3.</span> <span class="toc-text">\3. table列</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-type%E5%88%97"><span class="toc-number">18.1.4.</span> <span class="toc-text">\4. type列</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-possible-keys%E5%88%97"><span class="toc-number">18.1.5.</span> <span class="toc-text">\5. possible_keys列</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-key%E5%88%97"><span class="toc-number">18.1.6.</span> <span class="toc-text">\6. key列</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-key-len%E5%88%97"><span class="toc-number">18.1.7.</span> <span class="toc-text">\7. key_len列</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-ref%E5%88%97"><span class="toc-number">18.1.8.</span> <span class="toc-text">\8. ref列</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-rows%E5%88%97"><span class="toc-number">18.1.9.</span> <span class="toc-text">\9. rows列</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10-Extra%E5%88%97"><span class="toc-number">18.1.10.</span> <span class="toc-text">\10. Extra列</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%B4%A2%E5%BC%95%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5"><span class="toc-number">18.2.</span> <span class="toc-text">索引最佳实践</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E9%9A%8F%E7%AC%94"><span class="toc-number">19.</span> <span class="toc-text">随笔</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#24-3-SQL%E8%AF%AD%E5%8F%A5%E5%88%86%E7%B1%BB"><span class="toc-number">19.0.1.</span> <span class="toc-text">24.3 SQL语句分类</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%AC%AC24%E7%AB%A0-%E9%9B%B6%E5%9F%BA%E7%A1%80-MYSQL"><span class="toc-number">20.</span> <span class="toc-text">第24章 零基础 MYSQL</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#24-1%E6%95%B0%E6%8D%AE%E5%BA%93%E4%B8%89%E5%B1%82%E7%BB%93%E6%9E%84"><span class="toc-number">20.0.1.</span> <span class="toc-text">24.1数据库三层结构</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#24-2-%E6%95%B0%E6%8D%AE%E5%9C%A8%E6%95%B0%E6%8D%AE%E5%BA%93%E4%B8%AD%E7%9A%84%E5%AD%98%E5%82%A8%E6%96%B9%E5%BC%8F"><span class="toc-number">20.0.2.</span> <span class="toc-text">24.2 数据在数据库中的存储方式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#24-3-SQL%E8%AF%AD%E5%8F%A5%E5%88%86%E7%B1%BB-1"><span class="toc-number">20.0.3.</span> <span class="toc-text">24.3 SQL语句分类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#24-4-%E5%88%9B%E5%BB%BA%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-number">20.0.4.</span> <span class="toc-text">24.4 创建数据库</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#24-5%E6%9F%A5%E7%9C%8B%E3%80%81%E5%88%A0%E9%99%A4%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-number">20.0.5.</span> <span class="toc-text">24.5查看、删除数据库</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#24-6-%E5%A4%87%E4%BB%BD%E6%81%A2%E5%A4%8D%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-number">20.0.6.</span> <span class="toc-text">24.6 备份恢复数据库</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#24-7%E5%88%9B%E5%BB%BA%E8%A1%A8"><span class="toc-number">20.0.7.</span> <span class="toc-text">24.7创建表</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#24-8Mysql%E5%B8%B8%E7%94%A8%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%EF%BC%88%E5%88%97%E7%B1%BB%E5%9E%8B%EF%BC%89"><span class="toc-number">20.0.8.</span> <span class="toc-text">24.8Mysql常用数据类型（列类型）</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#24-8-1-%E6%95%B4%E5%BD%A2%E4%BD%BF%E7%94%A8"><span class="toc-number">20.0.8.1.</span> <span class="toc-text">24.8.1 整形使用</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#24-8-2-bit%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="toc-number">20.0.8.2.</span> <span class="toc-text">24.8.2 bit的使用</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#24-8-3-%E5%B0%8F%E6%95%B0%E7%9A%84%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8"><span class="toc-number">20.0.8.3.</span> <span class="toc-text">24.8.3 小数的基本使用</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#24-8-4%E5%AD%97%E7%AC%A6%E4%B8%B2%E7%9A%84%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8"><span class="toc-number">20.0.8.4.</span> <span class="toc-text">24.8.4字符串的基本使用</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#24-8-5%E6%97%A5%E6%9C%9F%E7%B1%BB%E5%9E%8B%E7%9A%84%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8"><span class="toc-number">20.0.8.5.</span> <span class="toc-text">24.8.5日期类型的基本使用</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#24-9-%E4%BF%AE%E6%94%B9%E8%A1%A8"><span class="toc-number">20.0.9.</span> <span class="toc-text">24.9 修改表</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#24-10-%E6%95%B0%E6%8D%AE%E5%BA%93CRUD%E8%AF%AD%E5%8F%A5"><span class="toc-number">20.0.10.</span> <span class="toc-text">24.10 数据库CRUD语句</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#24-11-insert-%E8%AF%AD%E5%8F%A5"><span class="toc-number">20.0.11.</span> <span class="toc-text">24.11 insert 语句</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E7%BB%86%E8%8A%82"><span class="toc-number">20.0.11.1.</span> <span class="toc-text">使用细节</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#24-12-update-%E8%AF%AD%E5%8F%A5"><span class="toc-number">20.0.12.</span> <span class="toc-text">24.12 update 语句</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#24-13-delete%E8%AF%AD%E5%8F%A5"><span class="toc-number">20.0.13.</span> <span class="toc-text">24.13 delete语句</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#24-14-select-%E8%AF%AD%E5%8F%A5"><span class="toc-number">20.0.14.</span> <span class="toc-text">24.14 select 语句</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2023/02/01/%E7%AE%97%E6%B3%95/7%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0/AcWing/" title="无题"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="无题"/></a><div class="content"><a class="title" href="/2023/02/01/%E7%AE%97%E6%B3%95/7%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0/AcWing/" title="无题">无题</a><time datetime="2023-02-01T15:55:11.432Z" title="发表于 2023-02-01 23:55:11">2023-02-01</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/01/31/%E7%91%9E%E5%90%89%E5%A4%96%E5%8D%96/ruiji/" title="无题"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="无题"/></a><div class="content"><a class="title" href="/2023/01/31/%E7%91%9E%E5%90%89%E5%A4%96%E5%8D%96/ruiji/" title="无题">无题</a><time datetime="2023-01-31T14:50:49.607Z" title="发表于 2023-01-31 22:50:49">2023-01-31</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/12/21/%E7%AE%97%E6%B3%95/00pythonapi/" title="无题"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="无题"/></a><div class="content"><a class="title" href="/2022/12/21/%E7%AE%97%E6%B3%95/00pythonapi/" title="无题">无题</a><time datetime="2022-12-21T14:08:13.553Z" title="发表于 2022-12-21 22:08:13">2022-12-21</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/12/12/%E7%95%85%E8%B4%AD%E5%95%86%E5%9F%8E/0%E7%AE%80%E4%BB%8B/" title="无题"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="无题"/></a><div class="content"><a class="title" href="/2022/12/12/%E7%95%85%E8%B4%AD%E5%95%86%E5%9F%8E/0%E7%AE%80%E4%BB%8B/" title="无题">无题</a><time datetime="2022-12-12T15:06:58.895Z" title="发表于 2022-12-12 23:06:58">2022-12-12</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/11/19/22CloudNative/" title="无题"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="无题"/></a><div class="content"><a class="title" href="/2022/11/19/22CloudNative/" title="无题">无题</a><time datetime="2022-11-19T15:17:22.198Z" title="发表于 2022-11-19 23:17:22">2022-11-19</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2023 By ggq</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.min.js"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>